function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return r=e.done,e},e:function(e){c=!0,o=e},f:function(){try{r||null==n.return||n.return()}finally{if(c)throw o}}}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{Iab2:function(e,t,n){var i,a;void 0===(a="function"==typeof(i=function(){"use strict";function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,o=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(e,o,r){var c=a.URL||a.webkitURL,l=document.createElement("a");l.download=o=o||e.name||"download",l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,o,r):i(l,l.target="_blank")):(l.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,o){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,o),a);else if(n(e))t(e,a,o);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){i(r)}))}}:function(e,n,i,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var r="application/octet-stream"===e.type,c=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||r&&c)&&"object"==typeof FileReader){var s=new FileReader;s.onloadend=function(){var e=s.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},s.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,p=u.createObjectURL(e);o?o.location=p:location.href=p,o=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});a.saveAs=o.saveAs=o,e.exports=o})?i.apply(t,[]):i)||(e.exports=a)},TtBp:function(e,t,n){"use strict";n.r(t),n.d(t,"WelcomeModule",(function(){return Aa}));var i,a,o=n("ofXK"),r=n("3Pt+"),c=n("tyNb"),l=n("mrSG"),s=n("Kj3r"),u=n("/uUt"),p=n("fXoL"),f=n("PScX"),d=n("AytR"),m=n("tk/3"),h=((i=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getLeads",value:function(e){return this.http.post(d.a.apiUrl+"/lead/findAll",e)}},{key:"addLead",value:function(e){return this.http.post(d.a.apiUrl+"/lead",e)}},{key:"getAllLeadColumns",value:function(e){var t=d.a.apiUrl+"/lead/getAllLeadColumns";return e&&(t+="?campaignType="+e),this.http.get(t)}},{key:"updateLead",value:function(e,t){return this.http.put("".concat(d.a.apiUrl,"/lead/").concat(e),t)}},{key:"getLeadById",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/lead/").concat(e))}},{key:"reassignLead",value:function(e,t,n){return this.http.post(d.a.apiUrl+"/lead/reassignLead",{oldUserEmail:e,newUserEmail:t,lead:n})}},{key:"getHistoryForLead",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/lead/getLeadHistoryById/").concat(e))}},{key:"getBasicOverview",value:function(){return this.http.get(d.a.apiUrl+"/lead/basicOverview")}},{key:"suggestLead",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/lead/suggest/").concat(e))}},{key:"getLeadMappings",value:function(e){var t=this;return new Promise((function(n,i){var a=[];t.getAllLeadColumns(e).subscribe((function(e){e.paths.forEach((function(e){a.push({label:e.readableField,value:e.internalField,checked:e.checked,type:e.type,options:e.options})}));var t=Object.assign.apply(Object,[{}].concat(_toConsumableArray(a.map((function(e){return _defineProperty({},e.value,e)})))));n({typeDict:t,mSchema:e})}),(function(e){i({error:"something went wrong in leads service"})}))}))}},{key:"fetchNextLead",value:function(e,t){return this.http.get("".concat(d.a.apiUrl,"/lead/fetchNextLead/").concat(e,"/").concat(t))}}]),e}()).\u0275fac=function(e){return new(e||i)(p.ec(m.c))},i.\u0275prov=p.Qb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),b=n("Nqz0"),g=n("f2kA"),z=n("pLZG"),v=((a=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getCampaigns",value:function(e,t,n,i,a){return this.http.post(d.a.apiUrl+"/campaign/get",{pageIndex:e,pageSize:t,filters:n,sortField:i,sortOrder:a})}},{key:"getHandlerEmailHints",value:function(e){var t=(new m.g).append("partialEmail",""+e);return this.http.get(d.a.apiUrl+"/campaign/autocomplete/suggestEmails",{params:t})}},{key:"getAllCampaignTypes",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/campaign/autocomplete/suggestTypes?hint=").concat(e))}},{key:"getAllEmailTemplates",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/lead/getAllEmailTemplates?campaign=").concat(e.campaign))}},{key:"createEmailTemplate",value:function(e){return this.http.post(d.a.apiUrl+"/lead/getAllEmailTemplates",e)}},{key:"handleFilesUpload",value:function(e){var t=new m.h("POST",d.a.apiUrl+"/lead/saveAttachments",e,{});return this.http.request(t).pipe(Object(z.a)((function(e){return e instanceof m.i})))}},{key:"createCampaignAndDisposition",value:function(e){var t=new m.h("POST",d.a.apiUrl+"/campaign/createCampaignAndDisposition",e,{});return this.http.request(t).pipe(Object(z.a)((function(e){return e instanceof m.i})))}},{key:"uploadMultipleLeadFiles",value:function(e){var t=new m.h("POST",d.a.apiUrl+"/lead/uploadMultipleLeadFiles",e,{});return this.http.request(t).pipe(Object(z.a)((function(e){return e instanceof m.i})))}},{key:"handleEmailTemplateUpload",value:function(e){return this.http.post(d.a.apiUrl+"/lead/createEmailTemplate",e)}},{key:"uploadCampaignFile",value:function(e){var t=new m.h("POST",d.a.apiUrl+"/campaign/config/upload",e,{});return this.http.request(t).pipe(Object(z.a)((function(e){return e instanceof m.i})))}},{key:"getDisposition",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/campaign/disposition/").concat(e))}},{key:"getUniqueKey",value:function(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}},{key:"getCampaignById",value:function(e,t){return this.http.get("".concat(d.a.apiUrl,"/campaign/").concat(e,"?identifier=").concat(t))}},{key:"populateCampaignDropdown",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){n.getCampaigns(1,20,e,"","asc").subscribe((function(e){t(e.data)}),(function(e){i(e)}))})));case 1:case"end":return t.stop()}}),t)})))}}]),e}()).\u0275fac=function(e){return new(e||a)(p.ec(m.c))},a.\u0275prov=p.Qb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),y=n("PTRe"),C=n("5vDB"),k=n("OzZK"),E=n("RwU8"),O=n("C2AL"),S=n("FwiY"),F=n("F6ss"),w=n("ocnv"),Z=n("B+r4"),P=n("zAKX"),N=n("0lU3"),x=n("TaO5"),T=n("xB20"),_=n("dEAy"),L=n("Jioy"),V=n("Ff2k"),A=n("rMZv"),M=n("Q8cG"),D=n("QlLE"),I=n("EGpF"),R=n("ncdi");function j(e,t){1&e&&(p.ac(0,"button",45),p.Vb(1,"i",46),p.Zb())}function U(e,t){if(1&e&&(p.ac(0,"th"),p.Nc(1),p.Zb()),2&e){var n=t.$implicit,i=p.lc(2);p.Eb(1),p.Pc(" ",null==i.typeDict[n.name]?null:i.typeDict[n.name].label," ")}}function X(e,t){if(1&e&&(p.ac(0,"td"),p.Nc(1),p.mc(2,"date"),p.Zb()),2&e){var n=t.$implicit,i=p.lc().$implicit,a=p.lc(2);p.Eb(1),p.Pc(" ","date"===(null==a.typeDict[n]?null:a.typeDict[n].type)?p.nc(2,1,i[n]):i[n]," ")}}function q(e,t){if(1&e){var n=p.bc();p.ac(0,"tr",51),p.ic("contextmenu",(function(e){p.Ec(n);var t=p.Dc(4);return p.lc(2).contextMenu(e,t)}))("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc(2).updateLead(e)})),p.ac(1,"td",52),p.ic("nzCheckedChange",(function(e){p.Ec(n);var i=t.$implicit;return p.lc(2).onItemChecked(i.externalId,e)})),p.Zb(),p.Lc(2,X,3,3,"td",20),p.ac(3,"nz-dropdown-menu",53,54),p.ac(5,"ul",55),p.ac(6,"li",56),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc(2).openReassignModal(e)})),p.Nc(7,"Reassign"),p.Zb(),p.ac(8,"li",56),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc(2).openReassignModal(e,!0)})),p.Nc(9,"Bulk Reassign"),p.Zb(),p.ac(10,"li",56),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc(2).showLeadHistory(e)})),p.Nc(11,"Show history"),p.Zb(),p.ac(12,"li",57),p.Nc(13,"disabled menu item"),p.Zb(),p.ac(14,"li",58),p.ac(15,"ul"),p.ac(16,"li",56),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc(2).showEmailModal(e)})),p.Nc(17,"Send Email"),p.Zb(),p.ac(18,"li",59),p.Nc(19,"4th menu item"),p.Zb(),p.Zb(),p.Zb(),p.ac(20,"li",60),p.ac(21,"ul"),p.ac(22,"li",59),p.Nc(23,"Created"),p.Zb(),p.ac(24,"li",59),p.Nc(25,"Won"),p.Zb(),p.ac(26,"li",59),p.Nc(27,"Lost"),p.Zb(),p.Zb(),p.Zb(),p.ac(28,"li",56),p.ic("click",(function(){return p.Ec(n),p.lc(2).open()})),p.Nc(29,"Advanced Filters"),p.Zb(),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit,a=p.lc(2);p.Eb(1),p.tc("nzChecked",a.setOfCheckedId.has(i.externalId)),p.Eb(1),p.tc("ngForOf",a.objectkeys(i))}}function B(e,t){if(1&e){var n=p.bc();p.ac(0,"nz-table",47,48),p.ic("nzQueryParams",(function(e){return p.Ec(n),p.lc().onQueryParamsChange(e)})),p.ac(2,"thead"),p.ac(3,"tr"),p.ac(4,"th",49),p.ic("nzCheckedChange",(function(e){return p.Ec(n),p.lc().onAllChecked(e)})),p.Zb(),p.Lc(5,U,2,1,"th",20),p.Zb(),p.Zb(),p.ac(6,"tbody"),p.Lc(7,q,30,2,"tr",50),p.Zb(),p.Zb()}if(2&e){var i=p.Dc(1),a=p.lc();p.tc("nzData",a.listOfData)("nzFrontPagination",!1)("nzLoading",a.loading)("nzTotal",a.total)("nzPageSize",a.perPage)("nzPageIndex",a.page),p.Eb(4),p.tc("nzChecked",a.checked)("nzIndeterminate",a.indeterminate),p.Eb(1),p.tc("ngForOf",a.listOfColumns),p.Eb(2),p.tc("ngForOf",i.data)}}function G(e,t){1&e&&p.Vb(0,"nz-empty")}function $(e,t){if(1&e&&p.Vb(0,"nz-option",61),2&e){var n=t.$implicit;p.tc("nzLabel",n.campaignName)("nzValue",n.campaignName)}}function H(e,t){if(1&e&&p.Vb(0,"nz-option",61),2&e){var n=t.$implicit;p.tc("nzLabel",n)("nzValue",n)}}function W(e,t){if(1&e&&(p.ac(0,"nz-form-item"),p.ac(1,"nz-form-label"),p.Nc(2),p.Zb(),p.ac(3,"nz-form-control"),p.Vb(4,"nz-switch",62),p.Zb(),p.Zb()),2&e){var n=t.$implicit;p.Eb(2),p.Pc(" ",n.name," "),p.Eb(2),p.tc("formControlName",n.formControlName)}}function Q(e,t){if(1&e&&(p.Yb(0),p.ac(1,"nz-descriptions-item",63),p.Nc(2),p.Zb(),p.Xb()),2&e){var n=t.$implicit;p.Eb(1),p.tc("nzTitle",null==n?null:n._id),p.Eb(1),p.Oc(null==n?null:n.count)}}function J(e,t){if(1&e&&(p.ac(0,"nz-auto-option",64),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.tc("nzValue",n)("nzLabel",n.subject),p.Eb(1),p.Pc(" ",n.subject," ")}}function K(e,t){if(1&e&&p.Vb(0,"nz-option",61),2&e){var n=t.$implicit;p.tc("nzLabel",n.fileName)("nzValue",n)}}function Y(e,t){1&e&&p.Nc(0),2&e&&p.Pc(" and ",t.$implicit.length," more selected ")}function ee(e,t){if(1&e){var n=p.bc();p.ac(0,"nz-list-item",65),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc().reassignLead(e)})),p.Vb(1,"nz-list-item-meta",66),p.Zb()}if(2&e){var i=t.$implicit;p.Eb(1),p.tc("nzDescription",i.email)}}function te(e,t){1&e&&p.Vb(0,"nz-list-empty")}function ne(e,t){1&e&&p.Vb(0,"div")}function ie(e,t){if(1&e&&(p.ac(0,"nz-timeline-item"),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.Eb(1),p.Pc(" ",n.note," ")}}function ae(e,t){if(1&e&&(p.ac(0,"nz-timeline"),p.Lc(1,ie,2,1,"nz-timeline-item",20),p.Zb()),2&e){var n=p.lc();p.Eb(1),p.tc("ngForOf",null==n.selectedLeadHistory?null:n.selectedLeadHistory.history)}}function oe(e,t){1&e&&p.Vb(0,"i",67)}function re(e,t){1&e&&p.Vb(0,"nz-empty")}var ce,le,se=function(){return{minRows:3,maxRows:5}},ue=function(){return{top:"20px"}},pe=((ce=function(){function e(t,n,i,a,o,c,l){_classCallCheck(this,e),this.msg=t,this.leadsService=n,this.nzContextMenuService=i,this.router=a,this.fb=o,this.usersService=c,this.campaignService=l,this.setOfCheckedId=new Set,this.page=1,this.perPage=15,this.tagPlaceHolder=3,this.showCols=[],this.listOfOption=[],this.placement="right",this.isTimelineModalVisible=!1,this.indeterminate=!1,this.checked=!1,this.listOfCurrentPageData=[],this.listOfData=[],this.objectkeys=Object.keys,this.leadOptions={page:this.page||1,perPage:this.perPage||1,searchTerm:"",filters:{assigned:!0}},this.dataLoaded=!1,this.listOfSwitch=[{name:"Ticket",formControlName:"ticket"},{name:"Lead",formControlName:"lead"},{name:"Archived",formControlName:"archived"},{name:"Assigned",formControlName:"assigned"}],this.isVisible=!1,this.total=1e3,this.loading=!1,this.etFormControl=new r.f([null]),this.attachments=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.visible=!1,this.listOfOption=["LEAD","TICKET","USER","CUSTOMER"],this.initSettingForm(),this.initEmailForm(),this.rerenderCols(),this.getAllLeadColumns(),this.initRightClickActions(),this.getBasicOverview(),this.initEtAutocomplete(),this.populateCampaignDropdown("")}},{key:"populateCampaignDropdown",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.campaignService.populateCampaignDropdown(e);case 2:this.campaignList=t.sent;case 3:case"end":return t.stop()}}),t,this)})))}},{key:"onItemChecked",value:function(e,t){console.log(e),this.updateCheckedSet(e,t),this.refreshCheckedStatus()}},{key:"updateCheckedSet",value:function(e,t){t?this.setOfCheckedId.add(e):this.setOfCheckedId.delete(e)}},{key:"onAllChecked",value:function(e){var t=this;e?this.listOfData.forEach((function(e){return t.setOfCheckedId.add(e.externalId)})):this.setOfCheckedId=new Set,this.refreshCheckedStatus()}},{key:"refreshCheckedStatus",value:function(){var e=this;this.checked=this.listOfData.every((function(t){var n=t.externalId;return e.setOfCheckedId.has(n)}))}},{key:"initRightClickActions",value:function(){var e=this;this.usersService.getUsers(0,20,"abc","asc").subscribe((function(t){var n;e.managers=t.users,e.usersCount=null===(n=null==t?void 0:t.metadata)||void 0===n?void 0:n.total}),(function(e){console.log(e)}))}},{key:"getData",value:function(){var e=this;this.leadsService.getLeads(this.leadOptions).subscribe((function(t){0===t.data.length?e.isEmpty=!0:(e.msg.info("Retrieved ".concat(t.data.length," leads")),e.isEmpty=!1,e.generateListOfCols(t.data[0]),e.listOfData=t.data,e.total=t.total)}),(function(t){e.msg.error("Some error occured while fetching leads")}))}},{key:"getAllLeadColumns",value:function(){var e=this;this.loading=!0,this.leadsService.getAllLeadColumns().subscribe((function(t){e.loading=!1,t.paths.forEach((function(t){e.showCols.push({label:t.readableField,value:t.internalField,checked:t.checked,type:t.type})})),e.typeDict=Object.assign.apply(Object,[{}].concat(_toConsumableArray(e.showCols.map((function(e){return _defineProperty({},e.value,e)})))))}),(function(t){e.loading=!1}))}},{key:"generateListOfCols",value:function(e){this.listOfColumns=Object.keys(e).map((function(e){return{name:e}}))}},{key:"createLead",value:function(){this.router.navigate(["welcome","leads","create"])}},{key:"updateLead",value:function(e){this.router.navigate(["welcome","leads","create"],{queryParams:{id:e.externalId}})}},{key:"initSettingForm",value:function(){var e=this;this.settingForm=this.fb.group({lead:[!0],archived:[!1],assigned:[!0],dateRange:[null],selectedCampaign:[""]}),this.settingValue=this.settingForm.value,this.settingForm.valueChanges.pipe(Object(s.a)(300),Object(u.a)()).subscribe((function(t){e.settingValue=t,e.leadOptions.filters=Object.assign(Object.assign({},e.leadOptions.filters),e.settingForm.value),e.getData()}))}},{key:"rerenderCols",value:function(){this.leadOptions.showCols=this.showCols.filter((function(e){return e.checked})).map((function(e){return e.value})),this.getData()}},{key:"onPageIndexChange",value:function(e){this.page=e,this.getData()}},{key:"open",value:function(){this.visible=!0}},{key:"close",value:function(){this.visible=!1}},{key:"handleSearchTerm",value:function(){this.getData()}},{key:"showLeadHistory",value:function(e){var t=this,n=null==e?void 0:e.externalId;this.selectedLead=e,this.leadsService.getHistoryForLead(n).subscribe((function(e){t.selectedLeadHistory=e,t.isTimelineModalVisible=!0}),(function(n){t.selectedLeadHistory=void 0,t.msg.error(n.message+" : "+e.externalId)}))}},{key:"showEmailModal",value:function(e){console.log(e),this.isVisible=!0}},{key:"handleOk",value:function(){console.log("Button ok clicked!"),this.isVisible=!1}},{key:"handleCancel",value:function(){console.log("Button cancel clicked!"),this.isVisible=!1}},{key:"contextMenu",value:function(e,t){this.nzContextMenuService.create(e,t)}},{key:"closeMenu",value:function(){this.nzContextMenuService.close()}},{key:"reassignLead",value:function(e){var t=this;console.log(this.selectedLead,e),this.leadsService.reassignLead(this.selectedLead.email,e.email,this.selectedLead).subscribe((function(e){t.msg.success("Successfully reassigned lead")}),(function(e){t.msg.error(e.error)}))}},{key:"openReassignModal",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],this.selectedLead=e,this.selectedManager=new r.f(null),this.selectedManager.valueChanges.subscribe((function(e){console.log(e)})),this.isReassignmentModalVisible=!0}},{key:"handleReassignmentCancel",value:function(){this.isReassignmentModalVisible=!1}},{key:"handleTimelineClose",value:function(){this.isTimelineModalVisible=!1}},{key:"handleReassignmentSubmit",value:function(){}},{key:"onQueryParamsChange",value:function(e){console.log(e);var t=e.pageSize,n=e.pageIndex;e.sort.find((function(e){return null!==e.value})),this.leadOptions.perPage=t,this.leadOptions.page=n,this.getData()}},{key:"getBasicOverview",value:function(){var e=this;this.leadsService.getBasicOverview().subscribe((function(t){e.basicOverview=t}),(function(e){console.log(e.messsage)}))}},{key:"populateEmailModal",value:function(e){console.log(typeof e,e.nzValue),this.selectedEmailTemplate=e.nzValue,this.attachments=this.selectedEmailTemplate.attachments,this.emailForm.patchValue({subject:this.selectedEmailTemplate.subject,content:this.selectedEmailTemplate.content})}},{key:"initEtAutocomplete",value:function(){var e=this;this.etFormControl.valueChanges.pipe(Object(s.a)(500),Object(u.a)()).subscribe((function(t){e.campaignService.getAllEmailTemplates({campaign:t}).subscribe((function(t){e.emailTemplates=t}))}))}},{key:"initEmailForm",value:function(){this.emailForm=this.fb.group({subject:[null],content:[null],attachments:[null]})}},{key:"submitEmailForm",value:function(e){console.log(e)}}]),e}()).\u0275fac=function(e){return new(e||ce)(p.Ub(f.e),p.Ub(h),p.Ub(b.a),p.Ub(c.d),p.Ub(r.e),p.Ub(g.a),p.Ub(v))},ce.\u0275cmp=p.Ob({type:ce,selectors:[["app-leads"]],decls:77,vars:55,consts:[[1,"table-operations"],["nzSearch","",2,"display","inline-block","max-width","150px",3,"nzAddOnAfter","change"],["type","text","nz-input","","placeholder","Global Search",3,"ngModel","ngModelChange"],["suffixIconButton",""],["nzType","vertical"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","aim","nzTheme","outline"],["nz-icon","","nzType","plus","nzTheme","outline"],["nzTableLayout","scroll","nzShowSizeChanger","",3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzQueryParams",4,"ngIf"],[4,"ngIf"],["nzTitle","Select Advanced Filters","nzWidth","350px",3,"nzClosable","nzVisible","nzPlacement","nzOnClose"],["nz-form","","nzLayout","vertical",3,"formGroup"],["nzFor","dateRange",3,"nzSpan"],["nzMode","default","nzPlaceHolder","Inserted are removed","formControlName","selectedCampaign"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[3,"nzSpan"],["formControlName","dateRange"],["nzFor","moduleTypes",3,"nzSpan"],["nzMode","multiple","nzPlaceHolder","Please select","formControlName","moduleTypes",3,"nzMaxTagCount","nzMaxTagPlaceholder"],["nz-form","","nzLayout","inline",3,"formGroup"],[4,"ngFor","ngForOf"],["nzText","Fields To Show"],[3,"ngModel","ngModelChange"],["nzText","Leads By Status"],["nzLayout","vertical"],[3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nzRequired","",3,"nzSm","nzXs"],["placeholder","Select Campaign","nz-input","",3,"formControl","nzAutocomplete"],[3,"selectionChange"],["autob",""],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzSm","nzXs"],["nz-input","","placeholder","Write the subject of email","formControlName","subject"],["nz-input","","placeholder","Controlled autosize","formControlName","content",3,"nzAutosize"],["nzMode","multiple","nzPlaceHolder","Please select attachments from the dropdown","formControlName","attachments",3,"nzMaxTagCount","nzMaxTagPlaceholder"],["tagPlaceHolder",""],["nzWidth","300","nzTitle","Pick a user",3,"nzStyle","nzVisible","nzVisibleChange","nzOnCancel"],["nz-input","","placeholder","Enter user name","nzSize","small","name","selectedManager",3,"formControl"],["nzItemLayout","horizontal",3,"nzLoading"],[3,"click",4,"ngFor","ngForOf"],[4,"nzModalFooter"],[3,"nzVisible","nzTitle","nzVisibleChange","nzOnCancel"],[4,"ngIf","ngIfElse"],["dotTemplate",""],["empty",""],["nz-button","","nzType","primary","nzSearch",""],["nz-icon","","nzType","search"],["nzTableLayout","scroll","nzShowSizeChanger","",3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzQueryParams"],["filterTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],[3,"contextmenu","click",4,"ngFor","ngForOf"],[3,"contextmenu","click"],[3,"nzChecked","nzCheckedChange"],[1,"context-area"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item","","nzDisabled",""],["nz-submenu","","nzTitle","Email/Message"],["nz-menu-item",""],["nz-submenu","","nzTitle","Move To"],[3,"nzLabel","nzValue"],[3,"formControlName"],["nzColumn","24",3,"nzTitle"],[3,"nzValue","nzLabel"],[3,"click"],[3,"nzDescription"],["nz-icon","","nzType","clock-circle-o",2,"font-size","16px"]],template:function(e,t){if(1&e&&(p.ac(0,"div",0),p.ac(1,"nz-input-group",1),p.ic("change",(function(){return t.handleSearchTerm()})),p.ac(2,"input",2),p.ic("ngModelChange",(function(e){return t.leadOptions.searchTerm=e})),p.Zb(),p.Zb(),p.Lc(3,j,2,0,"ng-template",null,3,p.Mc),p.Vb(5,"nz-divider",4),p.ac(6,"button",5),p.ic("click",(function(){return t.open()})),p.Vb(7,"i",6),p.Nc(8,"Advanced Filters"),p.Zb(),p.ac(9,"button",5),p.ic("click",(function(){return t.createLead()})),p.Vb(10,"i",7),p.Nc(11," Lead"),p.Zb(),p.Zb(),p.Lc(12,B,8,10,"nz-table",8),p.Lc(13,G,1,0,"nz-empty",9),p.ac(14,"nz-drawer",10),p.ic("nzOnClose",(function(){return t.close()})),p.ac(15,"form",11),p.ac(16,"nz-form-item"),p.ac(17,"nz-form-label",12),p.Nc(18,"Select Campaign"),p.Zb(),p.ac(19,"nz-select",13),p.Lc(20,$,1,2,"nz-option",14),p.Zb(),p.Zb(),p.ac(21,"nz-form-item"),p.ac(22,"nz-form-label",12),p.Nc(23,"Date Range"),p.Zb(),p.ac(24,"nz-form-control",15),p.Vb(25,"nz-range-picker",16),p.Zb(),p.Zb(),p.ac(26,"nz-form-item"),p.ac(27,"nz-form-label",17),p.Nc(28,"Module Types"),p.Zb(),p.ac(29,"nz-select",18),p.Lc(30,H,1,2,"nz-option",14),p.Zb(),p.Zb(),p.Zb(),p.ac(31,"form",19),p.Lc(32,W,5,2,"nz-form-item",20),p.Zb(),p.Vb(33,"nz-divider",21),p.ac(34,"nz-checkbox-group",22),p.ic("ngModelChange",(function(e){return t.showCols=e}))("ngModelChange",(function(){return t.rerenderCols()})),p.Zb(),p.Vb(35,"nz-divider",23),p.ac(36,"nz-descriptions",24),p.Lc(37,Q,3,2,"ng-container",20),p.Zb(),p.Zb(),p.ac(38,"nz-modal",25),p.ic("nzVisibleChange",(function(e){return t.isVisible=e}))("nzOnCancel",(function(){return t.handleCancel()}))("nzOnOk",(function(){return t.handleOk()})),p.ac(39,"form",11),p.ac(40,"nz-form-item"),p.ac(41,"nz-form-label",26),p.Nc(42,"Select Campaign"),p.Zb(),p.Vb(43,"input",27),p.ac(44,"nz-autocomplete",28,29),p.ic("selectionChange",(function(e){return t.populateEmailModal(e)})),p.Lc(46,J,2,3,"nz-auto-option",30),p.Zb(),p.Zb(),p.ac(47,"nz-form-item"),p.ac(48,"nz-form-label",26),p.Nc(49,"Subject"),p.Zb(),p.ac(50,"nz-form-control",31),p.Vb(51,"input",32),p.Zb(),p.Zb(),p.ac(52,"nz-form-item"),p.ac(53,"nz-form-label",26),p.Nc(54,"Body"),p.Zb(),p.ac(55,"nz-form-control",31),p.Vb(56,"textarea",33),p.Zb(),p.Zb(),p.ac(57,"nz-form-item"),p.ac(58,"nz-form-label",26),p.Nc(59,"Attachments"),p.Zb(),p.ac(60,"nz-form-control",31),p.ac(61,"nz-select",34),p.Lc(62,K,1,2,"nz-option",14),p.Zb(),p.Lc(63,Y,1,1,"ng-template",null,35,p.Mc),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(65,"nz-modal",36),p.ic("nzVisibleChange",(function(e){return t.isReassignmentModalVisible=e}))("nzOnCancel",(function(){return t.handleReassignmentCancel()})),p.Vb(66,"input",37),p.ac(67,"nz-list",38),p.Lc(68,ee,2,1,"nz-list-item",39),p.Lc(69,te,1,0,"nz-list-empty",9),p.Zb(),p.Lc(70,ne,1,0,"div",40),p.Zb(),p.ac(71,"nz-modal",41),p.ic("nzVisibleChange",(function(e){return t.isTimelineModalVisible=e}))("nzOnCancel",(function(){return t.handleTimelineClose()})),p.Lc(72,ae,2,1,"nz-timeline",42),p.Zb(),p.Lc(73,oe,1,0,"ng-template",null,43,p.Mc),p.Lc(75,re,1,0,"ng-template",null,44,p.Mc)),2&e){var n=p.Dc(4),i=p.Dc(45),a=p.Dc(64),o=p.Dc(76);p.Eb(1),p.tc("nzAddOnAfter",n),p.Eb(1),p.tc("ngModel",t.leadOptions.searchTerm),p.Eb(10),p.tc("ngIf",!t.isEmpty),p.Eb(1),p.tc("ngIf",t.isEmpty),p.Eb(1),p.tc("nzClosable",!1)("nzVisible",t.visible)("nzPlacement",t.placement),p.Eb(1),p.tc("formGroup",t.settingForm),p.Eb(2),p.tc("nzSpan",24),p.Eb(3),p.tc("ngForOf",t.campaignList),p.Eb(2),p.tc("nzSpan",24),p.Eb(2),p.tc("nzSpan",24),p.Eb(3),p.tc("nzSpan",24),p.Eb(2),p.tc("nzMaxTagCount",3)("nzMaxTagPlaceholder",a),p.Eb(1),p.tc("ngForOf",t.listOfOption),p.Eb(1),p.tc("formGroup",t.settingForm),p.Eb(1),p.tc("ngForOf",t.listOfSwitch),p.Eb(2),p.tc("ngModel",t.showCols),p.Eb(3),p.tc("ngForOf",null==t.basicOverview?null:t.basicOverview.result),p.Eb(1),p.tc("nzVisible",t.isVisible),p.Eb(1),p.tc("formGroup",t.emailForm),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("formControl",t.etFormControl)("nzAutocomplete",i),p.Eb(3),p.tc("ngForOf",t.emailTemplates),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(3),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(1),p.tc("nzAutosize",p.xc(53,se)),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(1),p.tc("nzMaxTagCount",3)("nzMaxTagPlaceholder",a),p.Eb(1),p.tc("ngForOf",t.attachments),p.Eb(3),p.tc("nzStyle",p.xc(54,ue))("nzVisible",t.isReassignmentModalVisible),p.Eb(1),p.tc("formControl",t.selectedManager),p.Eb(1),p.tc("nzLoading",!1),p.Eb(1),p.tc("ngForOf",t.managers),p.Eb(1),p.tc("ngIf",!t.managers||0===t.managers.length),p.Eb(2),p.vc("nzTitle","History for Lead ",null==t.selectedLead?null:t.selectedLead.externalId,""),p.tc("nzVisible",t.isTimelineModalVisible),p.Eb(1),p.tc("ngIf",(null==t.selectedLeadHistory||null==t.selectedLeadHistory.history?null:t.selectedLeadHistory.history.length)>0)("ngIfElse",o)}},directives:[y.c,y.b,r.c,r.n,r.q,C.a,k.a,E.a,O.a,S.b,o.m,F.a,r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,P.e,r.h,o.l,w.a,N.b,N.d,x.b,T.a,_.a,L.d,r.g,L.a,y.a,V.a,_.b,A.b,A.i,A.j,A.a,A.g,A.h,A.d,A.e,b.d,M.c,M.d,M.f,D.b,P.a,I.a,T.b,L.c,V.e,V.f,V.b,R.a,R.b],pipes:[o.e],styles:[".table-operations[_ngcontent-%COMP%]{margin-bottom:16px}.table-operations[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:8px}.context-area[_ngcontent-%COMP%]{background:#f7f7f7;color:#777;text-align:center;height:200px;line-height:200px}"]}),ce),fe=[{name:"Name",sortOrder:null,sortFn:function(e,t){return e.name.localeCompare(t.name)},filterFn:function(e,t){return e.some((function(e){return-1!==t.name.indexOf(e)}))}},{name:"Email",sortOrder:null,sortFn:function(e,t){return e.email.localeCompare(t.email)}},{name:"Phone Number",sortFn:function(e,t){return e.phoneNumber.localeCompare(t.phoneNumber)}},{name:"Assigned to",sortFn:function(e,t){return e.assignedTo.localeCompare(t.assignedTo)}},{name:"Description"},{name:"Created At"}],de=((le=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getAllTickets",value:function(e,t){return this.http.get("".concat(d.a.apiUrl,"/ticket?page=").concat(e,"&perPage=").concat(t))}},{key:"addTicket",value:function(e){return this.http.post(d.a.apiUrl+"/ticket",e)}},{key:"getTicketById",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/ticket/").concat(e))}},{key:"getTicketByLeadId",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/ticket/lead/").concat(e))}},{key:"updateTicket",value:function(e,t){return this.http.put("".concat(d.a.apiUrl,"/ticket/").concat(t),e)}},{key:"suggestLead",value:function(e){return this.http.get("".concat(d.a.apiUrl,"/ticket/suggest/").concat(e))}}]),e}()).\u0275fac=function(e){return new(e||le)(p.ec(m.c))},le.\u0275prov=p.Qb({token:le,factory:le.\u0275fac,providedIn:"root"}),le);function me(e,t){if(1&e){var n=p.bc();p.ac(0,"th",8),p.ic("nzSortOrderChange",(function(e){return p.Ec(n),t.$implicit.sortOrder=e})),p.Nc(1),p.Zb()}if(2&e){var i=t.$implicit;p.tc("nzSortOrder",i.sortOrder)("nzSortFn",i.sortFn)("nzFilters",i.listOfFilter)("nzFilterFn",i.filterFn),p.Eb(1),p.Pc(" ",i.name," ")}}function he(e,t){if(1&e){var n=p.bc();p.ac(0,"tr",9),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc().updateTicket(e)})),p.ac(1,"td"),p.Nc(2),p.Zb(),p.ac(3,"td"),p.Nc(4),p.Zb(),p.ac(5,"td"),p.Nc(6),p.Zb(),p.ac(7,"td"),p.Nc(8),p.Zb(),p.ac(9,"td"),p.Nc(10),p.Zb(),p.ac(11,"td"),p.Nc(12),p.mc(13,"date"),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit;p.Eb(2),p.Oc(i.name),p.Eb(2),p.Oc(i.email),p.Eb(2),p.Oc(i.phoneNumber),p.Eb(2),p.Oc(i.assignedTo),p.Eb(2),p.Oc(i.description),p.Eb(2),p.Oc(p.nc(13,6,i.createdAt))}}var be,ge,ze=((ge=function(){function e(t,n,i){_classCallCheck(this,e),this.msg=t,this.ticketsService=n,this.router=i,this.listOfData=[],this.page=1,this.perPage=15}return _createClass(e,[{key:"ngOnInit",value:function(){this.listOfColumns=fe,this.generateData()}},{key:"generateData",value:function(){var e=this;this.ticketsService.getAllTickets(this.page,this.perPage).subscribe((function(t){e.msg.info("Retrieved some leads"),t.forEach((function(t){e.listOfData.push({_id:t._id,name:t.nickname,email:t.email,phoneNumber:t.phoneNumber,assignedTo:t.assignedTo,description:"rewrite change history",createdAt:t.createdAt})}))}),(function(t){e.msg.error("Some error occured while fetching leads")}))}},{key:"trackByName",value:function(e,t){return t.name}},{key:"sortByAge",value:function(){this.listOfColumns.forEach((function(e){e.sortOrder="Age"===e.name?"descend":null}))}},{key:"resetFilters",value:function(){this.listOfColumns.forEach((function(e){"Name"===e.name?e.listOfFilter=[{text:"Joe",value:"Joe"},{text:"Jim",value:"Jim"}]:"Address"===e.name&&(e.listOfFilter=[{text:"London",value:"London"},{text:"Sidney",value:"Sidney"}])}))}},{key:"createTicket",value:function(){this.router.navigate(["welcome","tickets","create"])}},{key:"resetSortAndFilters",value:function(){this.listOfColumns.forEach((function(e){e.sortOrder=null})),this.resetFilters()}},{key:"onPageIndexChange",value:function(e){this.page=e,this.generateData()}},{key:"onPageSizeChange",value:function(e){this.perPage=e,this.generateData()}},{key:"updateTicket",value:function(e){console.log(e),this.router.navigate(["welcome","tickets","create"],{queryParams:{id:e._id}})}}]),e}()).\u0275fac=function(e){return new(e||ge)(p.Ub(f.e),p.Ub(de),p.Ub(c.d))},ge.\u0275cmp=p.Ob({type:ge,selectors:[["app-tickets"]],decls:15,vars:4,consts:[[1,"table-operations"],["nz-button","",3,"click"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],["nzTableLayout","fixed","nzShowPagination","","nzShowSizeChanger","",3,"nzData","nzPageIndexChange","nzPageSizeChange"],["filterTable",""],[3,"nzSortOrder","nzSortFn","nzFilters","nzFilterFn","nzSortOrderChange",4,"ngFor","ngForOf","ngForTrackBy"],[3,"click",4,"ngFor","ngForOf"],[3,"nzSortOrder","nzSortFn","nzFilters","nzFilterFn","nzSortOrderChange"],[3,"click"]],template:function(e,t){if(1&e&&(p.ac(0,"div",0),p.ac(1,"button",1),p.ic("click",(function(){return t.resetFilters()})),p.Nc(2,"Clear filters"),p.Zb(),p.ac(3,"button",1),p.ic("click",(function(){return t.resetSortAndFilters()})),p.Nc(4," Clear filters and sorters "),p.Zb(),p.ac(5,"button",2),p.ic("click",(function(){return t.createTicket()})),p.Vb(6,"i",3),p.Nc(7,"Ticket"),p.Zb(),p.Zb(),p.ac(8,"nz-table",4,5),p.ic("nzPageIndexChange",(function(e){return t.onPageIndexChange(e)}))("nzPageSizeChange",(function(e){return t.onPageSizeChange(e)})),p.ac(10,"thead"),p.ac(11,"tr"),p.Lc(12,me,2,5,"th",6),p.Zb(),p.Zb(),p.ac(13,"tbody"),p.Lc(14,he,14,8,"tr",7),p.Zb(),p.Zb()),2&e){var n=p.Dc(9);p.Eb(8),p.tc("nzData",t.listOfData),p.Eb(4),p.tc("ngForOf",t.listOfColumns)("ngForTrackBy",t.trackByName),p.Eb(2),p.tc("ngForOf",n.data)}},directives:[k.a,E.a,O.a,S.b,A.b,A.i,A.j,o.l,A.d,A.a,A.g,A.f],pipes:[o.e],styles:[".table-operations[_ngcontent-%COMP%]{margin-bottom:16px}.table-operations[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:8px}"]}),ge),ve=((be=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"uploadCustomers",value:function(e){var t=new FormData;return t.append("customers",e),this.http.post("http://35.154.8.217:5182/customer/many",t)}}]),e}()).\u0275fac=function(e){return new(e||be)(p.ec(m.c))},be.\u0275prov=p.Qb({token:be,factory:be.\u0275fac,providedIn:"root"}),be),ye=n("D9mS");function Ce(e,t){if(1&e){var n=p.bc();p.ac(0,"div",3),p.ac(1,"div",4),p.ac(2,"nz-upload",5),p.ic("nzChange",(function(e){return p.Ec(n),p.lc().handleChange(e)})),p.ac(3,"p",6),p.Vb(4,"i",7),p.Zb(),p.ac(5,"p",8),p.Nc(6),p.Zb(),p.ac(7,"p",9),p.Nc(8," Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files "),p.Zb(),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit,a=p.lc();p.tc("nzSpan",24/a.count),p.Eb(2),p.uc("nzAction",i.url),p.tc("nzMultiple",!0),p.Eb(4),p.Pc("Click or drag ",i.name," file")}}function ke(e,t){if(1&e){var n=p.bc();p.ac(0,"div",3),p.ac(1,"div",4),p.ac(2,"nz-upload",5),p.ic("nzChange",(function(e){return p.Ec(n),p.lc().handleChange(e)})),p.ac(3,"p",6),p.Vb(4,"i",7),p.Zb(),p.ac(5,"p",8),p.Nc(6),p.Zb(),p.ac(7,"p",9),p.Nc(8," Support for a single or bulk upload. Strictly prohibit from uploading company data or other band files "),p.Zb(),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit,a=p.lc();p.tc("nzSpan",24/a.count),p.Eb(2),p.uc("nzAction",i.url),p.tc("nzMultiple",!0),p.Eb(4),p.Pc("Click or drag ",i.name," file")}}var Ee,Oe=function(e,t){return[e,t]},Se=((Ee=function(){function e(t,n){_classCallCheck(this,e),this.msg=t,this.customerService=n,this.hGutter=16,this.vGutter=16,this.count=3,this.array1=[{name:"customer",url:"http://localhost:3000/customer/many?type=customer"},{name:"lead",url:"http://localhost:3000/customer/many?type=lead"},{name:"ticket",url:"http://localhost:3000/customer/many?type=ticket"}],this.array2=[{name:"campaign",url:"http://localhost:3000/customer/many?type=campaign"},{name:"users",url:"http://localhost:3000/user/many"}]}return _createClass(e,[{key:"handleChange",value:function(e){var t=e.file,n=e.fileList,i=t.status;"uploading"!==i&&console.log(t,n),"done"===i?this.msg.success(t.name+" file uploaded successfully."):"error"===i&&this.msg.error(t.name+" file upload failed.")}},{key:"reGenerateArray",value:function(e){}}]),e}()).\u0275fac=function(e){return new(e||Ee)(p.Ub(f.e),p.Ub(ve))},Ee.\u0275cmp=p.Ob({type:Ee,selectors:[["app-uploads"]],decls:5,vars:10,consts:[[1,"gutter-example"],["nz-row","",3,"nzGutter"],["nz-col","","class","gutter-row",3,"nzSpan",4,"ngFor","ngForOf"],["nz-col","",1,"gutter-row",3,"nzSpan"],[1,"grid-config"],["nzType","drag","nzName","file",3,"nzMultiple","nzAction","nzChange"],[1,"ant-upload-drag-icon"],["nz-icon","","nzType","inbox"],[1,"ant-upload-text"],[1,"ant-upload-hint"]],template:function(e,t){1&e&&(p.ac(0,"div",0),p.ac(1,"div",1),p.Lc(2,Ce,9,4,"div",2),p.Zb(),p.ac(3,"div",1),p.Lc(4,ke,9,4,"div",2),p.Zb(),p.Zb()),2&e&&(p.Eb(1),p.tc("nzGutter",p.zc(4,Oe,t.hGutter,t.vGutter)),p.Eb(1),p.tc("ngForOf",t.array1),p.Eb(1),p.tc("nzGutter",p.zc(7,Oe,t.hGutter,t.vGutter)),p.Eb(1),p.tc("ngForOf",t.array2))},directives:[Z.c,o.l,Z.a,ye.a,O.a,S.b],styles:[".slider[_ngcontent-%COMP%]{width:50%}.slider-container[_ngcontent-%COMP%]{margin-bottom:16px}.grid-config[_ngcontent-%COMP%]{height:220px;font-size:14px;line-height:120px;background:#0092ff;border-radius:4px}"]}),Ee),Fe=n("+oEP");function we(e,t){if(1&e&&(p.Vb(0,"i",20),p.Nc(1)),2&e){var n=p.lc().$implicit;p.Eb(1),p.Pc(" ",n.managedBy.email,"")}}function Ze(e,t){if(1&e&&(p.Vb(0,"i",20),p.Nc(1)),2&e){var n=p.lc().$implicit;p.Eb(1),p.Oc(n.managedBy.roleType)}}function Pe(e,t){if(1&e){var n=p.bc();p.ac(0,"li",21),p.ic("click",(function(){p.Ec(n);var e=t.$implicit,i=p.lc().$implicit;return p.lc().reassignToUser(e,i)})),p.Nc(1),p.Zb()}if(2&e){var i=t.$implicit;p.Eb(1),p.Pc(" ",i.email," ")}}function Ne(e,t){if(1&e){var n=p.bc();p.ac(0,"tr",9),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc().navigate(e.email)})),p.ac(1,"td"),p.Nc(2),p.Zb(),p.ac(3,"td"),p.Nc(4),p.Zb(),p.ac(5,"td"),p.Nc(6),p.Zb(),p.ac(7,"td"),p.Nc(8),p.Zb(),p.ac(9,"td",10),p.Nc(10),p.Zb(),p.ac(11,"td",11),p.Vb(12,"i",12),p.Nc(13," \xa0 "),p.ac(14,"i",13),p.ic("click",(function(e){return p.Ec(n),p.lc().takeActions("history"),e.stopPropagation()})),p.Zb(),p.Nc(15," \xa0 "),p.ac(16,"i",14),p.ic("click",(function(e){return p.Ec(n),p.lc().takeActions("unassign"),e.stopPropagation()})),p.Zb(),p.Zb(),p.Lc(17,we,2,1,"ng-template",null,15,p.Mc),p.Lc(19,Ze,2,1,"ng-template",null,16,p.Mc),p.ac(21,"nz-dropdown-menu",null,17),p.ac(23,"ul",18),p.Lc(24,Pe,2,1,"li",19),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit,a=p.Dc(18),o=p.Dc(20),r=p.Dc(22),c=p.lc();p.Eb(2),p.Oc(i._id),p.Eb(2),p.Oc(i.email),p.Eb(2),p.Oc(i.createdAt),p.Eb(2),p.Oc(i.roleType),p.Eb(1),p.tc("nzPopoverTitle",a)("nzPopoverContent",o),p.Eb(1),p.Oc(null==i||null==i.managedBy?null:i.managedBy.email),p.Eb(2),p.tc("nzDropdownMenu",r),p.Eb(12),p.tc("ngForOf",c.managers)}}var xe,Te=function(){return["create"]},_e=((xe=function(){function e(t,n,i){_classCallCheck(this,e),this.usersService=t,this.nzContextMenuService=n,this.router=i,this.total=1,this.listOfRandomUser=[],this.loading=!0,this.pageSize=10,this.pageIndex=1,this.filterGender=[{text:"male",value:"male"},{text:"female",value:"female"}]}return _createClass(e,[{key:"loadDataFromServer",value:function(e,t,n,i,a){var o=this;this.loading=!0,this.usersService.getUsers(e,t,n,i,a).subscribe((function(e){o.loading=!1,o.total=e.metadata.total,o.listOfRandomUser=e.users}))}},{key:"navigate",value:function(e){this.router.navigate(["welcome","users","details",e])}},{key:"onQueryParamsChange",value:function(e){console.log(e);var t=e.pageSize,n=e.pageIndex,i=e.sort,a=e.filter,o=i.find((function(e){return null!==e.value}));this.loadDataFromServer(n,t,o&&o.key||null,o&&o.value||null,a)}},{key:"ngOnInit",value:function(){var e=this;this.loadDataFromServer(this.pageIndex,this.pageSize,null,null,[]),this.usersService.getManagersForReassignment().subscribe((function(t){e.managers=t}),(function(e){console.log(e)}))}},{key:"takeActions",value:function(e){console.log(e)}},{key:"closeMenu",value:function(){this.nzContextMenuService.close()}},{key:"reassignToUser",value:function(e,t){this.usersService.assignManager(e,t).subscribe((function(e){console.log(e)}),(function(e){console.log(e)}))}}]),e}()).\u0275fac=function(e){return new(e||xe)(p.Ub(g.a),p.Ub(b.a),p.Ub(c.d))},xe.\u0275cmp=p.Ob({type:xe,selectors:[["app-users"]],decls:19,vars:15,consts:[[3,"routerLink"],["nzShowSizeChanger","",3,"nzData","nzFrontPagination","nzLoading","nzTotal","nzPageSize","nzPageIndex","nzQueryParams"],["nzColumnKey","id",3,"nzSortFn"],["nzColumnKey","email",3,"nzFilters","nzFilterFn"],["nzColumnKey","createdAt",3,"nzSortFn"],["nzColumnKey","role",3,"nzSortFn"],["nzColumnKey","managedBy"],["nzColumnKey","actions",3,"nzSortFn"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["nz-popover","",3,"nzPopoverTitle","nzPopoverContent"],[1,"actions"],["nz-icon","","nzType","api","nzTheme","fill","nz-dropdown","","nzTrigger","click",3,"nzDropdownMenu"],["nz-icon","","nzType","book","nzTheme","outline",3,"click"],["nz-icon","","nzType","user-delete","nzTheme","outline",3,"click"],["titleTemplate",""],["contentTemplate",""],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click",4,"ngFor","ngForOf"],["nz-icon",""],["nz-menu-item","",3,"click"]],template:function(e,t){1&e&&(p.ac(0,"a",0),p.Nc(1,"Create a user"),p.Zb(),p.ac(2,"nz-table",1),p.ic("nzQueryParams",(function(e){return t.onQueryParamsChange(e)})),p.ac(3,"thead"),p.ac(4,"tr"),p.ac(5,"th",2),p.Nc(6,"Id"),p.Zb(),p.ac(7,"th",3),p.Nc(8,"Email"),p.Zb(),p.ac(9,"th",4),p.Nc(10,"Created At"),p.Zb(),p.ac(11,"th",5),p.Nc(12,"Role"),p.Zb(),p.ac(13,"th",6),p.Nc(14,"Managed By"),p.Zb(),p.ac(15,"th",7),p.Nc(16,"Actions"),p.Zb(),p.Zb(),p.Zb(),p.ac(17,"tbody"),p.Lc(18,Ne,25,9,"tr",8),p.Zb(),p.Zb()),2&e&&(p.tc("routerLink",p.xc(14,Te)),p.Eb(2),p.tc("nzData",t.listOfRandomUser)("nzFrontPagination",!1)("nzLoading",t.loading)("nzTotal",t.total)("nzPageSize",t.pageSize)("nzPageIndex",t.pageIndex),p.Eb(3),p.tc("nzSortFn",!0),p.Eb(2),p.tc("nzFilters",t.filterGender)("nzFilterFn",!0),p.Eb(2),p.tc("nzSortFn",!0),p.Eb(2),p.tc("nzSortFn",!0),p.Eb(4),p.tc("nzSortFn",!0),p.Eb(3),p.tc("ngForOf",t.listOfRandomUser))},directives:[c.f,A.b,A.i,A.j,A.a,A.g,A.f,A.d,o.l,Fe.a,O.a,S.b,b.b,b.d,M.c,M.d],styles:[""]}),xe),Le=n("nJia");function Ve(e,t){1&e&&(p.Yb(0),p.Nc(1," Please confirm your password! "),p.Xb())}function Ae(e,t){1&e&&(p.Yb(0),p.Nc(1," Two passwords that you enter is inconsistent! "),p.Xb())}function Me(e,t){if(1&e&&(p.Lc(0,Ve,2,0,"ng-container",33),p.Lc(1,Ae,2,0,"ng-container",33)),2&e){var n=t.$implicit;p.tc("ngIf",n.hasError("required")),p.Eb(1),p.tc("ngIf",n.hasError("confirm"))}}function De(e,t){1&e&&(p.ac(0,"nz-select",34),p.Vb(1,"nz-option",35),p.Vb(2,"nz-option",36),p.Zb())}var Ie,Re=((Ie=function(){function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.confirmationValidator=function(e){return e.value?e.value!==n.validateForm.controls.password.value?{confirm:!0,error:!0}:{}:{required:!0}}}return _createClass(e,[{key:"submitForm",value:function(){for(var e in this.validateForm.controls)this.validateForm.controls[e].markAsDirty(),this.validateForm.controls[e].updateValueAndValidity()}},{key:"updateConfirmValidator",value:function(){var e=this;Promise.resolve().then((function(){return e.validateForm.controls.checkPassword.updateValueAndValidity()}))}},{key:"getCaptcha",value:function(e){e.preventDefault()}},{key:"ngOnInit",value:function(){this.validateForm=this.fb.group({email:[null,[r.t.email,r.t.required]],password:[null,[r.t.required]],checkPassword:[null,[r.t.required,this.confirmationValidator]],nickname:[null,[r.t.required]],phoneNumberPrefix:["+86"],phoneNumber:[null,[r.t.required]],website:[null,[r.t.required]],captcha:[null,[r.t.required]],agree:[!1]})}}]),e}()).\u0275fac=function(e){return new(e||Ie)(p.Ub(r.e))},Ie.\u0275cmp=p.Ob({type:Ie,selectors:[["app-user-create"]],decls:59,vars:39,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","email",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid E-mail!",3,"nzSm","nzXs"],["nz-input","","formControlName","email","id","email"],["nzFor","password","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your password!",3,"nzSm","nzXs"],["nz-input","","type","password","id","password","formControlName","password",3,"ngModelChange"],["nzFor","checkPassword","nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","type","password","formControlName","checkPassword","id","checkPassword"],["errorTpl",""],["nzFor","nickname","nzRequired","",3,"nzSm","nzXs"],["nz-icon","","nz-tooltip","","nzTitle","What do you want other to call you","nzType","question-circle","nzTheme","outline"],["nzErrorTip","Please input your nickname!",3,"nzSm","nzXs"],["nz-input","","id","nickname","formControlName","nickname"],["nzFor","phoneNumber","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input",""],["nzFor","website","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input website!",3,"nzSm","nzXs"],["nz-input","","id","website","formControlName","website","placeholder","website"],["nzFor","captcha","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input the captcha you got!","nzExtra","We must make sure that your are a human.",3,"nzSm","nzXs"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nz-input","","formControlName","captcha","id","captcha"],["nz-button","",3,"click"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-checkbox","","formControlName","agree"],["nz-button","","nzType","primary"],[4,"ngIf"],["formControlName","phoneNumberPrefix",1,"phone-select"],["nzLabel","+86","nzValue","+86"],["nzLabel","+87","nzValue","+87"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-label",1),p.Nc(3,"E-mail"),p.Zb(),p.ac(4,"nz-form-control",2),p.Vb(5,"input",3),p.Zb(),p.Zb(),p.ac(6,"nz-form-item"),p.ac(7,"nz-form-label",4),p.Nc(8,"Password"),p.Zb(),p.ac(9,"nz-form-control",5),p.ac(10,"input",6),p.ic("ngModelChange",(function(){return t.updateConfirmValidator()})),p.Zb(),p.Zb(),p.Zb(),p.ac(11,"nz-form-item"),p.ac(12,"nz-form-label",7),p.Nc(13,"Confirm Password"),p.Zb(),p.ac(14,"nz-form-control",8),p.Vb(15,"input",9),p.Lc(16,Me,2,2,"ng-template",null,10,p.Mc),p.Zb(),p.Zb(),p.ac(18,"nz-form-item"),p.ac(19,"nz-form-label",11),p.ac(20,"span"),p.Nc(21," Nickname "),p.Vb(22,"i",12),p.Zb(),p.Zb(),p.ac(23,"nz-form-control",13),p.Vb(24,"input",14),p.Zb(),p.Zb(),p.ac(25,"nz-form-item"),p.ac(26,"nz-form-label",15),p.Nc(27,"Phone Number"),p.Zb(),p.ac(28,"nz-form-control",16),p.ac(29,"nz-input-group",17),p.Lc(30,De,3,0,"ng-template",null,18,p.Mc),p.Vb(32,"input",19),p.Zb(),p.Zb(),p.Zb(),p.ac(33,"nz-form-item"),p.ac(34,"nz-form-label",20),p.Nc(35,"Website"),p.Zb(),p.ac(36,"nz-form-control",21),p.Vb(37,"input",22),p.Zb(),p.Zb(),p.ac(38,"nz-form-item"),p.ac(39,"nz-form-label",23),p.Nc(40,"Captcha"),p.Zb(),p.ac(41,"nz-form-control",24),p.ac(42,"div",25),p.ac(43,"div",26),p.Vb(44,"input",27),p.Zb(),p.ac(45,"div",26),p.ac(46,"button",28),p.ic("click",(function(e){return t.getCaptcha(e)})),p.Nc(47,"Get captcha"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(48,"nz-form-item",29),p.ac(49,"nz-form-control",30),p.ac(50,"label",31),p.ac(51,"span"),p.Nc(52,"I have read the "),p.ac(53,"a"),p.Nc(54,"agreement"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(55,"nz-form-item",29),p.ac(56,"nz-form-control",30),p.ac(57,"button",32),p.Nc(58,"Register"),p.Zb(),p.Zb(),p.Zb(),p.Zb()),2&e){var n=p.Dc(17),i=p.Dc(31);p.tc("formGroup",t.validateForm),p.Eb(2),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)("nzErrorTip",n),p.Eb(5),p.tc("nzSm",6)("nzXs",24),p.Eb(4),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.phoneNumber),p.Eb(1),p.tc("nzAddOnBefore",i),p.Eb(5),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(1),p.tc("nzGutter",8),p.Eb(1),p.tc("nzSpan",12),p.Eb(2),p.tc("nzSpan",12),p.Eb(4),p.tc("nzSpan",14)("nzOffset",6),p.Eb(7),p.tc("nzSpan",14)("nzOffset",6)}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,w.a,y.b,r.c,r.n,r.h,O.a,S.b,Le.d,y.c,k.a,E.a,x.a,o.m,P.e,P.a],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}"]}),Ie),je=n("ZyQt"),Ue=n("nxWG");function Xe(e,t){1&e&&(p.ac(0,"nz-select",28),p.Vb(1,"nz-option",29),p.Vb(2,"nz-option",30),p.Vb(3,"nz-option",31),p.Zb())}var qe,Be=((qe=function(){function e(t,n,i,a,o,r){_classCallCheck(this,e),this.fb=t,this.leadsService=n,this.msg=i,this.activatedRouter=a,this.campaignService=o,this.nzContextMenuService=r,this.leadOptions=[],this.demoDispositionNodes=[],this.dataLoaded=!1,this.showCols=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.initForm(),this.mapInternalToReadableFields(),this.subscribeToQueryParamChange(),this.initDispositionCore("core"),this.subscribeToLeadIdChange()}},{key:"nzEvent",value:function(e){e.node.isLeaf&&(console.log("set this to formControl",e.node.origin.title),this.validateForm.patchValue({leadStatus:e.node.origin.title})),e.node.isExpanded=!e.node.isExpanded}},{key:"initDispositionCore",value:function(e){var t=this;this.campaignService.getDisposition(e).subscribe((function(e){console.log(e),t.demoDispositionNodes=e.options}),(function(e){console.log(e)}))}},{key:"subscribeToQueryParamChange",value:function(){var e=this,t=this.activatedRouter.snapshot.queryParams.id;t&&(this.ticketId=t,this.leadsService.getLeadById(t).subscribe((function(t){e.patchTicketToLead(t)}),(function(n){e.msg.error("Failed to fetch data for ticket id ",t)})))}},{key:"patchTicketToLead",value:function(e){console.log("patch called"),this.validateForm.patchValue(e)}},{key:"initForm",value:function(){this.validateForm=this.fb.group({_id:[null],externalId:[null,[r.t.required]],address:[null],amount:[null],companyName:[null],createdAt:[null],customerEmail:[null],email:[null],firstName:[null],followUp:[null],lastName:[null],leadStatus:[null],phoneNumber:[null],phoneNumberPrefix:["+91"],product:[null],remarks:[null],source:[null],updatedAt:[null],disposition:[null]})}},{key:"subscribeToLeadIdChange",value:function(){var e=this;this.validateForm.get("externalId").valueChanges.pipe(Object(s.a)(300),Object(u.a)()).subscribe((function(t){console.log(t),e.leadsService.suggestLead(t).subscribe((function(t){e.leadOptions=t.map((function(e){return e.externalId}))}))}))}},{key:"fetchSelectedLead",value:function(e){var t=this;this.leadsService.getLeadById(e.nzValue).subscribe((function(e){t.validateForm.patchValue({_id:e._id,externalId:e.externalId,address:e.address,amount:e.amount,companyName:e.companyName,createdAt:e.createdAt,customerEmail:e.customerEmail,email:e.email,firstName:e.firstName,followUp:e.followUp,lastName:e.lastName,leadStatus:e.leadStatus,phoneNumber:e.phoneNumber,phoneNumberPrefix:e.phoneNumberPrefix,product:e.product,remarks:e.remarks,source:e.source,updatedAt:e.updatedAt})}))}},{key:"submitForm",value:function(){for(var e in this.validateForm.controls)this.validateForm.controls[e].markAsDirty(),this.validateForm.controls[e].updateValueAndValidity();this.ticketId?this.updateTicket():this.createTicket()}},{key:"createTicket",value:function(){var e=this;this.leadsService.addLead(this.validateForm.value).subscribe((function(t){e.msg.success("Successfully added ticket")}),(function(t){e.msg.error("Something went wrong while adding ticket")}))}},{key:"updateTicket",value:function(){var e=this;this.leadsService.updateLead(this.ticketId,this.validateForm.value).subscribe((function(t){e.msg.success("Successfully updated ticket with id "+e.ticketId)}),(function(t){e.msg.error("Failed to update ticket with id "+e.ticketId)}))}},{key:"updateConfirmValidator",value:function(){var e=this;Promise.resolve().then((function(){return e.validateForm.controls.checkPassword.updateValueAndValidity()}))}},{key:"getCaptcha",value:function(e){e.preventDefault()}},{key:"mapInternalToReadableFields",value:function(){var e=this;this.leadsService.getAllLeadColumns().subscribe((function(t){t.paths.forEach((function(t){e.showCols.push({label:t.readableField,value:t.internalField,checked:t.checked,type:t.type})})),console.log("Successfully created mappings"),e.typeDict=Object.assign.apply(Object,[{}].concat(_toConsumableArray(e.showCols.map((function(e){return _defineProperty({},e.value,e)})))))}),(function(e){console.log("Unable to create mappings")}))}}]),e}()).\u0275fac=function(e){return new(e||qe)(p.Ub(r.e),p.Ub(h),p.Ub(f.e),p.Ub(c.a),p.Ub(v),p.Ub(b.a))},qe.\u0275cmp=p.Ob({type:qe,selectors:[["app-lead-create"]],decls:47,vars:36,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","externalId",3,"nzSm","nzXs"],["nzErrorTip","Lead Id is required",3,"nzSm","nzXs"],["nz-input","","formControlName","externalId","id","externalId",3,"nzAutocomplete"],["nzBackfill","",3,"nzDataSource","selectionChange"],["auto",""],["nzRequired","","nzFor","address",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid E-mail!",3,"nzSm","nzXs"],["nz-input","","formControlName","address","id","address"],["nzFor","firstName","nzRequired","",3,"nzSm","nzXs"],["nz-icon","","nz-tooltip","","nzTitle","What do you want other to call you","nzType","question-circle","nzTheme","outline"],["nzErrorTip","Please input your firstName!",3,"nzSm","nzXs"],["nz-input","","id","firstName","formControlName","firstName"],["nzFor","phoneNumber","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input",""],["nzFor","amount","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Lead Amount cannot be empty!",3,"nzSm","nzXs"],["nz-input","","type","number","formControlName","amount","id","amount"],["nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],[3,"nzColor"],["nzBlockNode","","nzShowLine","",3,"nzData","nzClick"],["nzErrorTip","Please enter a followUp date",3,"nzSm","nzXs"],["formControlName","followUp"],["nz-button","","nzType","primary"],["formControlName","phoneNumberPrefix",1,"phone-select"],["nzLabel","+91","nzValue","+91"],["nzLabel","+86","nzValue","+86"],["nzLabel","+87","nzValue","+87"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-label",1),p.Nc(3,"Lead Id"),p.Zb(),p.ac(4,"nz-form-control",2),p.Vb(5,"input",3),p.ac(6,"nz-autocomplete",4,5),p.ic("selectionChange",(function(e){return t.fetchSelectedLead(e)})),p.Zb(),p.Zb(),p.Zb(),p.ac(8,"nz-form-item"),p.ac(9,"nz-form-label",6),p.Nc(10,"Address"),p.Zb(),p.ac(11,"nz-form-control",7),p.Vb(12,"input",8),p.Zb(),p.Zb(),p.ac(13,"nz-form-item"),p.ac(14,"nz-form-label",9),p.ac(15,"span"),p.Nc(16," firstName "),p.Vb(17,"i",10),p.Zb(),p.Zb(),p.ac(18,"nz-form-control",11),p.Vb(19,"input",12),p.Zb(),p.Zb(),p.ac(20,"nz-form-item"),p.ac(21,"nz-form-label",13),p.Nc(22,"Phone Number"),p.Zb(),p.ac(23,"nz-form-control",14),p.ac(24,"nz-input-group",15),p.Lc(25,Xe,4,0,"ng-template",null,16,p.Mc),p.Vb(27,"input",17),p.Zb(),p.Zb(),p.Zb(),p.ac(28,"nz-form-item"),p.ac(29,"nz-form-label",18),p.Nc(30,"Lead Amount"),p.Zb(),p.ac(31,"nz-form-control",19),p.Vb(32,"input",20),p.Zb(),p.Zb(),p.ac(33,"nz-form-item"),p.ac(34,"nz-form-label",21),p.Nc(35," Lead Status "),p.Zb(),p.ac(36,"nz-form-control",22),p.ac(37,"nz-tag",23),p.Nc(38),p.Zb(),p.ac(39,"nz-tree",24),p.ic("nzClick",(function(e){return t.nzEvent(e)})),p.Zb(),p.Zb(),p.Zb(),p.ac(40,"nz-form-item"),p.ac(41,"nz-form-label",21),p.Nc(42,"Follow Up"),p.Zb(),p.ac(43,"nz-form-control",25),p.Vb(44,"nz-date-picker",26),p.Zb(),p.Zb(),p.ac(45,"button",27),p.Nc(46,"Submit"),p.Zb(),p.Zb()),2&e){var n=p.Dc(7),i=p.Dc(26);p.tc("formGroup",t.validateForm),p.Eb(2),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(1),p.tc("nzAutocomplete",n),p.Eb(1),p.tc("nzDataSource",t.leadOptions),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(4),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.phoneNumber),p.Eb(1),p.tc("nzAddOnBefore",i),p.Eb(5),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(1),p.tc("nzColor","cyan"),p.Eb(1),p.Oc(t.validateForm.get("leadStatus").value),p.Eb(1),p.tc("nzData",t.demoDispositionNodes),p.Eb(2),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,w.a,y.b,r.c,L.d,r.n,r.h,L.a,O.a,S.b,Le.d,y.c,r.r,je.a,Ue.a,N.b,k.a,E.a,P.e,P.a],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}"]}),qe);function Ge(e,t){1&e&&(p.ac(0,"nz-select",34),p.Vb(1,"nz-option",35),p.Vb(2,"nz-option",36),p.Vb(3,"nz-option",37),p.Zb())}var $e,He,We=((He=function(){function e(t,n,i,a){_classCallCheck(this,e),this.fb=t,this.ticketService=n,this.msg=i,this.activatedRouter=a,this.options=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.initForm(),this.subscribeToQueryParamChange(),this.subscribeToLeadIdChange()}},{key:"subscribeToQueryParamChange",value:function(){var e=this,t=this.activatedRouter.snapshot.queryParams.id;t&&(this.ticketId=t,this.ticketService.getTicketById(t).subscribe((function(t){e.patchTicketToLead(t)}),(function(n){e.msg.error("Failed to fetch data for ticket id ",t)})))}},{key:"patchTicketToLead",value:function(e){console.log("patch called"),this.validateForm.patchValue(e)}},{key:"initForm",value:function(){this.validateForm=this.fb.group({leadId:[null,[r.t.required]],email:[null,[r.t.email,r.t.required]],assignedTo:[null,[r.t.required,r.t.email]],nickname:[null,[r.t.required]],phoneNumberPrefix:["+91"],phoneNumber:[null,[r.t.required]],review:["positive",[r.t.required]],followUp:[null,[r.t.required]],agree:[!1],status:["NEW",[r.t.required]]})}},{key:"subscribeToLeadIdChange",value:function(){var e=this;this.validateForm.get("leadId").valueChanges.pipe(Object(s.a)(300),Object(u.a)()).subscribe((function(t){console.log(t),e.ticketService.suggestLead(t).subscribe((function(t){e.options=t.map((function(e){return e._id}))}))}))}},{key:"fetchSelectedLead",value:function(e){var t=this;this.ticketService.getTicketByLeadId(e.nzValue).subscribe((function(e){t.validateForm.patchValue({email:e.email,nickname:e.nickname,phoneNumberPrefix:e.phoneNumberPrefix,phoneNumber:e.phoneNumber})}))}},{key:"submitForm",value:function(){for(var e in this.validateForm.controls)this.validateForm.controls[e].markAsDirty(),this.validateForm.controls[e].updateValueAndValidity();this.ticketId?this.updateTicket():this.createTicket()}},{key:"createTicket",value:function(){var e=this;this.ticketService.addTicket(this.validateForm.value).subscribe((function(t){e.msg.success("Successfully added ticket")}),(function(t){e.msg.error("Something went wrong while adding ticket")}))}},{key:"updateTicket",value:function(){var e=this;this.ticketService.updateTicket(this.validateForm.value,this.ticketId).subscribe((function(t){e.msg.success("Successfully updated ticket with id "+e.ticketId)}),(function(t){e.msg.error("Failed to update ticket with id "+e.ticketId)}))}},{key:"updateConfirmValidator",value:function(){var e=this;Promise.resolve().then((function(){return e.validateForm.controls.checkPassword.updateValueAndValidity()}))}},{key:"getCaptcha",value:function(e){e.preventDefault()}}]),e}()).\u0275fac=function(e){return new(e||He)(p.Ub(r.e),p.Ub(de),p.Ub(f.e),p.Ub(c.a))},He.\u0275cmp=p.Ob({type:He,selectors:[["app-ticket-create"]],decls:57,vars:37,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","leadId",3,"nzSm","nzXs"],["nzErrorTip","Lead Id is required",3,"nzSm","nzXs"],["nz-input","","formControlName","leadId","id","leadId",3,"nzAutocomplete"],["nzBackfill","",3,"nzDataSource","selectionChange"],["auto",""],["nzRequired","","nzFor","email",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid E-mail!",3,"nzSm","nzXs"],["nz-input","","formControlName","email","id","email"],["nzRequired","","nzFor","assignedTo",3,"nzSm","nzXs"],["nzErrorTip","Email id is not valid!",3,"nzSm","nzXs"],["nz-input","","formControlName","assignedTo","id","assignedTo"],["nzFor","nickname","nzRequired","",3,"nzSm","nzXs"],["nz-icon","","nz-tooltip","","nzTitle","What do you want other to call you","nzType","question-circle","nzTheme","outline"],["nzErrorTip","Please input your nickname!",3,"nzSm","nzXs"],["nz-input","","id","nickname","formControlName","nickname"],["nzFor","phoneNumber","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input",""],["nzFor","review","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please leave a review!",3,"nzSm","nzXs"],["formControlName","review",1,""],["nzLabel","Uncertain","nzValue","uncertain"],["nzLabel","Positive","nzValue","positive"],["nzLabel","Negative","nzValue","negative"],["nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please enter a followUp date",3,"nzSm","nzXs"],["formControlName","followUp"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-checkbox","","formControlName","agree"],["nz-button","","nzType","primary"],["formControlName","phoneNumberPrefix",1,"phone-select"],["nzLabel","+91","nzValue","+91"],["nzLabel","+86","nzValue","+86"],["nzLabel","+87","nzValue","+87"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-label",1),p.Nc(3,"Lead Id"),p.Zb(),p.ac(4,"nz-form-control",2),p.Vb(5,"input",3),p.ac(6,"nz-autocomplete",4,5),p.ic("selectionChange",(function(e){return t.fetchSelectedLead(e)})),p.Zb(),p.Zb(),p.Zb(),p.ac(8,"nz-form-item"),p.ac(9,"nz-form-label",6),p.Nc(10,"E-mail"),p.Zb(),p.ac(11,"nz-form-control",7),p.Vb(12,"input",8),p.Zb(),p.Zb(),p.ac(13,"nz-form-item"),p.ac(14,"nz-form-label",9),p.Nc(15,"Handler Email"),p.Zb(),p.ac(16,"nz-form-control",10),p.Vb(17,"input",11),p.Zb(),p.Zb(),p.ac(18,"nz-form-item"),p.ac(19,"nz-form-label",12),p.ac(20,"span"),p.Nc(21," Nickname "),p.Vb(22,"i",13),p.Zb(),p.Zb(),p.ac(23,"nz-form-control",14),p.Vb(24,"input",15),p.Zb(),p.Zb(),p.ac(25,"nz-form-item"),p.ac(26,"nz-form-label",16),p.Nc(27,"Phone Number"),p.Zb(),p.ac(28,"nz-form-control",17),p.ac(29,"nz-input-group",18),p.Lc(30,Ge,4,0,"ng-template",null,19,p.Mc),p.Vb(32,"input",20),p.Zb(),p.Zb(),p.Zb(),p.ac(33,"nz-form-item"),p.ac(34,"nz-form-label",21),p.Nc(35,"Review"),p.Zb(),p.ac(36,"nz-form-control",22),p.ac(37,"nz-select",23),p.Vb(38,"nz-option",24),p.Vb(39,"nz-option",25),p.Vb(40,"nz-option",26),p.Zb(),p.Zb(),p.Zb(),p.ac(41,"nz-form-item"),p.ac(42,"nz-form-label",27),p.Nc(43,"Follow Up"),p.Zb(),p.ac(44,"nz-form-control",28),p.Vb(45,"nz-date-picker",29),p.Zb(),p.Zb(),p.ac(46,"nz-form-item",30),p.ac(47,"nz-form-control",31),p.ac(48,"label",32),p.ac(49,"span"),p.Nc(50,"I have read the "),p.ac(51,"a"),p.Nc(52,"agreement"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(53,"nz-form-item",30),p.ac(54,"nz-form-control",31),p.ac(55,"button",33),p.Nc(56,"Register"),p.Zb(),p.Zb(),p.Zb(),p.Zb()),2&e){var n=p.Dc(7),i=p.Dc(31);p.tc("formGroup",t.validateForm),p.Eb(2),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(1),p.tc("nzAutocomplete",n),p.Eb(1),p.tc("nzDataSource",t.options),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(4),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.phoneNumber),p.Eb(1),p.tc("nzAddOnBefore",i),p.Eb(5),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(6),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSpan",14)("nzOffset",6),p.Eb(7),p.tc("nzSpan",14)("nzOffset",6)}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,w.a,y.b,r.c,L.d,r.n,r.h,L.a,O.a,S.b,Le.d,y.c,P.e,P.a,N.b,x.a,k.a,E.a],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}"]}),He),Qe=(($e=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"get",value:function(e){return this.http.post(d.a.apiUrl+"/lead/alarms/getAll",{})}}]),e}()).\u0275fac=function(e){return new(e||$e)(p.ec(m.c))},$e.\u0275prov=p.Qb({token:$e,factory:$e.\u0275fac,providedIn:"root"}),$e);function Je(e,t){if(1&e&&p.Vb(0,"nz-option",18),2&e){var n=t.$implicit;p.tc("nzLabel",n)("nzValue",n)}}function Ke(e,t){if(1&e&&(p.ac(0,"tr"),p.ac(1,"td"),p.Nc(2),p.Zb(),p.ac(3,"td"),p.Nc(4),p.Zb(),p.ac(5,"td"),p.Nc(6),p.Zb(),p.ac(7,"td"),p.ac(8,"a",19),p.Nc(9,"Delete"),p.Zb(),p.Vb(10,"nz-divider",20),p.ac(11,"a",19),p.Nc(12,"Escalate"),p.Zb(),p.Zb(),p.Zb()),2&e){var n=t.$implicit;p.Eb(2),p.Oc(n.module),p.Eb(2),p.Oc(n.moduleId),p.Eb(2),p.Oc(n.userEmail)}}function Ye(e,t){1&e&&p.Nc(0),2&e&&p.Pc(" and ",t.$implicit.length," more selected ")}var et,tt=((et=function(){function e(t,n){_classCallCheck(this,e),this.alarmService=t,this.fb=n,this.listOfData=[],this.placement="left"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.visible=!1,this.listOfOption=["LEAD","TICKET","USER","CUSTOMER"],this.alarmService.get({}).subscribe((function(t){e.listOfData=t}),(function(e){console.log(e)})),this.filterForm=this.fb.group({handlerEmail:[null],dateRange:[null],moduleTypes:[]})}},{key:"open",value:function(){this.visible=!0}},{key:"close",value:function(){this.visible=!1}},{key:"submitForm",value:function(){for(var e in this.filterForm.controls)this.filterForm.controls[e].markAsDirty(),this.filterForm.controls[e].updateValueAndValidity();console.log(this.filterForm.value)}}]),e}()).\u0275fac=function(e){return new(e||et)(p.Ub(Qe),p.Ub(r.e))},et.\u0275cmp=p.Ob({type:et,selectors:[["app-alarms"]],decls:37,vars:14,consts:[["nz-button","","nzType","primary",3,"click"],["nzTitle","Select Advanced Filters","nzWidth","300px",3,"nzClosable","nzVisible","nzPlacement","nzOnClose"],["nz-form","","nzLayout","vertical",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","handlerEmail",3,"nzSpan"],[3,"nzSpan"],["type","text","nz-input","","formControlName","handlerEmail","placeholder","Please input your name"],["nzFor","dateRange",3,"nzSpan"],["formControlName","dateRange"],["nzFor","moduleTypes",3,"nzSpan"],["nzMode","multiple","nzPlaceHolder","Please select","formControlName","moduleTypes",3,"nzMaxTagCount","nzMaxTagPlaceholder"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-button","","nzType","primary"],["nzBordered","","nzTableLayout","fixed",3,"nzData"],["editRowTable",""],["nzWidth","25%"],["nzWidth","30%"],[4,"ngFor","ngForOf"],["tagPlaceHolder",""],[3,"nzLabel","nzValue"],[1,"save"],["nzType","vertical"]],template:function(e,t){if(1&e&&(p.ac(0,"button",0),p.ic("click",(function(){return t.open()})),p.Nc(1,"Advanced Filters"),p.Zb(),p.ac(2,"nz-drawer",1),p.ic("nzOnClose",(function(){return t.close()})),p.ac(3,"form",2),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(4,"nz-form-item"),p.ac(5,"nz-form-label",3),p.Nc(6,"Handler Email"),p.Zb(),p.ac(7,"nz-form-control",4),p.Vb(8,"input",5),p.Zb(),p.Zb(),p.ac(9,"nz-form-item"),p.ac(10,"nz-form-label",6),p.Nc(11,"Date Range"),p.Zb(),p.ac(12,"nz-form-control",4),p.Vb(13,"nz-range-picker",7),p.Zb(),p.Zb(),p.ac(14,"nz-form-item"),p.ac(15,"nz-form-label",8),p.Nc(16,"Module Types"),p.Zb(),p.ac(17,"nz-select",9),p.Lc(18,Je,1,2,"nz-option",10),p.Zb(),p.Zb(),p.ac(19,"button",11),p.Nc(20,"Submit"),p.Zb(),p.Zb(),p.Zb(),p.ac(21,"nz-table",12,13),p.ac(23,"thead"),p.ac(24,"tr"),p.ac(25,"th",14),p.Nc(26,"Module"),p.Zb(),p.ac(27,"th",15),p.Nc(28,"Module Id"),p.Zb(),p.ac(29,"th",14),p.Nc(30,"Handler Email"),p.Zb(),p.ac(31,"th"),p.Nc(32,"Action"),p.Zb(),p.Zb(),p.Zb(),p.ac(33,"tbody"),p.Lc(34,Ke,13,3,"tr",16),p.Zb(),p.Zb(),p.Lc(35,Ye,1,1,"ng-template",null,17,p.Mc)),2&e){var n=p.Dc(22),i=p.Dc(36);p.Eb(2),p.tc("nzClosable",!1)("nzVisible",t.visible)("nzPlacement",t.placement),p.Eb(1),p.tc("formGroup",t.filterForm),p.Eb(2),p.tc("nzSpan",24),p.Eb(2),p.tc("nzSpan",24),p.Eb(3),p.tc("nzSpan",24),p.Eb(2),p.tc("nzSpan",24),p.Eb(3),p.tc("nzSpan",24),p.Eb(2),p.tc("nzMaxTagCount",3)("nzMaxTagPlaceholder",i),p.Eb(1),p.tc("ngForOf",t.listOfOption),p.Eb(3),p.tc("nzData",t.listOfData),p.Eb(13),p.tc("ngForOf",n.data)}},directives:[k.a,E.a,O.a,F.a,r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,w.a,y.b,r.c,r.n,r.h,N.b,N.d,P.e,o.l,A.b,A.i,A.j,A.a,A.g,A.d,P.a,C.a],styles:[".save[_ngcontent-%COMP%]{margin-right:8px}nz-select[_ngcontent-%COMP%]{width:100%}.ant-drawer-content-wrapper[_ngcontent-%COMP%]{width:260px}"]}),et);function nt(e,t){1&e&&(p.Yb(0),p.Nc(1," Please confirm your password! "),p.Xb())}function it(e,t){1&e&&(p.Yb(0),p.Nc(1," Two passwords that you enter is inconsistent! "),p.Xb())}function at(e,t){if(1&e&&(p.Lc(0,nt,2,0,"ng-container",33),p.Lc(1,it,2,0,"ng-container",33)),2&e){var n=t.$implicit;p.tc("ngIf",n.hasError("required")),p.Eb(1),p.tc("ngIf",n.hasError("confirm"))}}function ot(e,t){1&e&&(p.ac(0,"nz-select",34),p.Vb(1,"nz-option",35),p.Vb(2,"nz-option",36),p.Zb())}var rt,ct=((rt=function(){function e(t){var n=this;_classCallCheck(this,e),this.fb=t,this.confirmationValidator=function(e){return e.value?e.value!==n.validateForm.controls.password.value?{confirm:!0,error:!0}:{}:{required:!0}}}return _createClass(e,[{key:"submitForm",value:function(){for(var e in this.validateForm.controls)this.validateForm.controls[e].markAsDirty(),this.validateForm.controls[e].updateValueAndValidity()}},{key:"updateConfirmValidator",value:function(){var e=this;Promise.resolve().then((function(){return e.validateForm.controls.checkPassword.updateValueAndValidity()}))}},{key:"getCaptcha",value:function(e){e.preventDefault()}},{key:"ngOnInit",value:function(){this.validateForm=this.fb.group({email:[null,[r.t.email,r.t.required]],password:[null,[r.t.required]],checkPassword:[null,[r.t.required,this.confirmationValidator]],nickname:[null,[r.t.required]],phoneNumberPrefix:["+86"],phoneNumber:[null,[r.t.required]],website:[null,[r.t.required]],captcha:[null,[r.t.required]],agree:[!1]})}}]),e}()).\u0275fac=function(e){return new(e||rt)(p.Ub(r.e))},rt.\u0275cmp=p.Ob({type:rt,selectors:[["app-customer-create"]],decls:59,vars:39,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","email",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid E-mail!",3,"nzSm","nzXs"],["nz-input","","formControlName","email","id","email"],["nzFor","password","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your password!",3,"nzSm","nzXs"],["nz-input","","type","password","id","password","formControlName","password",3,"ngModelChange"],["nzFor","checkPassword","nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzErrorTip"],["nz-input","","type","password","formControlName","checkPassword","id","checkPassword"],["errorTpl",""],["nzFor","nickname","nzRequired","",3,"nzSm","nzXs"],["nz-icon","","nz-tooltip","","nzTitle","What do you want other to call you","nzType","question-circle","nzTheme","outline"],["nzErrorTip","Please input your nickname!",3,"nzSm","nzXs"],["nz-input","","id","nickname","formControlName","nickname"],["nzFor","phoneNumber","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input",""],["nzFor","website","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input website!",3,"nzSm","nzXs"],["nz-input","","id","website","formControlName","website","placeholder","website"],["nzFor","captcha","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input the captcha you got!","nzExtra","We must make sure that your are a human.",3,"nzSm","nzXs"],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nz-input","","formControlName","captcha","id","captcha"],["nz-button","",3,"click"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-checkbox","","formControlName","agree"],["nz-button","","nzType","primary"],[4,"ngIf"],["formControlName","phoneNumberPrefix",1,"phone-select"],["nzLabel","+86","nzValue","+86"],["nzLabel","+87","nzValue","+87"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-label",1),p.Nc(3,"E-mail"),p.Zb(),p.ac(4,"nz-form-control",2),p.Vb(5,"input",3),p.Zb(),p.Zb(),p.ac(6,"nz-form-item"),p.ac(7,"nz-form-label",4),p.Nc(8,"Password"),p.Zb(),p.ac(9,"nz-form-control",5),p.ac(10,"input",6),p.ic("ngModelChange",(function(){return t.updateConfirmValidator()})),p.Zb(),p.Zb(),p.Zb(),p.ac(11,"nz-form-item"),p.ac(12,"nz-form-label",7),p.Nc(13,"Confirm Password"),p.Zb(),p.ac(14,"nz-form-control",8),p.Vb(15,"input",9),p.Lc(16,at,2,2,"ng-template",null,10,p.Mc),p.Zb(),p.Zb(),p.ac(18,"nz-form-item"),p.ac(19,"nz-form-label",11),p.ac(20,"span"),p.Nc(21," Nickname "),p.Vb(22,"i",12),p.Zb(),p.Zb(),p.ac(23,"nz-form-control",13),p.Vb(24,"input",14),p.Zb(),p.Zb(),p.ac(25,"nz-form-item"),p.ac(26,"nz-form-label",15),p.Nc(27,"Phone Number"),p.Zb(),p.ac(28,"nz-form-control",16),p.ac(29,"nz-input-group",17),p.Lc(30,ot,3,0,"ng-template",null,18,p.Mc),p.Vb(32,"input",19),p.Zb(),p.Zb(),p.Zb(),p.ac(33,"nz-form-item"),p.ac(34,"nz-form-label",20),p.Nc(35,"Website"),p.Zb(),p.ac(36,"nz-form-control",21),p.Vb(37,"input",22),p.Zb(),p.Zb(),p.ac(38,"nz-form-item"),p.ac(39,"nz-form-label",23),p.Nc(40,"Captcha"),p.Zb(),p.ac(41,"nz-form-control",24),p.ac(42,"div",25),p.ac(43,"div",26),p.Vb(44,"input",27),p.Zb(),p.ac(45,"div",26),p.ac(46,"button",28),p.ic("click",(function(e){return t.getCaptcha(e)})),p.Nc(47,"Get captcha"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(48,"nz-form-item",29),p.ac(49,"nz-form-control",30),p.ac(50,"label",31),p.ac(51,"span"),p.Nc(52,"I have read the "),p.ac(53,"a"),p.Nc(54,"agreement"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(55,"nz-form-item",29),p.ac(56,"nz-form-control",30),p.ac(57,"button",32),p.Nc(58,"Register"),p.Zb(),p.Zb(),p.Zb(),p.Zb()),2&e){var n=p.Dc(17),i=p.Dc(31);p.tc("formGroup",t.validateForm),p.Eb(2),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)("nzErrorTip",n),p.Eb(5),p.tc("nzSm",6)("nzXs",24),p.Eb(4),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.phoneNumber),p.Eb(1),p.tc("nzAddOnBefore",i),p.Eb(5),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(3),p.tc("nzSm",6)("nzXs",24),p.Eb(2),p.tc("nzSm",14)("nzXs",24),p.Eb(1),p.tc("nzGutter",8),p.Eb(1),p.tc("nzSpan",12),p.Eb(2),p.tc("nzSpan",12),p.Eb(4),p.tc("nzSpan",14)("nzOffset",6),p.Eb(7),p.tc("nzSpan",14)("nzOffset",6)}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,w.a,y.b,r.c,r.n,r.h,O.a,S.b,Le.d,y.c,k.a,E.a,x.a,o.m,P.e,P.a],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}"]}),rt);function lt(e,t){if(1&e&&(p.ac(0,"th",4),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.tc("nzSortOrder",n.sortOrder)("nzSortFn",n.sortFn)("nzSortDirections",n.sortDirections)("nzFilterMultiple",n.filterMultiple)("nzFilters",n.listOfFilter)("nzFilterFn",n.filterFn),p.Eb(1),p.Pc(" ",n.name," ")}}function st(e,t){if(1&e&&(p.ac(0,"tr"),p.ac(1,"td"),p.Nc(2),p.Zb(),p.ac(3,"td"),p.Nc(4),p.Zb(),p.ac(5,"td"),p.Nc(6),p.Zb(),p.Zb()),2&e){var n=t.$implicit;p.Eb(2),p.Oc(n.name),p.Eb(2),p.Oc(n.age),p.Eb(2),p.Oc(n.address)}}var ut,pt,ft=((ut=function e(){_classCallCheck(this,e),this.listOfColumns=[{name:"Name",sortOrder:null,sortFn:function(e,t){return e.name.localeCompare(t.name)},filterMultiple:!0,listOfFilter:[{text:"Joe",value:"Joe"},{text:"Jim",value:"Jim",byDefault:!0}],filterFn:function(e,t){return e.some((function(e){return-1!==t.name.indexOf(e)}))}},{name:"Age",sortOrder:"descend",sortFn:function(e,t){return e.age-t.age},sortDirections:["descend",null]},{name:"Address",sortOrder:null,sortFn:function(e,t){return e.address.length-t.address.length},filterMultiple:!1,listOfFilter:[{text:"London",value:"London"},{text:"Sidney",value:"Sidney"}],filterFn:function(e,t){return-1!==t.address.indexOf(e)}}],this.listOfData=[{name:"John Brown",age:32,address:"New York No. 1 Lake Park"},{name:"Jim Green",age:42,address:"London No. 1 Lake Park"},{name:"Joe Black",age:32,address:"Sidney No. 1 Lake Park"},{name:"Jim Red",age:32,address:"London No. 2 Lake Park"}]}).\u0275fac=function(e){return new(e||ut)},ut.\u0275cmp=p.Ob({type:ut,selectors:[["app-customers"]],decls:7,vars:3,consts:[["nzTableLayout","fixed",3,"nzData"],["filterTable",""],[3,"nzSortOrder","nzSortFn","nzSortDirections","nzFilterMultiple","nzFilters","nzFilterFn",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"nzSortOrder","nzSortFn","nzSortDirections","nzFilterMultiple","nzFilters","nzFilterFn"]],template:function(e,t){if(1&e&&(p.ac(0,"nz-table",0,1),p.ac(2,"thead"),p.ac(3,"tr"),p.Lc(4,lt,2,7,"th",2),p.Zb(),p.Zb(),p.ac(5,"tbody"),p.Lc(6,st,7,3,"tr",3),p.Zb(),p.Zb()),2&e){var n=p.Dc(1);p.tc("nzData",t.listOfData),p.Eb(4),p.tc("ngForOf",t.listOfColumns),p.Eb(2),p.tc("ngForOf",n.data)}},directives:[A.b,A.i,A.j,o.l,A.d,A.a,A.g,A.f],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}"]}),ut),dt=n("DKVz"),mt=["myChart"],ht=((pt=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){this.initChartConfig(),this.initLabelOptions(),this.initChartOptions()}},{key:"initLabelOptions",value:function(){this.labelOption={show:!0,position:this.config.position,distance:this.config.distance,align:this.config.align,verticalAlign:this.config.verticalAlign,rotate:this.config.rotate,formatter:"{c}  {name|{a}}",fontSize:16,rich:{name:{textBorderColor:"#fff"}}}}},{key:"initChartConfig",value:function(){this.config={rotate:90,align:"left",verticalAlign:"middle",position:"top",distance:15,onChange:function(){var e={normal:{rotate:this.config.rotate,align:this.config.align,verticalAlign:this.config.verticalAlign,position:this.config.position,distance:this.config.distance}};this.myChart.setOption({series:[{label:e},{label:e},{label:e},{label:e}]})}}}},{key:"initChartOptions",value:function(){this.chartOption={color:["#e78c45","#300b05","#4cabce","#e5323e"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{left:"center",top:"bottom",data:["Converted","Dropped","Positive","Negative"]},toolbox:{show:!0,orient:"vertical",left:"left",top:"center",feature:{mark:{show:!0,title:"mark"},dataView:{show:!0,readOnly:!1,title:"data view"},magicType:{show:!0,type:["line","bar","stack","tiled"],title:"magic"},restore:{show:!0,title:"restore"},saveAsImage:{show:!0,title:"download"}}},xAxis:[{type:"category",axisTick:{show:!1},data:["Shanur","Kunal","Akshay","Amandeep"]}],yAxis:[{type:"value",splitLine:{show:!1},max:function(e){return e.max+100}}],series:[{name:"Converted",type:"bar",barGap:0,label:this.labelOption,data:[320,332,301,334,390]},{name:"Dropped",type:"bar",label:this.labelOption,data:[220,182,191,234,290]},{name:"Positive",type:"bar",label:this.labelOption,data:[150,232,201,154,190]},{name:"Negative",type:"bar",label:this.labelOption,data:[98,77,101,99,40]}]}}}]),e}()).\u0275fac=function(e){return new(e||pt)},pt.\u0275cmp=p.Ob({type:pt,selectors:[["app-overview"]],viewQuery:function(e,t){var n;1&e&&p.Sc(mt,!0),2&e&&p.Cc(n=p.jc())&&(t.myChart=n.first)},decls:3,vars:1,consts:[["nz-row",""],["nz-col","","nzSpan","24","echarts","",1,"demo-chart",3,"options"],["mychart",""]],template:function(e,t){1&e&&(p.ac(0,"div",0),p.Vb(1,"div",1,2),p.Zb()),2&e&&(p.Eb(1),p.tc("options",t.chartOption))},directives:[Z.c,Z.a,dt.a],styles:[".demo-chart[_ngcontent-%COMP%]{height:50vh;margin-top:40px;padding-top:20px}"]}),pt),bt=n("3/1E");function gt(e,t){if(1&e&&p.Vb(0,"nz-option",15),2&e){var n=t.$implicit;p.tc("nzLabel",n)("nzValue",n)}}function zt(e,t){if(1&e&&(p.ac(0,"th"),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.Eb(1),p.Pc(" ",n.name," ")}}function vt(e,t){if(1&e){var n=p.bc();p.ac(0,"tr",16),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc().gotoDetailedView(e)})),p.ac(1,"td"),p.Nc(2),p.Zb(),p.ac(3,"td"),p.Nc(4),p.Zb(),p.ac(5,"td"),p.Nc(6),p.mc(7,"date"),p.Zb(),p.ac(8,"td"),p.Nc(9),p.mc(10,"date"),p.Zb(),p.ac(11,"td",16),p.ic("click",(function(e){p.Ec(n);var i=t.$implicit;return p.lc().markActiveCampaign(e,i)})),p.ac(12,"nz-upload",17),p.ic("nzFileListChange",(function(e){return p.Ec(n),p.lc().leadFileList=e})),p.ac(13,"button",18),p.Vb(14,"i",19),p.Nc(15,"Select File"),p.Zb(),p.ac(16,"button",20),p.ic("click",(function(e){return p.Ec(n),p.lc().handleLeadFilesUpload(),e.stopPropagation()})),p.Nc(17,"go"),p.Zb(),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit,a=p.lc();p.Eb(2),p.Oc(i.campaignName),p.Eb(2),p.Oc(i.createdBy),p.Eb(2),p.Oc(p.nc(7,7,i.startDate)),p.Eb(3),p.Oc(p.nc(10,9,i.endDate)),p.Eb(3),p.tc("nzFileList",a.leadFileList)("nzBeforeUpload",a.beforeLeadFilesUpload)("nzMultiple",!0)}}var yt,Ct,kt=((yt=function(){function e(t,n,i,a){var o=this;_classCallCheck(this,e),this.campaignService=t,this.msg=n,this.fb=i,this.router=a,this.handlerEmailOpts=["santa","banta"],this.listOfColumns=[{name:"Campaign Name"},{name:"Created By"},{name:"Start Date"},{name:"End Date"}],this.listOfData=[],this.totalPage=0,this.uploading=!1,this.leadFileList=[],this.beforeLeadFilesUpload=function(e){return o.leadFileList=o.leadFileList.concat(e),!1}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.page=1,this.perPage=20,this.campaignOpts=["default"],this.validateForm=this.fb.group({handlerEmail:[null],campaigns:[]}),this.initFormControlListeners(),this.getCampaigns(),this.campaignService.getAllCampaignTypes().subscribe((function(t){e.campaignOpts=t}),(function(e){console.log(e)}))}},{key:"trackByName",value:function(e,t){return t.name}},{key:"onPageIndexChange",value:function(e){this.page=e,this.getCampaigns()}},{key:"onPageSizeChange",value:function(e){this.perPage=e,this.getCampaigns()}},{key:"initFormControlListeners",value:function(){var e=this;this.validateForm.get("handlerEmail").valueChanges.pipe(Object(s.a)(300),Object(u.a)()).subscribe((function(t){e.campaignService.getHandlerEmailHints(t).subscribe((function(t){e.handlerEmailOpts=t}))}))}},{key:"getCampaigns",value:function(){var e=this;this.msg.info("fetched campaigns"),this.campaignService.getCampaigns(this.page,this.perPage,this.filters,null,null).subscribe((function(t){e.processData(t)}),(function(t){e.msg.error(t.message)}))}},{key:"processData",value:function(e){this.page=e.metadata.page,this.totalPage=e.metadata.total,this.listOfData=[];var t,n=_createForOfIteratorHelper(e.data);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.listOfData.push({startDate:i.interval[0],endDate:i.interval[1],createdBy:i.createdBy,campaignName:i.campaignName,_id:i._id})}}catch(a){n.e(a)}finally{n.f()}}},{key:"submitForm",value:function(){this.filters=this.validateForm.value,this.getCampaigns()}},{key:"markActiveCampaign",value:function(e,t){e.stopImmediatePropagation(),this.activeCampaign=t}},{key:"gotoDetailedView",value:function(e){this.router.navigate(["welcome","campaigns","create"],{queryParams:{id:e._id}})}},{key:"handleLeadFilesUpload",value:function(){var e=this,t=new FormData;this.leadFileList.forEach((function(e){t.append("files[]",e)})),t.append("campaignName",this.activeCampaign.campaignName),this.uploading=!0,this.campaignService.uploadMultipleLeadFiles(t).subscribe((function(t){e.uploading=!1,e.leadFileList=[],e.msg.success("Lead Files uploaded successfully.")}),(function(){e.uploading=!1,e.msg.error("Lead files could not be uploaded.")}))}}]),e}()).\u0275fac=function(e){return new(e||yt)(p.Ub(v),p.Ub(f.e),p.Ub(r.e),p.Ub(c.d))},yt.\u0275cmp=p.Ob({type:yt,selectors:[["app-campaign"]],decls:27,vars:15,consts:[[1,"table-operations"],["nz-form","",3,"nzLayout","formGroup","ngSubmit"],["nzPrefixIcon","user"],["nz-input","","formControlName","handlerEmail",3,"nzAutocomplete"],[3,"nzDataSource"],["auto",""],["nzMode","multiple","nzPlaceHolder","Select campaigns","formControlName","campaigns",2,"width","200px"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-button","","nzType","primary",3,"disabled"],["nzTableLayout","fixed",3,"nzData","nzPageSize","nzShowPagination"],["filterTable",""],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"click",4,"ngFor","ngForOf"],[1,"pagination-block"],["nzShowSizeChanger","",3,"nzPageIndex","nzTotal","nzPageSize","nzPageSizeChange","nzPageIndexChange"],[3,"nzLabel","nzValue"],[3,"click"],["nzName","files",3,"nzFileList","nzBeforeUpload","nzMultiple","nzFileListChange"],["nz-button",""],["nz-icon","","nzType","upload"],["nz-button","","nz-primary","",3,"click"]],template:function(e,t){if(1&e&&(p.ac(0,"div",0),p.ac(1,"form",1),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(2,"nz-form-item"),p.ac(3,"nz-form-control"),p.ac(4,"nz-input-group",2),p.Vb(5,"input",3),p.Vb(6,"nz-autocomplete",4,5),p.Zb(),p.Zb(),p.Zb(),p.ac(8,"nz-form-item"),p.ac(9,"nz-form-control"),p.ac(10,"nz-select",6),p.Lc(11,gt,1,2,"nz-option",7),p.Zb(),p.Zb(),p.Zb(),p.ac(12,"nz-form-item"),p.ac(13,"nz-form-control"),p.ac(14,"button",8),p.Nc(15,"Search"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(16,"nz-table",9,10),p.ac(18,"thead"),p.ac(19,"tr"),p.Lc(20,zt,2,1,"th",11),p.ac(21,"th"),p.Nc(22," Actions "),p.Zb(),p.Zb(),p.Zb(),p.ac(23,"tbody"),p.Lc(24,vt,18,11,"tr",12),p.Zb(),p.Zb(),p.ac(25,"div",13),p.ac(26,"nz-pagination",14),p.ic("nzPageSizeChange",(function(e){return t.onPageSizeChange(e)}))("nzPageIndexChange",(function(e){return t.onPageIndexChange(e)})),p.Zb(),p.Zb()),2&e){var n=p.Dc(7),i=p.Dc(17);p.Eb(1),p.tc("nzLayout","inline")("formGroup",t.validateForm),p.Eb(4),p.tc("nzAutocomplete",n),p.Eb(1),p.tc("nzDataSource",t.handlerEmailOpts),p.Eb(5),p.tc("ngForOf",t.campaignOpts),p.Eb(3),p.tc("disabled",!t.validateForm.valid),p.Eb(2),p.tc("nzData",t.listOfData)("nzPageSize",t.perPage)("nzShowPagination",!1),p.Eb(4),p.tc("ngForOf",t.listOfColumns)("ngForTrackBy",t.trackByName),p.Eb(4),p.tc("ngForOf",i.data),p.Eb(2),p.tc("nzPageIndex",t.page)("nzTotal",t.totalPage)("nzPageSize",t.perPage)}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.a,y.c,y.b,r.c,L.d,r.n,r.h,L.a,P.e,o.l,k.a,E.a,O.a,A.b,A.i,A.j,A.a,A.g,A.d,bt.a,P.a,ye.a,S.b],pipes:[o.e],styles:[".table-operations[_ngcontent-%COMP%]{margin-bottom:16px}.table-operations[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{margin-right:8px}.pagination-block[_ngcontent-%COMP%]{margin:2%}"]}),yt),Et=n("Iab2"),Ot=n("jhN1"),St=((Ct=function(){function e(t,n){_classCallCheck(this,e),this.http=t,this.sanitizer=n}return _createClass(e,[{key:"listAgentActions",value:function(e,t){var n="".concat(d.a.apiUrl,"/agent/listActions?skip=").concat(e);return t&&(n+="&fileType="+t),this.http.get(n)}},{key:"downloadExcelFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";this.http.get("".concat(d.a.apiUrl,"/agent/download?location=").concat(e),{responseType:"arraybuffer"}).subscribe((function(e){var n=new Blob([e],{type:"application/octet-stream"});Object(Et.saveAs)(n,t+".xlsx")}))}}]),e}()).\u0275fac=function(e){return new(e||Ct)(p.ec(m.c),p.ec(Ot.b))},Ct.\u0275prov=p.Qb({token:Ct,factory:Ct.\u0275fac,providedIn:"root"}),Ct),Ft=n("Wfee"),wt=n("bE2y"),Zt=n("SKKP");function Pt(e,t){if(1&e&&(p.ac(0,"nz-auto-option",47),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.tc("nzValue",null==n?null:n.campaignName),p.Eb(1),p.Oc(null==n?null:n.campaignName)}}function Nt(e,t){if(1&e){var n=p.bc();p.ac(0,"form",31),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-label",2),p.Nc(3,"Campaign Name"),p.Zb(),p.ac(4,"nz-form-control",32),p.Vb(5,"input",33),p.ac(6,"nz-autocomplete",null,34),p.Lc(8,Pt,2,2,"nz-auto-option",35),p.Zb(),p.Zb(),p.Zb(),p.ac(9,"nz-form-item"),p.ac(10,"nz-form-label",2),p.Nc(11,"Interval"),p.Zb(),p.ac(12,"nz-form-control",36),p.Vb(13,"nz-range-picker",37),p.Zb(),p.Zb(),p.ac(14,"nz-form-item"),p.ac(15,"nz-form-label",2),p.Nc(16,"Comment"),p.Zb(),p.ac(17,"nz-form-control",3),p.Vb(18,"textarea",38),p.Zb(),p.Zb(),p.ac(19,"nz-form-item"),p.ac(20,"nz-form-control",39),p.ac(21,"nz-tree",40),p.ic("nzOnDrop",(function(e){return p.Ec(n),p.lc().nzEvent(e)}))("nzClick",(function(e){return p.Ec(n),p.lc().nzEvent(e)}))("nzContextMenu",(function(e){return p.Ec(n),p.lc().nodeActions(e)}))("contextmenu",(function(e){p.Ec(n);var t=p.lc(),i=p.Dc(16);return t.contextMenu(e,i)})),p.Zb(),p.Zb(),p.Zb(),p.ac(22,"nz-form-item"),p.ac(23,"nz-form-control",39),p.ac(24,"input",41,42),p.ic("change",(function(e){return p.Ec(n),p.lc().captureCampaignConfigFile(e)})),p.Zb(),p.ac(26,"button",43),p.ic("click",(function(){return p.Ec(n),p.Dc(25).click()})),p.Vb(27,"i",44),p.Nc(28," Upload File "),p.Vb(29,"nz-badge",45),p.Zb(),p.ac(30,"button",46),p.ic("click",(function(e){p.Ec(n);var t=p.lc();return t.submitForm(t.campaignForm.value),e.stopPropagation()})),p.Nc(31),p.Zb(),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=p.Dc(7),a=p.lc();p.tc("formGroup",a.campaignForm),p.Eb(2),p.tc("nzSpan",7),p.Eb(2),p.tc("nzSpan",12),p.Eb(1),p.tc("nzAutocomplete",i),p.Eb(3),p.tc("ngForOf",a.options),p.Eb(2),p.tc("nzSpan",7),p.Eb(2),p.tc("nzSpan",12),p.Eb(3),p.tc("nzSpan",7),p.Eb(2),p.tc("nzSpan",12),p.Eb(3),p.tc("nzOffset",7)("nzSpan",12),p.Eb(1),p.tc("nzData",a.demoDispositionNodes),p.Eb(2),p.tc("nzOffset",7)("nzSpan",12),p.Eb(6),p.tc("nzCount",null==a.campaignFiles?null:a.campaignFiles.length),p.Eb(1),p.tc("disabled",!a.campaignForm.valid),p.Eb(1),p.Oc(a.submitText)}}function xt(e,t){if(1&e&&(p.ac(0,"nz-auto-option",48),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.tc("nzValue",n.campaignName)("nzLabel",n.campaignName),p.Eb(1),p.Pc(" ",n.campaignName," ")}}function Tt(e,t){if(1&e){var n=p.bc();p.ac(0,"div"),p.ac(1,"button",49),p.Nc(2,"Submit without attachments"),p.Zb(),p.ac(3,"button",50),p.ic("click",(function(){return p.Ec(n),p.lc().handleUpload()})),p.Nc(4),p.Zb(),p.Zb()}if(2&e){var i=p.lc();p.Eb(1),p.tc("nzType","danger"),p.Eb(2),p.tc("nzType","primary")("nzLoading",i.uploading)("disabled",0==i.fileList.length),p.Eb(1),p.Pc(" ",i.uploading?"Uploading":"Use Attachments"," ")}}function _t(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"a",7),p.ic("click",(function(){p.Ec(n);var e=t.$implicit;return p.lc().handleClick(e)})),p.Nc(2),p.mc(3,"date"),p.Zb(),p.Xb()}if(2&e){var i=t.$implicit;p.Eb(2),p.Qc("",i.email," at ",p.nc(3,2,i.createdAt),"")}}var Lt,Vt,At=function(){return{standalone:!0}},Mt=function(){return{minRows:3,maxRows:5}},Dt=((Vt=function(){function e(t,n,i,a,o,r){var c=this;_classCallCheck(this,e),this.fb=t,this.agentService=n,this.campaignService=i,this.msg=a,this.nzContextMenuService=o,this.activatedRouter=r,this.isDispositionVisible=!1,this.options=[],this.recentUploads=[],this.tabSelected="Lead Generation",this.configFiles=[],this.visible=!1,this.isEmailTplVisible=!1,this.uploading=!1,this.fileList=[],this.demoDispositionNodes=[],this.campaignOptions=[],this.submitText="+ Create",this.beforeUpload=function(e){return c.fileList=c.fileList.concat(e),!1},this.campaignFiles=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.initCampaignForm(),this.subscribeToQueryParamChange(),this.initEmailForm(),this.initDispositionCore("core"),this.agentService.listAgentActions(0,"campaignSchema").subscribe((function(t){e.recentUploads=t}),(function(e){console.log(e)})),this.campaignForm.get("type").valueChanges.subscribe((function(e){return console.log(e)})),this.suggestCampaignNames()}},{key:"subscribeToQueryParamChange",value:function(){var e=this,t=this.activatedRouter.snapshot.queryParams.id;t&&(this.submitText="Update",this.campaignId=t,this.campaignService.getCampaignById(t).subscribe((function(t){e.patchCompainValues(t)}),(function(n){e.msg.error("Failed to fetch data for ticket id ",t)})))}},{key:"patchCompainValues",value:function(e){console.log(this.campaignForm.value),console.log("received from server",e),this.campaignForm.patchValue(e)}},{key:"initDispositionCore",value:function(e){var t=this;this.campaignService.getDisposition(e).subscribe((function(e){t.demoDispositionNodes=e.options}),(function(e){console.log("Error while calling initDispositionCore",e.message)}))}},{key:"suggestCampaignNames",value:function(e){var t=this;this.campaignService.getAllCampaignTypes(e).subscribe((function(e){t.options=e}),(function(e){console.log(e)}))}},{key:"initCampaignForm",value:function(){var e=this;this.campaignForm=this.fb.group({campaignName:["",[r.t.required]],comment:[""],type:["Lead Generation"],interval:[[],[r.t.required]]}),this.campaignForm.get("campaignName").valueChanges.pipe(Object(s.a)(500),Object(u.a)()).subscribe((function(t){e.hint=t,e.suggestCampaignNames(t)}))}},{key:"submitForm",value:function(e){for(var t in this.campaignForm.controls)this.campaignForm.controls[t].markAsDirty(),this.campaignForm.controls[t].updateValueAndValidity();console.log(e),this.campaignForm.valid&&this.handleCampaignConfigFileUpload()}},{key:"submitEmailForm",value:function(){var e=this;this.campaignService.handleEmailTemplateUpload(Object.assign(Object.assign({},this.emailForm.value),{attachments:this.attachments})).subscribe((function(t){e.msg.success(t)}),(function(t){e.msg.error(t.message)}))}},{key:"nodeActions",value:function(e){this.activeContext=e,console.log("activeContext",e)}},{key:"addLeafNode",value:function(){this.activeContext.node.addChildren([{title:"New Leaf",key:this.campaignService.getUniqueKey(),isLeaf:!0}])}},{key:"addParentNode",value:function(){this.activeContext.node.addChildren([{title:"New Parent",key:this.campaignService.getUniqueKey(),isLeaf:!1}])}},{key:"deleteNode",value:function(){this.activeContext.node.remove()}},{key:"open",value:function(){this.visible=!0}},{key:"close",value:function(){this.visible=!1}},{key:"handleClick",value:function(e){this.agentService.downloadExcelFile(e.filePath)}},{key:"initEmailForm",value:function(){this.emailForm=this.fb.group({campaign:[null],subject:[null],content:[null]}),this.fillCampaignOpts()}},{key:"showEmailTplModal",value:function(){this.isEmailTplVisible=!0}},{key:"handleEmailTplCancel",value:function(){this.isEmailTplVisible=!1}},{key:"handleEmailTplOk",value:function(){}},{key:"captureCampaignConfigFile",value:function(e){this.campaignFiles=e.target.files,console.log(this.campaignFiles)}},{key:"handleCampaignConfigFileUpload",value:function(){var e=this,t=new FormData;this.uploading=!0,console.log(this.campaignFiles),t.append("campaignFile",this.campaignFiles[0]),t.append("campaignInfo",JSON.stringify(this.campaignForm.value)),t.append("dispositionData",JSON.stringify(this.demoDispositionNodes)),this.campaignService.createCampaignAndDisposition(t).subscribe((function(t){e.uploading=!1,e.msg.success("Lead Files uploaded successfully.")}),(function(){e.uploading=!1,e.msg.error("Lead files could not be uploaded.")}))}},{key:"handleUpload",value:function(){var e=this,t=new FormData;this.fileList.forEach((function(e){t.append("files[]",e)})),this.uploading=!0,this.campaignService.handleFilesUpload(t).subscribe((function(t){e.uploading=!1,e.fileList=[],e.msg.success("Attachments uploaded successfully."),e.attachments=t.body,e.submitEmailForm()}),(function(){e.uploading=!1,e.msg.error("upload failed.")}))}},{key:"showDispositionTplModal",value:function(){this.isDispositionVisible=!0}},{key:"handleDispositionCancel",value:function(){this.isDispositionVisible=!1}},{key:"handleDispositionOk",value:function(){}},{key:"nzEvent",value:function(e){console.log(e),e.node.isExpanded=!e.node.isExpanded}},{key:"contextMenu",value:function(e,t){this.nzContextMenuService.create(e,t),console.log(e)}},{key:"fillCampaignOpts",value:function(){var e=this;this.emailForm.get("campaign").valueChanges.pipe(Object(s.a)(300),Object(u.a)()).subscribe((function(t){e.campaignService.getAllCampaignTypes(t).subscribe((function(t){e.campaignOptions=t,console.log(e.campaignOptions)}))}))}},{key:"handleFormTypeChange",value:function(e){console.log(e,this.tabSelected)}},{key:"rename",value:function(){this.renameText&&(this.activeContext.node.title=this.renameText,this.renameText="")}}]),e}()).\u0275fac=function(e){return new(e||Vt)(p.Ub(r.e),p.Ub(St),p.Ub(v),p.Ub(f.e),p.Ub(b.a),p.Ub(c.a))},Vt.\u0275cmp=p.Ob({type:Vt,selectors:[["app-create-campaign"]],decls:56,vars:30,consts:[["nz-form",""],["nzType","warning","nzMessage","Warning","nzDescription","Please upload documents wisely, don't proceed without proper understanding of this space"],["nzRequired","",3,"nzSpan"],["nzErrorTip","Please write something here!",3,"nzSpan"],["nzButtonStyle","solid",3,"ngModel","ngModelOptions","ngModelChange"],["nz-radio-button","","nzValue","Lead Generation"],["nz-radio-button","","nzValue","Custom Workflow"],["nz-button","","nzType","link",3,"click"],["nz-icon","","nzType","setting","nzTheme","outline"],["nz-form","",3,"formGroup",4,"ngIf"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-input","","placeholder","rename node","nzSize","default",3,"ngModel","keyup.enter","ngModelChange"],["nzWidth","300px","nzPlacement","right","nzTitle","Advanced Options",3,"nzClosable","nzVisible","nzOnClose"],["nz-button","",3,"nzType","click"],["nzWidth","700","nzTitle","Add Email Template Here",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-form","","nzLayout","vertical",3,"formGroup"],["nzRequired","",3,"nzSm","nzXs"],["placeholder","Select Campaign","nz-input","","formControlName","campaign",3,"nzAutocomplete"],["autob",""],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzSm","nzXs"],["nz-input","","placeholder","Write the subject of email","formControlName","subject"],["nz-input","","placeholder","Controlled autosize","formControlName","content",3,"nzAutosize"],["nzName","files",3,"nzFileList","nzBeforeUpload","nzMultiple","nzFileListChange"],["nz-button",""],["nz-icon","","nzType","upload"],[4,"nzModalFooter"],["nzText","Recently uploaded files"],[4,"ngFor","ngForOf"],["nz-form","",3,"formGroup"],["nzHasFeedback","",3,"nzSpan"],["placeholder","input here","nz-input","","formControlName","campaignName",3,"nzAutocomplete"],["auto",""],[3,"nzValue",4,"ngFor","ngForOf"],[3,"nzSpan"],["nzShowTime","","formControlName","interval"],["formControlName","comment","nz-input","","rows","2","placeholder","write any thing"],[3,"nzOffset","nzSpan"],["nzDraggable","","nzBlockNode","","nzShowLine","",3,"nzData","nzOnDrop","nzClick","nzContextMenu","contextmenu"],["type","file",2,"display","none",3,"change"],["uploader",""],["type","upload","id","myFile","nz-button","","nzType","default",3,"click"],["nz-icon","","nzType","upload","nzTheme","outline"],[2,"margin-left","1px",3,"nzCount"],["nz-button","","nzType","primary",3,"disabled","click"],[3,"nzValue"],[3,"nzValue","nzLabel"],["nz-button","",3,"nzType"],["nz-button","",2,"margin-top","16px",3,"nzType","nzLoading","disabled","click"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.Vb(1,"nz-alert",1),p.Vb(2,"br"),p.ac(3,"nz-form-item"),p.ac(4,"nz-form-label",2),p.Nc(5,"Type"),p.Zb(),p.ac(6,"nz-form-control",3),p.ac(7,"nz-radio-group",4),p.ic("ngModelChange",(function(e){return t.tabSelected=e}))("ngModelChange",(function(e){return t.handleFormTypeChange(e)})),p.ac(8,"label",5),p.Nc(9,"Lead Generation"),p.Zb(),p.ac(10,"label",6),p.Nc(11,"Custom Workflow"),p.Zb(),p.Zb(),p.ac(12,"a",7),p.ic("click",(function(){return t.open()})),p.Vb(13,"i",8),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Lc(14,Nt,32,17,"form",9),p.ac(15,"nz-dropdown-menu",null,10),p.ac(17,"ul",11),p.ac(18,"li",12),p.ic("click",(function(){return t.deleteNode()})),p.Nc(19,"Delete This"),p.Zb(),p.ac(20,"li",12),p.ic("click",(function(){return t.addLeafNode()})),p.Nc(21,"Add Leaf"),p.Zb(),p.ac(22,"li",12),p.ic("click",(function(){return t.addParentNode()})),p.Nc(23,"Added Parent"),p.Zb(),p.ac(24,"input",13),p.ic("keyup.enter",(function(){return t.rename()}))("ngModelChange",(function(e){return t.renameText=e})),p.Zb(),p.Zb(),p.Zb(),p.ac(25,"nz-drawer",14),p.ic("nzOnClose",(function(){return t.close()})),p.Yb(26),p.ac(27,"button",15),p.ic("click",(function(){return t.showEmailTplModal()})),p.ac(28,"span"),p.Nc(29,"+ Email Template"),p.Zb(),p.Zb(),p.ac(30,"nz-modal",16),p.ic("nzVisibleChange",(function(e){return t.isEmailTplVisible=e}))("nzOnCancel",(function(){return t.handleEmailTplCancel()}))("nzOnOk",(function(){return t.handleEmailTplOk()})),p.ac(31,"form",17),p.ac(32,"nz-form-item"),p.ac(33,"nz-form-label",18),p.Nc(34,"Select Campaign"),p.Zb(),p.Vb(35,"input",19),p.ac(36,"nz-autocomplete",null,20),p.Lc(38,xt,2,3,"nz-auto-option",21),p.Zb(),p.Zb(),p.ac(39,"nz-form-item"),p.ac(40,"nz-form-label",18),p.Nc(41,"Subject"),p.Zb(),p.ac(42,"nz-form-control",22),p.Vb(43,"input",23),p.Zb(),p.Zb(),p.ac(44,"nz-form-item"),p.ac(45,"nz-form-label",18),p.Nc(46,"Body"),p.Zb(),p.ac(47,"nz-form-control",22),p.Vb(48,"textarea",24),p.Zb(),p.Zb(),p.ac(49,"nz-upload",25),p.ic("nzFileListChange",(function(e){return t.fileList=e})),p.ac(50,"button",26),p.Vb(51,"i",27),p.Nc(52,"Select File"),p.Zb(),p.Zb(),p.Zb(),p.Lc(53,Tt,5,5,"div",28),p.Zb(),p.Xb(),p.Vb(54,"nz-divider",29),p.Lc(55,_t,4,4,"ng-container",30),p.Zb()),2&e){var n=p.Dc(37);p.Eb(4),p.tc("nzSpan",7),p.Eb(2),p.tc("nzSpan",12),p.Eb(1),p.tc("ngModel",t.tabSelected)("ngModelOptions",p.xc(28,At)),p.Eb(7),p.tc("ngIf","Lead Generation"===t.tabSelected),p.Eb(10),p.tc("ngModel",t.renameText),p.Eb(1),p.tc("nzClosable",!1)("nzVisible",t.visible),p.Eb(2),p.tc("nzType","primary"),p.Eb(3),p.tc("nzVisible",t.isEmailTplVisible),p.Eb(1),p.tc("formGroup",t.emailForm),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("nzAutocomplete",n),p.Eb(3),p.tc("ngForOf",t.campaignOptions),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(3),p.tc("nzSm",24)("nzXs",24),p.Eb(2),p.tc("nzSm",24)("nzXs",24),p.Eb(1),p.tc("nzAutosize",p.xc(29,Mt)),p.Eb(1),p.tc("nzFileList",t.fileList)("nzBeforeUpload",t.beforeUpload)("nzMultiple",!0),p.Eb(6),p.tc("ngForOf",t.recentUploads)}},directives:[r.u,r.o,r.p,w.b,Ft.a,Z.c,w.c,Z.a,w.d,w.a,wt.c,r.n,r.q,wt.b,wt.a,k.a,O.a,S.b,o.m,b.d,M.c,M.d,y.b,r.c,F.a,E.a,_.a,r.j,L.d,r.h,L.a,o.l,y.a,ye.a,_.b,C.a,N.b,N.d,Ue.a,Zt.a,L.c],pipes:[o.e],styles:["[nz-form][_ngcontent-%COMP%]{max-width:900px}button[_ngcontent-%COMP%]{margin-left:8px}.context-area[_ngcontent-%COMP%]{background:#f7f7f7;color:#777;text-align:center;height:200px;line-height:200px}nz-tree[_ngcontent-%COMP%]{overflow:hidden;font-size:1.1rem}"]}),Vt),It=((Lt=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"createOrUpdateRole",value:function(e){return this.http.post(d.a.apiUrl+"/roles/createOrUpdate",{role:e})}},{key:"getAllRoles",value:function(){return this.http.get(d.a.apiUrl+"/roles")}},{key:"addPermission",value:function(e){return this.http.post(d.a.apiUrl+"/roles/permission",{permission:e})}},{key:"getAllPermissions",value:function(){return this.http.get(d.a.apiUrl+"/roles/permissions")}}]),e}()).\u0275fac=function(e){return new(e||Lt)(p.ec(m.c))},Lt.\u0275prov=p.Qb({token:Lt,factory:Lt.\u0275fac,providedIn:"root"}),Lt);function Rt(e,t){if(1&e){var n=p.bc();p.ac(0,"nz-descriptions",3),p.ac(1,"nz-descriptions-item",4),p.ac(2,"nz-checkbox-group",5),p.ic("ngModelChange",(function(e){return p.Ec(n),t.$implicit.permissions=e}))("ngModelChange",(function(){p.Ec(n);var e=t.$implicit;return p.lc().updateRole(e)})),p.Zb(),p.Zb(),p.Zb()}if(2&e){var i=t.$implicit;p.Eb(1),p.uc("nzTitle",i.label),p.Eb(1),p.tc("ngModel",i.permissions)}}var jt,Ut=((jt=function(){function e(t,n){_classCallCheck(this,e),this.roleService=t,this.router=n,this.roles=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.roleService.getAllRoles().subscribe((function(t){e.roles=t}),(function(e){console.log("An error occured while fetching roles")}))}},{key:"updateRole",value:function(e){this.roleService.createOrUpdateRole(e).subscribe((function(e){console.log(e)}),(function(e){console.error(e)}))}},{key:"createNewRole",value:function(){this.router.navigate(["welcome","create","role"])}}]),e}()).\u0275fac=function(e){return new(e||jt)(p.Ub(It),p.Ub(c.d))},jt.\u0275cmp=p.Ob({type:jt,selectors:[["app-role"]],decls:4,vars:1,consts:[["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus-square","nzTheme","outline"],["nzBordered","","nzLayout","vertical",4,"ngFor","ngForOf"],["nzBordered","","nzLayout","vertical"],[3,"nzTitle"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(p.ac(0,"button",0),p.ic("click",(function(){return t.createNewRole()})),p.Vb(1,"i",1),p.Nc(2,"Role"),p.Zb(),p.Lc(3,Rt,3,2,"nz-descriptions",2)),2&e&&(p.Eb(3),p.tc("ngForOf",t.roles))},directives:[k.a,E.a,O.a,S.b,o.l,T.a,T.b,x.b,r.n,r.q],styles:[""]}),jt);function Xt(e,t){if(1&e&&(p.ac(0,"th"),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.Eb(1),p.Oc(n.title)}}function qt(e,t){if(1&e&&(p.ac(0,"tr"),p.ac(1,"td"),p.Nc(2),p.Zb(),p.ac(3,"td"),p.Nc(4),p.Zb(),p.ac(5,"td"),p.Nc(6),p.Zb(),p.ac(7,"td"),p.Nc(8),p.Zb(),p.Zb()),2&e){var n=t.$implicit;p.Eb(2),p.Oc(n.label),p.Eb(2),p.Oc(n.value),p.Eb(2),p.Oc(n.checked),p.Eb(2),p.Oc(n._id)}}var Bt,Gt=function(){return{x:"1000px",y:"240px"}},$t=((Bt=function(){function e(t,n,i){_classCallCheck(this,e),this.fb=t,this.roleService=n,this.msgService=i,this.listOfColumn=[{title:"Label"},{title:"Value",priority:3},{title:"checked",priority:2},{title:"_id",priority:1}],this.listOfData=[]}return _createClass(e,[{key:"submitForm",value:function(){var e=this;for(var t in this.validateForm.controls)this.validateForm.controls[t].markAsDirty(),this.validateForm.controls[t].updateValueAndValidity();this.validateForm.valid&&this.roleService.addPermission(this.validateForm.value).subscribe((function(t){e.msgService.success("Successfully updated roles for user"),e.initTable()}),(function(t){e.msgService.error("An error occured while adding roles to the database",t.message)}))}},{key:"ngOnInit",value:function(){this.initForm(),this.initTable()}},{key:"initForm",value:function(){this.validateForm=this.fb.group({label:[null,[r.t.required]],value:[null,[r.t.required]],checked:[null,[r.t.required]]})}},{key:"initTable",value:function(){var e=this;this.roleService.getAllPermissions().subscribe((function(t){e.listOfData=t}),(function(e){}))}}]),e}()).\u0275fac=function(e){return new(e||Bt)(p.Ub(r.e),p.Ub(It),p.Ub(f.e))},Bt.\u0275cmp=p.Ob({type:Bt,selectors:[["app-permissions"]],decls:27,vars:15,consts:[["nz-form","",3,"formGroup","ngSubmit"],["nzRequired","","nzFor","name",3,"nzSpan"],["nzErrorTip","Please enter permission label",3,"nzSpan"],["type","text","nz-input","","formControlName","label","placeholder","Enter Label"],["nzFor","nickname",3,"nzSpan","nzRequired"],["nzErrorTip","Please enter permission value",3,"nzSpan"],["type","text","nz-input","","formControlName","value","placeholder","Please input your nickname"],[3,"nzSpan","nzOffset"],["nz-checkbox","","formControlName","checked"],["nz-button","","nzType","primary"],["nzText","Permissions currently available in system","nzOrientation","left"],["nzTableLayout","fixed",3,"nzData","nzScroll"],["sortTable",""],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.ic("ngSubmit",(function(){return t.submitForm()})),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-label",1),p.Nc(3,"Label"),p.Zb(),p.ac(4,"nz-form-control",2),p.Vb(5,"input",3),p.Zb(),p.Zb(),p.ac(6,"nz-form-item"),p.ac(7,"nz-form-label",4),p.Nc(8,"Value"),p.Zb(),p.ac(9,"nz-form-control",5),p.Vb(10,"input",6),p.Zb(),p.Zb(),p.ac(11,"nz-form-item"),p.ac(12,"nz-form-control",7),p.ac(13,"label",8),p.Nc(14,"Set on initialization"),p.Zb(),p.Zb(),p.Zb(),p.ac(15,"nz-form-item"),p.ac(16,"nz-form-control",7),p.ac(17,"button",9),p.Nc(18,"Set New"),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.Vb(19,"nz-divider",10),p.ac(20,"nz-table",11,12),p.ac(22,"thead"),p.ac(23,"tr"),p.Lc(24,Xt,2,1,"th",13),p.Zb(),p.Zb(),p.ac(25,"tbody"),p.Lc(26,qt,9,4,"tr",13),p.Zb(),p.Zb()),2&e){var n,i=p.Dc(21),a=null==(n=t.validateForm.get("required"))?null:n.value;p.tc("formGroup",t.validateForm),p.Eb(2),p.tc("nzSpan",4),p.Eb(2),p.tc("nzSpan",8),p.Eb(3),p.tc("nzSpan",4)("nzRequired",a),p.Eb(2),p.tc("nzSpan",8),p.Eb(3),p.tc("nzSpan",8)("nzOffset",4),p.Eb(4),p.tc("nzSpan",8)("nzOffset",4),p.Eb(4),p.tc("nzData",t.listOfData)("nzScroll",p.xc(14,Gt)),p.Eb(4),p.tc("ngForOf",t.listOfColumn),p.Eb(2),p.tc("ngForOf",i.data)}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.d,w.a,y.b,r.c,r.n,r.h,x.a,k.a,E.a,O.a,C.a,A.b,A.i,A.j,o.l,A.d,A.a,A.g],styles:[""]}),Bt);function Ht(e,t){if(1&e&&p.Vb(0,"nz-option",9),2&e){var n=t.$implicit;p.tc("nzLabel",n.label)("nzValue",n)}}function Wt(e,t){1&e&&p.Nc(0),2&e&&p.Pc(" and ",t.$implicit.length," more selected ")}var Qt,Jt=((Qt=function(){function e(t,n,i){_classCallCheck(this,e),this.fb=t,this.roleService=n,this.msgService=i}return _createClass(e,[{key:"ngOnInit",value:function(){this.initForm(),this.initAutoComplete()}},{key:"initForm",value:function(){this.validateForm=this.fb.group({label:[null,[r.t.required]],value:[null,[r.t.required]],permissions:[null,[r.t.required]]})}},{key:"createNewRole",value:function(){var e=this;for(var t in this.validateForm.controls)this.validateForm.controls[t].markAsDirty(),this.validateForm.controls[t].updateValueAndValidity();console.log(this.validateForm.value),this.validateForm.valid&&this.roleService.createOrUpdateRole(this.validateForm.value).subscribe((function(t){e.msgService.success("Successfully updated roles with permissions")}),(function(t){e.msgService.error("An error occured while updating roles with permissions")}))}},{key:"initAutoComplete",value:function(){var e=this;this.roleService.getAllPermissions().subscribe((function(t){e.listOfOption=t}))}}]),e}()).\u0275fac=function(e){return new(e||Qt)(p.Ub(r.e),p.Ub(It),p.Ub(f.e))},Qt.\u0275cmp=p.Ob({type:Qt,selectors:[["app-role-create"]],decls:16,vars:5,consts:[["nz-form","",1,"login-form",3,"formGroup","ngSubmit"],["nzErrorTip","Please input Role Name!"],["type","text","nz-input","","formControlName","label","placeholder","Enter name for new role"],["nzErrorTip","System identifiable Value!"],["type","text","nz-input","","formControlName","value","placeholder","Enter system identifiable value"],["nzMode","multiple","nzPlaceHolder","Please select","formControlName","permissions",3,"nzMaxTagCount","nzMaxTagPlaceholder"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["tagPlaceHolder",""],["nz-button","",1,"login-form-button","login-form-margin",3,"nzType"],[3,"nzLabel","nzValue"]],template:function(e,t){if(1&e&&(p.ac(0,"form",0),p.ic("ngSubmit",(function(){return t.createNewRole()})),p.ac(1,"nz-form-item"),p.ac(2,"nz-form-control",1),p.ac(3,"nz-input-group"),p.Vb(4,"input",2),p.Zb(),p.Zb(),p.Zb(),p.ac(5,"nz-form-item"),p.ac(6,"nz-form-control",3),p.ac(7,"nz-input-group"),p.Vb(8,"input",4),p.Zb(),p.Zb(),p.Zb(),p.ac(9,"nz-form-item"),p.ac(10,"nz-select",5),p.Lc(11,Ht,1,2,"nz-option",6),p.Zb(),p.Zb(),p.Lc(12,Wt,1,1,"ng-template",null,7,p.Mc),p.ac(14,"button",8),p.Nc(15,"Create New Role"),p.Zb(),p.Zb()),2&e){var n=p.Dc(13);p.tc("formGroup",t.validateForm),p.Eb(10),p.tc("nzMaxTagCount",3)("nzMaxTagPlaceholder",n),p.Eb(1),p.tc("ngForOf",t.listOfOption),p.Eb(3),p.tc("nzType","primary")}},directives:[r.u,r.o,w.b,r.j,Z.c,w.c,Z.a,w.a,y.c,y.b,r.c,r.n,r.h,P.e,o.l,k.a,E.a,O.a,P.a],styles:[".login-form[_ngcontent-%COMP%]{max-width:400px}.login-form-margin[_ngcontent-%COMP%]{margin-bottom:16px}.login-form-forgot[_ngcontent-%COMP%]{float:right}.login-form-button[_ngcontent-%COMP%], nz-select[_ngcontent-%COMP%]{width:100%}"]}),Qt),Kt=n("OtHt");function Yt(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"nz-list-item-meta",6),p.mc(2,"date"),p.ac(3,"nz-list-item-meta-title"),p.ac(4,"a",7),p.Nc(5),p.Zb(),p.Nc(6," | "),p.ac(7,"a",7),p.Nc(8),p.mc(9,"date"),p.Zb(),p.Zb(),p.Zb(),p.Nc(10," content "),p.ac(11,"ul",8),p.ac(12,"nz-list-item-action"),p.ac(13,"a",9),p.ic("click",(function(){p.Ec(n);var e=p.lc().$implicit;return p.lc().download(e)})),p.Nc(14,"Download File"),p.Zb(),p.Zb(),p.ac(15,"nz-list-item-action"),p.ac(16,"a"),p.Nc(17,"More Info"),p.Zb(),p.Zb(),p.Zb(),p.Xb()}if(2&e){var i=p.lc().$implicit;p.Eb(1),p.wc("nzDescription","User with email ",i.email," updated a file on ",p.nc(2,4,i.createdAt),""),p.Eb(4),p.Oc(i.email),p.Eb(3),p.Oc(p.nc(9,6,i.createdAt))}}function en(e,t){1&e&&p.Vb(0,"nz-skeleton",10),2&e&&p.tc("nzAvatar",!0)("nzActive",!0)("nzTitle",!1)("nzLoading",!0)}function tn(e,t){if(1&e&&(p.ac(0,"nz-list-item"),p.Lc(1,Yt,18,8,"ng-container",4),p.Lc(2,en,1,4,"nz-skeleton",5),p.Zb()),2&e){var n=t.$implicit;p.Eb(1),p.tc("ngIf",!n.loading),p.Eb(1),p.tc("ngIf",n.loading)}}function nn(e,t){if(1&e){var n=p.bc();p.ac(0,"button",11),p.ic("click",(function(){return p.Ec(n),p.lc().onLoadMore()})),p.Nc(1,"loading more"),p.Zb()}}var an,on,rn=((an=function(){function e(t,n,i){_classCallCheck(this,e),this.msg=t,this.agentService=n,this.router=i,this.initLoading=!0,this.loadingMore=!1,this.data=[],this.list=[]}return _createClass(e,[{key:"ngOnInit",value:function(){this.getData()}},{key:"getData",value:function(){var e=this;this.agentService.listAgentActions(this.list.length).subscribe((function(t){e.initLoading=!1,e.list=t}),(function(e){console.log(e)}))}},{key:"onLoadMore",value:function(){this.loadingMore=!0,this.getData()}},{key:"download",value:function(e){this.agentService.downloadExcelFile(e.filePath)}}]),e}()).\u0275fac=function(e){return new(e||an)(p.Ub(f.e),p.Ub(St),p.Ub(c.d))},an.\u0275cmp=p.Ob({type:an,selectors:[["app-admin-actions"]],decls:4,vars:3,consts:[[1,"demo-loadmore-list",3,"nzLoading"],[4,"ngFor","ngForOf"],["nz-list-load-more","",1,"loadmore"],["nz-button","",3,"click",4,"ngIf"],[4,"ngIf"],[3,"nzAvatar","nzActive","nzTitle","nzLoading",4,"ngIf"],["nzAvatar","https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",3,"nzDescription"],["href","#"],["nz-list-item-actions",""],[3,"click"],[3,"nzAvatar","nzActive","nzTitle","nzLoading"],["nz-button","",3,"click"]],template:function(e,t){1&e&&(p.ac(0,"nz-list",0),p.Lc(1,tn,3,2,"nz-list-item",1),p.ac(2,"div",2),p.Lc(3,nn,2,0,"button",3),p.Zb(),p.Zb()),2&e&&(p.tc("nzLoading",t.initLoading),p.Eb(1),p.tc("ngForOf",t.list),p.Eb(2),p.tc("ngIf",!t.loadingMore))},directives:[V.a,o.l,o.m,V.e,V.f,V.g,V.d,V.c,Kt.a,k.a,E.a,O.a],pipes:[o.e],styles:[".demo-loadmore-list[_ngcontent-%COMP%]{min-height:350px}.loadmore[_ngcontent-%COMP%]{text-align:center;margin-top:12px;height:32px;line-height:32px}"]}),an),cn=["campaignChart"],ln=((on=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){this.initChart()}},{key:"initChart",value:function(){this.chartOption={title:{text:"Campaign Overview",subtext:"Viewing all campaigns",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{left:"center",top:"bottom",data:["campaign1","campaign2","campaign3","campaign4","campaign5","campaign6","campaign7","campaign8"]},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["pie","funnel"]},restore:{show:!0},saveAsImage:{show:!0}}},series:[{name:"Campaign Overview",type:"pie",radius:[30,150],center:["50%","50%"],roseType:"area",data:[{value:10,name:"campaign1"},{value:5,name:"campaign2"},{value:15,name:"campaign3"},{value:25,name:"campaign4"},{value:20,name:"campaign5"},{value:35,name:"campaign6"},{value:30,name:"campaign7"},{value:40,name:"campaign8"}]}]}}},{key:"onChartInit",value:function(e){this.ec=e,this.ec.on("click",(function(e){console.log(e)}))}}]),e}()).\u0275fac=function(e){return new(e||on)},on.\u0275cmp=p.Ob({type:on,selectors:[["app-campaign-overview"]],viewQuery:function(e,t){var n;1&e&&p.Sc(cn,!0),2&e&&p.Cc(n=p.jc())&&(t.campaignChart=n.first)},decls:3,vars:1,consts:[["nz-row",""],["nz-col","","nzSpan","24","echarts","",1,"demo-chart",3,"options","chartInit"],["campaignChart",""]],template:function(e,t){1&e&&(p.ac(0,"div",0),p.ac(1,"div",1,2),p.ic("chartInit",(function(e){return t.onChartInit(e)})),p.Zb(),p.Zb()),2&e&&(p.Eb(1),p.tc("options",t.chartOption))},directives:[Z.c,Z.a,dt.a],styles:[".demo-chart[_ngcontent-%COMP%]{min-height:500px!important}"]}),on);function sn(e,t){if(1&e&&p.Vb(0,"nz-option",5),2&e){var n=t.$implicit;p.tc("nzLabel",n.campaignName)("nzValue",n._id)}}function un(e,t){if(1&e&&p.Vb(0,"nz-option",5),2&e){var n=t.$implicit;p.tc("nzLabel",n)("nzValue",n)}}function pn(e,t){if(1&e){var n=p.bc();p.ac(0,"nz-select",0),p.ic("ngModelChange",(function(e){return p.Ec(n),p.lc().selectedLeadStatus=e}))("ngModelChange",(function(e){return p.Ec(n),p.lc().handleLeadStatusChange(e)})),p.Lc(1,un,1,2,"nz-option",1),p.Zb()}if(2&e){var i=p.lc();p.tc("ngModel",i.selectedLeadStatus),p.Eb(1),p.tc("ngForOf",i.leadStatusOptions)}}function fn(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"nz-date-picker",17),p.ic("ngModelChange",(function(e){p.Ec(n);var t=p.lc(2).$implicit;return p.lc(2).selectedLead[t]=e}))("nzOnOpenChange",(function(e){return p.Ec(n),p.lc(4).handleDateOpenChange(e)}))("nzOnPanelChange",(function(e){return p.Ec(n),p.lc(4).handleDatePanelChange(e)})),p.Zb(),p.Xb()}if(2&e){var i=p.lc(2).$implicit,a=p.lc(2);p.Eb(1),p.tc("nzMode",a.dateMode)("ngModel",a.selectedLead[i])("nzDisabled",a.isDisabled(i))}}function dn(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"input",18),p.ic("ngModelChange",(function(e){p.Ec(n);var t=p.lc(2).$implicit;return p.lc(2).selectedLead[t]=e})),p.Zb(),p.Xb()}if(2&e){var i=p.lc(2).$implicit,a=p.lc(2);p.Eb(1),p.tc("ngModel",a.selectedLead[i])}}function mn(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"input",19),p.ic("ngModelChange",(function(e){p.Ec(n);var t=p.lc(2).$implicit;return p.lc(2).selectedLead[t]=e})),p.Zb(),p.Xb()}if(2&e){var i=p.lc(2).$implicit,a=p.lc(2);p.Eb(1),p.tc("ngModel",a.selectedLead[i])("disabled",a.isDisabled(i))}}function hn(e,t){if(1&e&&p.Vb(0,"nz-option",5),2&e){var n=t.$implicit;p.tc("nzLabel",n)("nzValue",n)}}function bn(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"nz-select",20),p.ic("ngModelChange",(function(e){p.Ec(n);var t=p.lc(2).$implicit;return p.lc(2).selectedLead[t]=e})),p.Lc(2,hn,1,2,"nz-option",1),p.Zb(),p.Xb()}if(2&e){var i=p.lc(2).$implicit,a=p.lc(2);p.Eb(1),p.tc("ngModel",a.selectedLead[i]),p.Eb(1),p.tc("ngForOf",a.typeDict[i].options)}}function gn(e,t){if(1&e&&(p.ac(0,"nz-descriptions-item",14),p.Yb(1,15),p.Lc(2,fn,2,3,"ng-container",16),p.Lc(3,dn,2,1,"ng-container",16),p.Lc(4,mn,2,2,"ng-container",16),p.Lc(5,bn,3,2,"ng-container",16),p.Xb(),p.Zb()),2&e){var n=p.lc().$implicit,i=p.lc(2);p.tc("nzTitle",i.typeDict[n].label),p.Eb(1),p.tc("ngSwitch",i.typeDict[n].type),p.Eb(1),p.tc("ngSwitchCase","date"),p.Eb(1),p.tc("ngSwitchCase","number"),p.Eb(1),p.tc("ngSwitchCase","string"),p.Eb(1),p.tc("ngSwitchCase","select")}}function zn(e,t){if(1&e&&(p.Yb(0),p.Lc(1,gn,6,6,"nz-descriptions-item",13),p.Xb()),2&e){var n=t.$implicit,i=p.lc(2);p.Eb(1),p.tc("ngIf",i.typeDict[n])}}function vn(e,t){if(1&e){var n=p.bc();p.Yb(0),p.ac(1,"nz-descriptions",6),p.Lc(2,zn,2,1,"ng-container",7),p.ac(3,"nz-descriptions-item",8),p.ac(4,"nz-tree",9),p.ic("nzClick",(function(e){return p.Ec(n),p.lc().handleDispositionTreeEvent(e)})),p.Zb(),p.Zb(),p.ac(5,"nz-descriptions-item",10),p.ac(6,"nz-input-group",11),p.ac(7,"textarea",12),p.ic("ngModelChange",(function(e){return p.Ec(n),p.lc().selectedLead.remark=e})),p.Zb(),p.Zb(),p.Zb(),p.Zb(),p.ac(8,"a",3),p.ic("click",(function(){p.Ec(n);var e=p.lc();return e.handleLeadSubmission(e.selectedLead)})),p.Nc(9,"Submit Change"),p.Zb(),p.Xb()}if(2&e){var i=p.lc();p.Eb(2),p.tc("ngForOf",i.objectkeys(i.selectedLead)),p.Eb(2),p.tc("nzData",i.callDispositions),p.Eb(3),p.tc("ngModel",i.selectedLead.remark)}}var yn,Cn,kn,En=((yn=function(){function e(t,n,i){_classCallCheck(this,e),this.leadsService=t,this.campaignService=n,this.msgService=i,this.objectkeys=Object.keys,this.dateMode="time",this.loadingCampaignList=!1,this.campaignList=[],this.disabledKeys=["externalId","createdAt","updatedAt","_id"]}return _createClass(e,[{key:"ngOnInit",value:function(){this.getLeadMappings(),this.populateCampaignDropdown("")}},{key:"populateCampaignDropdown",value:function(e){var t=this;this.loadingCampaignList=!0,this.campaignService.getCampaigns(1,20,e,"","asc").subscribe((function(e){t.loadingCampaignList=!1,t.campaignList=e.data}),(function(e){t.loadingCampaignList=!1,console.log(e)}))}},{key:"getDispositionForCampaign",value:function(){var e=this;this.campaignService.getDisposition(this.selectedCampaign).subscribe((function(t){e.callDispositions=t.options}),(function(e){console.log(e)}))}},{key:"getLeadMappings",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.leadsService.getLeadMappings(this.selectedCampaign);case 2:t=e.sent,n=t.typeDict,this.typeDict=n,this.leadStatusOptions=this.typeDict.leadStatus.options;case 5:case"end":return e.stop()}}),e,this)})))}},{key:"isDisabled",value:function(e){return!!this.disabledKeys.includes(e)}},{key:"handleLeadSubmission",value:function(e){var t=this;this.leadsService.updateLead(e.externalId,e).subscribe((function(e){t.msgService.success("Successfully updated lead")}),(function(e){var n=e.error;t.msgService.error(n.message[0])}))}},{key:"handleDispositionTreeEvent",value:function(e){e.node.isLeaf&&console.log("set this to formControl",e.node.origin.title),e.node.isExpanded=!e.node.isExpanded}},{key:"handleDateOpenChange",value:function(e){}},{key:"handleLeadStatusChange",value:function(e){}},{key:"handleDatePanelChange",value:function(e){}},{key:"handleCampaignChange",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("selected campaign changed to: ",e),t.next=3,this.getLeadMappings();case 3:this.getDispositionForCampaign();case 4:case"end":return t.stop()}}),t,this)})))}},{key:"fetchNextLead",value:function(e){var t=this;this.leadsService.fetchNextLead(this.selectedCampaign,this.selectedLeadStatus).subscribe((function(e){t.selectedLead=e.result,t.campaignService.getCampaignById(t.selectedLead.campaign,"campaignName").subscribe((function(e){console.log("Found campaign by name",e)}))}),(function(e){console.log(e)}))}}]),e}()).\u0275fac=function(e){return new(e||yn)(p.Ub(h),p.Ub(v),p.Ub(f.e))},yn.\u0275cmp=p.Ob({type:yn,selectors:[["app-lead-solo"]],decls:7,vars:4,consts:[["nzMode","default","nzPlaceHolder","Inserted are removed",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzMode","default","nzPlaceHolder","Inserted are removed",3,"ngModel","ngModelChange",4,"ngIf"],["nz-button","","nzType","link",3,"click"],[4,"ngIf"],[3,"nzLabel","nzValue"],["nzTitle","Lead Info","nzBordered","true"],[4,"ngFor","ngForOf"],["nzTitle","Disposition"],["nzBlockNode","","nzShowLine","",3,"nzData","nzClick"],["nzTitle","Remark","nzSpan","2"],[1,"ant-input-affix-wrapper-textarea-with-clear-btn"],["nz-input","","placeholder","textarea with clear icon",3,"ngModel","ngModelChange"],[3,"nzTitle",4,"ngIf"],[3,"nzTitle"],[3,"ngSwitch"],[4,"ngSwitchCase"],["nzShowTime","",3,"nzMode","ngModel","nzDisabled","ngModelChange","nzOnOpenChange","nzOnPanelChange"],["nz-input","","placeholder","Basic usage",3,"ngModel","ngModelChange"],["nz-input","","placeholder","Basic usage",3,"ngModel","disabled","ngModelChange"],["nzMode","default",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(p.ac(0,"nz-select",0),p.ic("ngModelChange",(function(e){return t.selectedCampaign=e}))("ngModelChange",(function(e){return t.handleCampaignChange(e)})),p.Lc(1,sn,1,2,"nz-option",1),p.Zb(),p.Lc(2,pn,2,2,"nz-select",2),p.ac(3,"a",3),p.ic("click",(function(){return t.fetchNextLead()})),p.Nc(4,"Fetch Next Lead"),p.Zb(),p.Vb(5,"nz-divider"),p.Lc(6,vn,10,3,"ng-container",4)),2&e&&(p.tc("ngModel",t.selectedCampaign),p.Eb(1),p.tc("ngForOf",t.campaignList),p.Eb(1),p.tc("ngIf",t.leadStatusOptions),p.Eb(4),p.tc("ngIf",t.selectedLead))},directives:[P.e,r.n,r.q,o.l,o.m,k.a,O.a,C.a,P.a,T.a,T.b,Ue.a,y.c,y.b,r.c,o.o,o.p,N.b],styles:["nz-select[_ngcontent-%COMP%]{width:10vw}"]}),yn),On=["jitsi"],Sn=((kn=function(){function e(){_classCallCheck(this,e),this.title="Molecule's conference room",this.domain="meet.jit.si"}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.options={roomName:"Molecule_Personal_Space",width:700,height:700,parentNode:document.querySelector("#jitsi")},this.api=new JitsiMeetExternalAPI(this.domain,this.options)}}]),e}()).\u0275fac=function(e){return new(e||kn)},kn.\u0275cmp=p.Ob({type:kn,selectors:[["app-conference"]],viewQuery:function(e,t){var n;1&e&&p.Sc(On,!0),2&e&&p.Cc(n=p.jc())&&(t.someInput=n.first)},decls:5,vars:1,consts:[[2,"text-align","center"],["id","jitsi"],["jitsi",""]],template:function(e,t){1&e&&(p.ac(0,"div",0),p.ac(1,"h1"),p.Nc(2),p.Zb(),p.Vb(3,"div",1,2),p.Zb()),2&e&&(p.Eb(2),p.Pc(" Welcome to ",t.title,"! "))},styles:[""]}),kn),Fn=((Cn=function(){function e(){_classCallCheck(this,e),this.name="A simple chat application"}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Cn)},Cn.\u0275cmp=p.Ob({type:Cn,selectors:[["app-chat"]],decls:4,vars:1,consts:[["src","./assets/converse.html",2,"width","100%","height","90vh","border","none"]],template:function(e,t){1&e&&(p.ac(0,"h1"),p.Nc(1),p.Zb(),p.ac(2,"div"),p.Vb(3,"iframe",0),p.Zb()),2&e&&(p.Eb(1),p.Oc(t.name))},styles:[""]}),Cn);function wn(e,t){if(1&e&&(p.Yb(0),p.ac(1,"nz-descriptions-item",4),p.Nc(2),p.Zb(),p.Xb()),2&e){var n=t.$implicit;p.Eb(1),p.tc("nzTitle",n._id.leadStatus),p.Eb(1),p.Pc(" ",n.myCount," ")}}var Zn,Pn,Nn=[{path:"",data:{breadcrumb:"overview"},component:ht},{path:"campaign-overview",component:ln,data:{breadcrumb:"campaign-overview"}},{path:"users",data:{breadcrumb:"user"},children:[{path:"",component:_e,data:{breadcrumb:"users"}},{path:"details/:email",component:(Zn=function(){function e(t,n){_classCallCheck(this,e),this.activatedRoute=t,this.userService=n,this.filters={}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.activatedRoute.params.subscribe((function(t){var n=t.email;e.userService.getUsersLeadActivity(n,e.filters).subscribe((function(t){e.userDetails=t}))}))}},{key:"onStartDateChange",value:function(e){this.filters.startDate=e}},{key:"onEndDateChange",value:function(e){this.filters.endDate=e}},{key:"clearAll",value:function(){this.filters={}}},{key:"applyFilters",value:function(){var e=this,t=this.activatedRoute.snapshot.params.email;this.userService.getUsersLeadActivity(t,this.filters).subscribe((function(t){e.userDetails=t}))}}]),e}(),Zn.\u0275fac=function(e){return new(e||Zn)(p.Ub(c.a),p.Ub(g.a))},Zn.\u0275cmp=p.Ob({type:Zn,selectors:[["app-user-details"]],decls:6,vars:3,consts:[[3,"ngModel","ngModelChange"],["nz-button","","nzType","primary",3,"click"],["nzTitle","Lead Activity","nzBordered",""],[4,"ngFor","ngForOf"],[3,"nzTitle"]],template:function(e,t){1&e&&(p.ac(0,"nz-date-picker",0),p.ic("ngModelChange",(function(e){return t.startDate=e}))("ngModelChange",(function(e){return t.onStartDateChange(e)})),p.Zb(),p.ac(1,"nz-date-picker",0),p.ic("ngModelChange",(function(e){return t.endDate=e}))("ngModelChange",(function(e){return t.onEndDateChange(e)})),p.Zb(),p.ac(2,"button",1),p.ic("click",(function(){return t.applyFilters()})),p.Nc(3,"Apply filter"),p.Zb(),p.ac(4,"nz-descriptions",2),p.Lc(5,wn,3,2,"ng-container",3),p.Zb()),2&e&&(p.tc("ngModel",t.startDate),p.Eb(1),p.tc("ngModel",t.endDate),p.Eb(4),p.tc("ngForOf",t.userDetails))},directives:[N.b,r.n,r.q,k.a,E.a,O.a,T.a,o.l,T.b],styles:[""]}),Zn),data:{breadcrumb:"details"}},{path:"create",component:Re,data:{breadcrumb:"create-user"}},{path:"conference",component:Sn,data:{breadcrumb:"conference"}},{path:"chat",component:Fn,data:{breadcrumb:"chat"}}]},{path:"leads",data:{breadcrumb:"lead"},children:[{path:"all",component:pe},{path:"create",component:Be,data:{breadcrumb:"create"}},{path:"solo",component:En,data:{breadcrumb:"solo"}}]},{path:"tickets",data:{breadcrumb:"tickets"},children:[{path:"",component:ze},{path:"create",component:We,data:{breadcrumb:"create"}}]},{path:"uploads",component:Se,data:{breadcrumb:"uploads"}},{path:"alarm",component:tt,data:{breadcrumb:"alarms"}},{path:"customers",component:ft,data:{breadcrumb:"show-customers"},children:[{path:"create",component:ct,data:{breadcrumb:"create-customer"}}]},{path:"overview",component:ht,data:{breadcrumb:"overview"}},{path:"campaigns",data:{breadcrumb:"campaign"},children:[{path:"list",component:kt,data:{breadcrumb:"list"}},{path:"create",component:Dt,data:{breadcrumb:"create-campaigns"}}]},{path:"role",data:{breadcrumb:"role"},children:[{path:"list",component:Ut,data:{breadcrumb:"list-roles"}},{path:"create",component:Jt,data:{breadcrumb:"create-role"}},{path:"permission",component:$t,data:{breadcrumb:"permission"}}]},{path:"agent/actions",component:rn,data:{breadcrumb:"actions"}}],xn=((Pn=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:Pn}),Pn.\u0275inj=p.Rb({factory:function(e){return new(e||Pn)},imports:[[c.g.forChild(Nn)],c.g]}),Pn),Tn=n("HQ3A"),_n=n("1RtA"),Ln=n("eIep"),Vn=(n("IzEk"),n("JX91")),An=n("lJxs"),Mn=n("7+OI"),Dn=n("XNiG"),In=n("LRne"),Rn=n("HDdC"),jn=["*"],Un=["container"];function Xn(e,t){}var qn=["fieldComponent"];function Bn(e,t){1&e&&p.Vb(0,"formly-field",1),2&e&&p.tc("field",t.$implicit)}function Gn(e,t,n){if(t.id)return t.id;var i=t.type;return!i&&t.template&&(i="template"),[e,i,t.key,n].join("_")}function $n(e){if(!e.key)return[];if(!e._keyPath||e._keyPath.key!==e.key){var t=[];if("string"==typeof e.key){var n=-1===e.key.indexOf("[")?e.key:e.key.replace(/\[(\w+)\]/g,".$1");t=-1!==n.indexOf(".")?n.split("."):[n]}else t=Array.isArray(e.key)?e.key.slice(0):[""+e.key];e._keyPath={key:e.key,path:t}}return e._keyPath.path.slice(0)}var Hn=["required","pattern","minLength","maxLength","min","max"];function Wn(e,t){var n=$n(e);if(0!==n.length)if(null!=t||!e.autoClear||e.formControl.parent){for(;e.parent;)n=[].concat(_toConsumableArray($n(e=e.parent)),_toConsumableArray(n));!function(e,t,n){for(var i=0;i<t.length-1;i++){var a=t[i];e[a]&&ti(e[a])||(e[a]=/^\d+$/.test(t[i+1])?[]:{}),e=e[a]}e[t[t.length-1]]=ni(n)}(e.model,n,t)}else{var i=n.pop();delete n.reduce((function(e,t){return e[t]||{}}),e.parent.model)[i]}}function Qn(e){var t,n=e.parent.model,i=_createForOfIteratorHelper($n(e));try{for(i.s();!(t=i.n()).done;){var a=t.value;if(!n)return n;n=n[a]}}catch(o){i.e(o)}finally{i.f()}return n}function Jn(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.forEach((function(t){for(var n in t)Kn(e[n])||""===e[n]?e[n]=ni(t[n]):(a=t[n],ti(i=e[n])&&ti(a)&&Object.getPrototypeOf(i)===Object.getPrototypeOf(a)&&!Array.isArray(i)&&!Array.isArray(a)&&Jn(e[n],t[n]));var i,a})),e}function Kn(e){return null==e}function Yn(e){return void 0===e}function ei(e){return"function"==typeof e}function ti(e){return null!=e&&"object"==typeof e}function ni(e){if(!ti(e)||Object(Mn.a)(e)||e.changingThisBreaksApplicationSecurity||-1!==["RegExp","FileList","File","Blob"].indexOf(e.constructor.name))return e;if(e._isAMomentObject&&ei(e.clone))return e.clone();if(e instanceof r.a)return null;if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return e.slice(0).map((function(e){return ni(e)}));var t=Object.getPrototypeOf(e),n=Object.create(t);return n=Object.setPrototypeOf(n,t),Object.keys(e).reduce((function(t,n){var i=Object.getOwnPropertyDescriptor(e,n);return i.get?Object.defineProperty(t,n,i):t[n]=ni(e[n]),t}),n)}function ii(e,t,n){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0}),e[t]=n}function ai(e,t,n){e._observers||ii(e,"_observers",{}),e._observers[t]||(e._observers[t]=[]);var i=e._observers[t];return-1===i.indexOf(n)&&(i.push(n),n({currentValue:e[t],firstChange:!0}),1===i.length&&(ii(e,"___$"+t,e[t]),Object.defineProperty(e,t,{configurable:!0,get:function(){return e["___$"+t]},set:function(n){if(n!==e["___$"+t]){var a=e["___$"+t];e["___$"+t]=n,i.forEach((function(e){return e({previousValue:a,currentValue:n,firstChange:!1})}))}}}))),function(){return i.splice(i.indexOf(n),1)}}function oi(e,t){var n=e._updateTreeValidity.bind(e),i={called:!1,emitEvent:!1};e._updateTreeValidity=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0},t=e.emitEvent;return i={called:!0,emitEvent:t||i.emitEvent}},t(),i.called&&n({emitEvent:i.emitEvent}),e._updateTreeValidity=n}var ri,ci,li,si,ui,pi=new p.q("FORMLY_CONFIG"),fi=((ui=function(){function e(){_classCallCheck(this,e),this.types={},this.validators={},this.wrappers={},this.messages={},this.templateManipulators={preWrapper:[],postWrapper:[]},this.extras={checkExpressionOn:"changeDetectionCheck",lazyRender:!1,showError:function(e){return e.formControl&&e.formControl.invalid&&(e.formControl.touched||e.options.parentForm&&e.options.parentForm.submitted||!(!e.field.validation||!e.field.validation.show))}},this.extensions={}}return _createClass(e,[{key:"addConfig",value:function(e){var t=this;e.types&&e.types.forEach((function(e){return t.setType(e)})),e.validators&&e.validators.forEach((function(e){return t.setValidator(e)})),e.wrappers&&e.wrappers.forEach((function(e){return t.setWrapper(e)})),e.manipulators&&(console.warn("NgxFormly: passing 'manipulators' config is deprecated, use custom extension instead."),e.manipulators.forEach((function(e){return t.setManipulator(e)}))),e.validationMessages&&e.validationMessages.forEach((function(e){return t.addValidatorMessage(e.name,e.message)})),e.extensions&&e.extensions.forEach((function(e){return t.extensions[e.name]=e.extension})),e.extras&&(this.extras=Object.assign({},this.extras,e.extras))}},{key:"setType",value:function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return t.setType(e)})):(this.types[e.name]||(this.types[e.name]={name:e.name}),["component","extends","defaultOptions"].forEach((function(n){e.hasOwnProperty(n)&&(t.types[e.name][n]=e[n])})),e.wrappers&&e.wrappers.forEach((function(n){return t.setTypeWrapper(e.name,n)})))}},{key:"getType",value:function(e){if(!this.types[e])throw new Error('[Formly Error] The type "'.concat(e,'" could not be found. Please make sure that is registered through the FormlyModule declaration.'));return this.mergeExtendedType(e),this.types[e]}},{key:"getMergedField",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.getType(t.type);n.defaultOptions&&Jn(t,n.defaultOptions);var i=n.extends&&this.getType(n.extends).defaultOptions;i&&Jn(t,i),t&&t.optionsTypes&&t.optionsTypes.forEach((function(n){var i=e.getType(n).defaultOptions;i&&Jn(t,i)}));var a=this.resolveFieldTypeRef(t);a&&a.instance&&a.instance.defaultOptions&&Jn(t,a.instance.defaultOptions),!t.wrappers&&n.wrappers&&(t.wrappers=_toConsumableArray(n.wrappers))}},{key:"resolveFieldTypeRef",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.type)return null;var t=this.getType(e.type);if(!t.component||t._componentRef)return t._componentRef;var n=e.parent.options,i=n._resolver,a=n._injector,o=i.resolveComponentFactory(t.component).create(a);return ii(t,"_componentRef",o),o.destroy(),t._componentRef}},{key:"setWrapper",value:function(e){var t=this;this.wrappers[e.name]=e,e.types&&e.types.forEach((function(n){t.setTypeWrapper(n,e.name)}))}},{key:"getWrapper",value:function(e){if(!this.wrappers[e])throw new Error('[Formly Error] The wrapper "'.concat(e,'" could not be found. Please make sure that is registered through the FormlyModule declaration.'));return this.wrappers[e]}},{key:"setTypeWrapper",value:function(e,t){this.types[e]||(this.types[e]={}),this.types[e].wrappers||(this.types[e].wrappers=[]),-1===this.types[e].wrappers.indexOf(t)&&this.types[e].wrappers.push(t)}},{key:"setValidator",value:function(e){this.validators[e.name]=e}},{key:"getValidator",value:function(e){if(!this.validators[e])throw new Error('[Formly Error] The validator "'.concat(e,'" could not be found. Please make sure that is registered through the FormlyModule declaration.'));return this.validators[e]}},{key:"addValidatorMessage",value:function(e,t){this.messages[e]=t}},{key:"getValidatorMessage",value:function(e){return this.messages[e]}},{key:"setManipulator",value:function(e){(new e.class)[e.method](this)}},{key:"mergeExtendedType",value:function(e){if(this.types[e].extends){var t=this.getType(this.types[e].extends);this.types[e].component||(this.types[e].component=t.component),this.types[e].wrappers||(this.types[e].wrappers=t.wrappers)}}}]),e}()).\u0275fac=function(e){return new(e||ui)},ui.\u0275prov=p.Qb({token:ui,factory:ui.\u0275fac,providedIn:"root"}),ui.ngInjectableDef=Object(p.U)({factory:function(){return new ui},token:ui,providedIn:"root"}),ui),di=((si=function(){function e(t,n,i){_classCallCheck(this,e),this.formlyConfig=t,this.componentFactoryResolver=n,this.injector=i}return _createClass(e,[{key:"buildForm",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(!this.formlyConfig.extensions.core)throw new Error("NgxFormly: missing `forRoot()` call. use `forRoot()` when registering the `FormlyModule`.");var o={fieldGroup:n,model:i,formControl:e,options:this._setOptions(a)};oi(e,(function(){return t._buildForm(o)})),o.options._checkField(o,!0)}},{key:"_buildForm",value:function(e){var t=this;this.getExtensions().forEach((function(t){return t.prePopulate&&t.prePopulate(e)})),this.getExtensions().forEach((function(t){return t.onPopulate&&t.onPopulate(e)})),e.fieldGroup&&e.fieldGroup.forEach((function(e){return t._buildForm(e)})),this.getExtensions().forEach((function(t){return t.postPopulate&&t.postPopulate(e)}))}},{key:"getExtensions",value:function(){var e=this;return Object.keys(this.formlyConfig.extensions).map((function(t){return e.formlyConfig.extensions[t]}))}},{key:"_setOptions",value:function(e){var t=this;return(e=e||{}).formState=e.formState||{},e.showError||(e.showError=this.formlyConfig.extras.showError),e.fieldChanges||ii(e,"fieldChanges",new Dn.a),e._resolver||ii(e,"_resolver",this.componentFactoryResolver),e._injector||ii(e,"_injector",this.injector),e._hiddenFieldsForCheck||(e._hiddenFieldsForCheck=[]),e._markForCheck||(e._markForCheck=function(t){t._componentRefs&&t._componentRefs.forEach((function(e){e.injector.get(p.h).markForCheck()})),t.fieldGroup&&t.fieldGroup.forEach((function(t){return e._markForCheck(t)}))}),e._buildField||(e._buildField=function(e){return t.buildForm(e.form,e.fieldGroup,e.model,e.options),e}),e}}]),e}()).\u0275fac=function(e){return new(e||si)(p.ec(fi),p.ec(p.j),p.ec(p.r))},si.\u0275prov=p.Qb({token:si,factory:si.\u0275fac,providedIn:"root"}),si.ngInjectableDef=Object(p.U)({factory:function(){return new si(Object(p.X)(fi),Object(p.X)(p.j),Object(p.X)(p.o))},token:si,providedIn:"root"}),si),mi=((li=function(){function e(t,n,i,a,o){_classCallCheck(this,e),this.formlyConfig=t,this.renderer=n,this.resolver=i,this.elementRef=a,this.warnDeprecation=!1,this.modelChange=new p.n,this.hostObservers=[],this.componentRefs=[],this.hooksObservers=[],this.warnDeprecation=null===o}return _createClass(e,[{key:"ngAfterContentInit",value:function(){this.triggerHook("afterContentInit")}},{key:"ngAfterContentChecked",value:function(){this.triggerHook("afterContentChecked")}},{key:"ngAfterViewInit",value:function(){this.triggerHook("afterViewInit")}},{key:"ngAfterViewChecked",value:function(){this.triggerHook("afterViewChecked")}},{key:"ngDoCheck",value:function(){this.triggerHook("doCheck")}},{key:"ngOnInit",value:function(){this.triggerHook("onInit")}},{key:"ngOnChanges",value:function(e){this.triggerHook("onChanges",e)}},{key:"ngOnDestroy",value:function(){this.resetRefs(this.field),this.hostObservers.forEach((function(e){return e()})),this.hooksObservers.forEach((function(e){return e()})),this.triggerHook("onDestroy")}},{key:"renderField",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(this.containerRef===e&&(this.resetRefs(this.field),this.containerRef.clear(),i=this.field?this.field.wrappers:[]),i&&i.length>0){var a=i,o=_toArray(a),r=o[0],c=o.slice(1),l=this.formlyConfig.getWrapper(r),s=l.component,u=e.createComponent(this.resolver.resolveComponentFactory(s));this.attachComponentRef(u,t),ai(u.instance,"fieldComponent",(function(e){var i=e.firstChange,a=e.previousValue,o=e.currentValue;if(o){var r=a?a.detach():null;r&&!r.destroyed?o.insert(r):n.renderField(o,t,c),!i&&u.changeDetectorRef.detectChanges()}}))}else if(t&&t.type){var p=this.formlyConfig.getType(t.type),f=p.component,d=e.createComponent(this.resolver.resolveComponentFactory(f));this.attachComponentRef(d,t)}}},{key:"triggerHook",value:function(e,t){if(this.field&&this.field.hooks&&this.field.hooks[e]&&(!t||t.field)){var n=this.field.hooks[e](this.field);if(Object(Mn.a)(n)&&-1!==["onInit","afterContentInit","afterViewInit"].indexOf(e)){var i=n.subscribe();this.hooksObservers.push((function(){return i.unsubscribe()}))}}this.field&&this.field.lifecycle&&this.field.lifecycle[e]&&this.field.lifecycle[e](this.field.form,this.field,this.field.model,this.field.options),"onChanges"===e&&t.field&&(this.resetRefs(t.field.previousValue),this.render())}},{key:"attachComponentRef",value:function(e,t){this.componentRefs.push(e),t._componentRefs.push(e),Object.assign(e.instance,{field:t})}},{key:"render",value:function(){var e=this;this.field&&(this.hostObservers.forEach((function(e){return e()})),this.hostObservers=[ai(this.field,"hide",(function(t){var n=t.firstChange,i=t.currentValue;e.formlyConfig.extras.lazyRender?i?e.containerRef.clear():e.renderField(e.containerRef,e.field):(n&&e.renderField(e.containerRef,e.field),(!n||n&&i)&&e.renderer.setStyle(e.elementRef.nativeElement,"display",i?"none":""))})),ai(this.field,"className",(function(t){var n=t.firstChange,i=t.currentValue;(!n||n&&i)&&e.renderer.setAttribute(e.elementRef.nativeElement,"class",i)}))])}},{key:"resetRefs",value:function(e){var t=this;e&&(e._componentRefs?e._componentRefs=e._componentRefs.filter((function(e){return-1===t.componentRefs.indexOf(e)})):ii(this.field,"_componentRefs",[])),this.componentRefs=[]}},{key:"model",set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'model' input to '".concat(this.constructor.name,"' component is not required anymore, you may remove it!"))}},{key:"form",set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'form' input to '".concat(this.constructor.name,"' component is not required anymore, you may remove it!"))}},{key:"options",set:function(e){this.warnDeprecation&&console.warn("NgxFormly: passing 'options' input to '".concat(this.constructor.name,"' component is not required anymore, you may remove it!"))}}]),e}()).\u0275fac=function(e){return new(e||li)(p.Ub(fi),p.Ub(p.E),p.Ub(p.j),p.Ub(p.l),p.fc("hide-deprecation"))},li.\u0275cmp=p.Ob({type:li,selectors:[["formly-field"]],viewQuery:function(e,t){var n;1&e&&p.Jc(Un,!0,p.Q),2&e&&p.Cc(n=p.jc())&&(t.containerRef=n.first)},inputs:{model:"model",form:"form",options:"options",field:"field"},outputs:{modelChange:"modelChange"},features:[p.Cb],decls:2,vars:0,consts:[["container",""]],template:function(e,t){1&e&&p.Lc(0,Xn,0,0,"ng-template",null,0,p.Mc)},encapsulation:2}),li),hi=((ci=function(){function e(t,n,i){_classCallCheck(this,e),this.renderer=t,this.elementRef=n,this.uiAttributesCache={},this.uiAttributes=[].concat(Hn,["tabindex","placeholder","readonly","disabled","step"]),this.uiEvents={listeners:[],events:["click","keyup","keydown","keypress"]},this.document=i}return _createClass(e,[{key:"ngOnChanges",value:function(e){var t=this;e.field&&(this.field.name&&this.setAttribute("name",this.field.name),this.uiEvents.listeners.forEach((function(e){return e()})),this.uiEvents.events.forEach((function(e){t.to&&t.to[e]&&t.uiEvents.listeners.push(t.renderer.listen(t.elementRef.nativeElement,e,(function(n){return t.to[e](t.field,n)})))})),this.to&&this.to.attributes&&ai(this.to,"attributes",(function(e){var n=e.currentValue,i=e.previousValue;i&&Object.keys(i).forEach((function(e){return t.removeAttribute(e)})),n&&Object.keys(n).forEach((function(e){return t.setAttribute(e,n[e])}))})),this.detachElementRef(e.field.previousValue),this.attachElementRef(e.field.currentValue),1===this.fieldAttrElements.length&&(!this.id&&this.field.id&&this.setAttribute("id",this.field.id),ai(this.field,"focus",(function(e){var n=e.currentValue;t.toggleFocus(n)})))),e.id&&this.setAttribute("id",this.id)}},{key:"ngDoCheck",value:function(){var e=this;this.uiAttributes.forEach((function(t){var n=e.to[t];e.uiAttributesCache[t]!==n&&(e.uiAttributesCache[t]=n,n||0===n?e.setAttribute(t,!0===n?t:""+n):e.removeAttribute(t))}))}},{key:"ngOnDestroy",value:function(){this.uiEvents.listeners.forEach((function(e){return e()})),this.detachElementRef(this.field)}},{key:"toggleFocus",value:function(e){var t=this,n=this.fieldAttrElements?this.fieldAttrElements[0]:null;if(n&&n.nativeElement.focus){var i=!!this.document.activeElement&&this.fieldAttrElements.some((function(e){var n=e.nativeElement;return t.document.activeElement===n||n.contains(t.document.activeElement)}));e&&!i?n.nativeElement.focus():!e&&i&&n.nativeElement.blur()}}},{key:"onFocus",value:function(e){this.field.___$focus=!0,this.to.focus&&this.to.focus(this.field,e)}},{key:"onBlur",value:function(e){this.field.___$focus=!1,this.to.blur&&this.to.blur(this.field,e)}},{key:"onChange",value:function(e){this.to.change&&this.to.change(this.field,e),this.field.formControl&&this.field.formControl.markAsDirty()}},{key:"attachElementRef",value:function(e){e&&(e._elementRefs&&-1===e._elementRefs.indexOf(this.elementRef)?e._elementRefs.push(this.elementRef):ii(e,"_elementRefs",[this.elementRef]))}},{key:"detachElementRef",value:function(e){var t=e&&e._elementRefs?this.fieldAttrElements.indexOf(this.elementRef):-1;-1!==t&&this.field._elementRefs.splice(t,1)}},{key:"setAttribute",value:function(e,t){this.renderer.setAttribute(this.elementRef.nativeElement,e,t)}},{key:"removeAttribute",value:function(e){this.renderer.removeAttribute(this.elementRef.nativeElement,e)}},{key:"to",get:function(){return this.field.templateOptions||{}}},{key:"fieldAttrElements",get:function(){return this.field&&this.field._elementRefs||[]}}]),e}()).\u0275fac=function(e){return new(e||ci)(p.Ub(p.E),p.Ub(p.l),p.Ub(o.d))},ci.\u0275dir=p.Pb({type:ci,selectors:[["","formlyAttributes",""]],hostBindings:function(e,t){1&e&&p.ic("focus",(function(e){return t.onFocus(e)}))("blur",(function(e){return t.onBlur(e)}))("change",(function(e){return t.onChange(e)}))},inputs:{field:["formlyAttributes","field"],id:"id"},features:[p.Cb]}),ci),bi=((ri=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"model",get:function(){return this.field.model},set:function(e){console.warn("NgxFormly: passing 'model' input to '".concat(this.constructor.name,"' component is not required anymore, you may remove it!"))}},{key:"form",get:function(){return this.field.parent.formControl},set:function(e){console.warn("NgxFormly: passing 'form' input to '".concat(this.constructor.name,"' component is not required anymore, you may remove it!"))}},{key:"options",get:function(){return this.field.options},set:function(e){console.warn("NgxFormly: passing 'options' input to '".concat(this.constructor.name,"' component is not required anymore, you may remove it!"))}},{key:"key",get:function(){return this.field.key}},{key:"formControl",get:function(){return this.field.formControl}},{key:"to",get:function(){return this.field.templateOptions||{}}},{key:"showError",get:function(){return this.options.showError(this)}},{key:"id",get:function(){return this.field.id}},{key:"formState",get:function(){return this.options.formState||{}}}]),e}()).\u0275fac=function(e){return new(e||ri)},ri.\u0275dir=p.Pb({type:ri,inputs:{model:"model",form:"form",options:"options",field:"field"}}),ri);function gi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(t=t||e.formControl)._fields||ii(t,"_fields",[]),-1===t._fields.indexOf(e)&&t._fields.push(e),!e.formControl&&t&&(ii(e,"formControl",t),e.templateOptions.disabled=!!e.templateOptions.disabled,ai(e.templateOptions,"disabled",(function(t){var n=t.firstChange,i=t.currentValue;n||(i?e.formControl.disable():e.formControl.enable())})),t.registerOnDisabledChange&&t.registerOnDisabledChange((function(t){return e.templateOptions.___$disabled=t})));var i=e.parent.formControl;if(i&&e.key){var a=$n(e);i._formlyControls||ii(i,"_formlyControls",{}),i._formlyControls[a.join(".")]=t;for(var o=0;o<a.length-1;o++){var c=a[o];i.get([c])||gi({key:[c],formControl:new r.i({}),parent:{formControl:i}}),i=i.get([c])}var l=Qn(e);Kn(t.value)&&Kn(l)||t.value===l||!(t instanceof r.f)||t.patchValue(l);var s=a[a.length-1];e._hide||i.get([s])===t||vi(i,{emitEvent:n},(function(){return i.setControl(s,t)}))}}function zi(e){var t=e.status;e.updateValueAndValidity({emitEvent:!1}),t!==e.status&&e.statusChanges.emit(e.status)}function vi(e,t,n){e instanceof r.i&&!e.__patchForEachChild&&(ii(e,"__patchForEachChild",!0),e._forEachChild=function(t){Object.keys(e.controls).forEach((function(n){return e.controls[n]&&t(e.controls[n],n)}))});var i=e.updateValueAndValidity.bind(e);!1===t.emitEvent&&(e.updateValueAndValidity=function(e){i(Object.assign({},e||{},{emitEvent:!1}))}),n(),!1===t.emitEvent&&(e.updateValueAndValidity=i)}var yi,Ci,ki,Ei,Oi=((yi=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(bi)).\u0275fac=function(e){return Si(e||yi)},yi.\u0275dir=p.Pb({type:yi,viewQuery:function(e,t){var n;1&e&&p.Sc(qn,!0,p.Q),2&e&&p.Cc(n=p.jc())&&(t.fieldComponent=n.first)},features:[p.Bb]}),yi),Si=p.cc(Oi),Fi=((Ci=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).defaultOptions={defaultValue:{}},e}return n}(bi)).\u0275fac=function(e){return wi(e||Ci)},Ci.\u0275cmp=p.Ob({type:Ci,selectors:[["formly-group"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Gb(t.field.fieldGroupClassName||"")},features:[p.Bb],ngContentSelectors:jn,decls:2,vars:1,consts:[[3,"field",4,"ngFor","ngForOf"],[3,"field"]],template:function(e,t){1&e&&(p.sc(),p.Lc(0,Bn,1,1,"formly-field",0),p.rc(1)),2&e&&p.tc("ngForOf",t.field.fieldGroup)},directives:[o.l,mi],encapsulation:2}),Ci),wi=p.cc(Fi),Zi=((Ei=function(){function e(t){_classCallCheck(this,e),this.formlyConfig=t}return _createClass(e,[{key:"ngOnChanges",value:function(){var e=this;this.errorMessage$=this.field.formControl.statusChanges.pipe(Object(Vn.a)(null),Object(Ln.a)((function(){return Object(Mn.a)(e.errorMessage)?e.errorMessage:Object(In.a)(e.errorMessage)})))}},{key:"errorMessage",get:function(){var e=this.field.formControl;for(var t in e.errors)if(e.errors.hasOwnProperty(t)){var n=this.formlyConfig.getValidatorMessage(t);if(ti(e.errors[t])){if(e.errors[t].errorPath)return;e.errors[t].message&&(n=e.errors[t].message)}return this.field.validation&&this.field.validation.messages&&this.field.validation.messages[t]&&(n=this.field.validation.messages[t]),this.field.validators&&this.field.validators[t]&&this.field.validators[t].message&&(n=this.field.validators[t].message),this.field.asyncValidators&&this.field.asyncValidators[t]&&this.field.asyncValidators[t].message&&(n=this.field.asyncValidators[t].message),"function"==typeof n?n(e.errors[t],this.field):n}}}]),e}()).\u0275fac=function(e){return new(e||Ei)(p.Ub(fi))},Ei.\u0275cmp=p.Ob({type:Ei,selectors:[["formly-validation-message"]],inputs:{field:"field"},features:[p.Cb],decls:2,vars:3,template:function(e,t){1&e&&(p.Nc(0),p.mc(1,"async")),2&e&&p.Oc(p.nc(1,1,t.errorMessage$))},pipes:[o.b],encapsulation:2,changeDetection:0}),Ei),Pi=((ki=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this)).sanitizer=e,i.innerHtml={content:null,template:null},i}return _createClass(n,[{key:"template",get:function(){return this.field&&this.field.template!==this.innerHtml.template&&(this.innerHtml={template:this.field.template,content:this.to.safeHtml?this.sanitizer.bypassSecurityTrustHtml(this.field.template):this.field.template}),this.innerHtml.content}}]),n}(bi)).\u0275fac=function(e){return new(e||ki)(p.Ub(Ot.b))},ki.\u0275cmp=p.Ob({type:ki,selectors:[["formly-template"]],features:[p.Bb],decls:1,vars:1,consts:[[3,"innerHtml"]],template:function(e,t){1&e&&p.Vb(0,"div",0),2&e&&p.tc("innerHtml",t.template,p.Fc)},encapsulation:2}),ki);function Ni(e,t,n){return e instanceof Function?e.apply(t,n):!!e}var xi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"prePopulate",value:function(e){var t=this;if(!e.parent&&!e.options._checkField){var n=!1;e.options._checkField=function(e,i){n||(n=!0,oi(e.formControl,(function(){return t.checkField(e,i)})),n=!1)}}}},{key:"onPopulate",value:function(e){var t=this;if(e.parent&&!e._expressionProperties){if(ii(e,"_expressionProperties",{}),e.expressionProperties){var n=function(n){var i=e.expressionProperties[n];if("string"==typeof i||ei(i))e._expressionProperties[n]={expression:t._evalExpression(i,"templateOptions.disabled"===n&&e.parent.expressionProperties&&e.parent.expressionProperties.hasOwnProperty("templateOptions.disabled")?function(){return e.parent.templateOptions.disabled}:void 0)},"templateOptions.disabled"===n&&Object.defineProperty(e._expressionProperties[n],"expressionValue",{get:function(){return e.templateOptions.disabled},set:function(){},enumerable:!0,configurable:!0});else if(i instanceof Rn.a){var a=function(){return i.subscribe((function(i){t.setExprValue(e,n,i),e.options&&e.options._markForCheck&&e.options._markForCheck(e)}))},o=a(),r=e.hooks.onInit;e.hooks.onInit=function(){return null===o&&(o=a()),r&&r(e)};var c=e.hooks.onDestroy;e.hooks.onDestroy=function(){c&&c(e),o.unsubscribe(),o=null}}};for(var i in e.expressionProperties)n(i)}for(var a=e.parent;a&&!a.hideExpression;)a=a.parent;e.hide||!e.key||a&&a.hideExpression||e.autoClear&&e.parent&&!Yn(e.defaultValue)&&Yn(Qn(e))&&(Wn(e,e.defaultValue),e.formControl.patchValue(Qn(e),{emitEvent:!1})),e.hideExpression?(delete e.hide,e.hideExpression=this._evalExpression(e.hideExpression,a&&a.hideExpression?function(){return a.hide}:void 0)):ai(e,"hide",(function(t){var n=t.currentValue,i=t.firstChange;e._hide=n,(!i||i&&!0===n)&&e.options._hiddenFieldsForCheck.push(e)}))}}},{key:"_evalExpression",value:function(e,t){return"string"==typeof(e=e||function(){return!1})&&(e=function(e,t){try{return-1!==e.indexOf("this.field")&&console.warn("NgxFormly: using 'this.field' in expressionProperties is deprecated since v5.1, use 'field' instead."),Function("model","formState","field","return ".concat(e,";"))}catch(n){console.error(n)}}(e)),t?function(n,i,a){return t()||e(n,i,a)}:e}},{key:"checkField",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._checkField(e,n),e.options._hiddenFieldsForCheck.sort((function(e){return e.hide?-1:1})).forEach((function(e){return t.toggleFormControl(e,!!e.hide,!n)})),e.options._hiddenFieldsForCheck=[]}},{key:"_checkField",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!1;e.fieldGroup.forEach((function(a){t.checkFieldExpressionChange(a,n)&&(i=!0),t.checkFieldVisibilityChange(a,n)&&(e.options._hiddenFieldsForCheck.push(a),i=!0),a.fieldGroup&&a.fieldGroup.length>0&&t._checkField(a,n)})),i&&e.options&&e.options._markForCheck&&e.options._markForCheck(e)}},{key:"checkFieldExpressionChange",value:function(e,t){if(!e||!e._expressionProperties)return!1;var n=!1,i=e._expressionProperties;for(var a in i){var o=Ni(i[a].expression,{field:e},[e.model,e.options.formState,e]);"templateOptions.disabled"===a&&(o=!!o),!t&&(i[a].expressionValue===o||ti(o)&&JSON.stringify(o)===JSON.stringify(i[a].expressionValue))||(n=!0,i[a].expressionValue=o,this.setExprValue(e,a,o))}return n}},{key:"checkFieldVisibilityChange",value:function(e,t){if(!e||Kn(e.hideExpression))return!1;var n=!!Ni(e.hideExpression,{field:e},[e.model,e.options.formState,e]),i=!1;return(n!==e.hide||t)&&(i=!0,e.hide=n,e.templateOptions.hidden=n),i}},{key:"setDisabledState",value:function(e,t){var n=this;e.fieldGroup&&e.fieldGroup.filter((function(e){return!e.expressionProperties||!e.expressionProperties.hasOwnProperty("templateOptions.disabled")})).forEach((function(e){return n.setDisabledState(e,t)})),e.key&&e.templateOptions.disabled!==t&&(e.templateOptions.disabled=t)}},{key:"toggleFormControl",value:function(e,t,n){var i=this;if(e.formControl&&e.key){ii(e,"_hide",!(!t&&!e.hide));var a=e.formControl;a._fields.length>1&&zi(a),!0===t&&a._fields.every((function(e){return!!e._hide}))?(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.formControl.parent;if(n){var i=e.formControl,a={emitEvent:t};if(n instanceof r.d){var o=n.controls.findIndex((function(e){return e===i}));-1!==o&&vi(n,a,(function(){return n.removeAt(o)}))}else if(n instanceof r.i){var c=$n(e),l=c[c.length-1];n.get([l])===i&&vi(n,a,(function(){return n.removeControl(l)}))}i.setParent(null)}}(e),n&&e.autoClear&&e.formControl.reset({value:void 0,disabled:e.formControl.disabled})):!1===t&&(e.autoClear&&e.parent&&!Yn(e.defaultValue)&&Yn(Qn(e))&&Wn(e,e.defaultValue),gi(e),e.fieldArray&&(e.fieldGroup||[]).length!==(e.model||[]).length&&e.options._buildForm(!0))}e.fieldGroup&&e.fieldGroup.filter((function(e){return!e.hideExpression})).forEach((function(e){return i.toggleFormControl(e,t,n)})),e.options.fieldChanges&&e.options.fieldChanges.next({field:e,type:"hidden",value:t})}},{key:"setExprValue",value:function(e,t,n){try{for(var i=e,a=t.split("."),o=a.length-1,r=0;r<o;r++)i=i[a[r]];i[a[o]]=n}catch(s){throw s.message='[Formly Error] [Expression "'.concat(t,'"] ').concat(s.message),s}if("templateOptions.disabled"===t&&e.key&&this.setDisabledState(e,n),0===t.indexOf("model.")){var c=t.replace(/^model\./,""),l=e.key&&t===c?e.formControl:e.parent.formControl.get(c);!l||Kn(l.value)&&Kn(n)||l.value===n||l.patchValue(n,{emitEvent:!1})}this.emitExpressionChanges(e,t,n)}},{key:"emitExpressionChanges",value:function(e,t,n){e.options.fieldChanges&&e.options.fieldChanges.next({field:e,type:"expressionChanges",property:t,value:n})}}]),e}(),Ti=function(){function e(t){_classCallCheck(this,e),this.formlyConfig=t}return _createClass(e,[{key:"onPopulate",value:function(e){this.initFieldValidation(e,"validators"),this.initFieldValidation(e,"asyncValidators")}},{key:"initFieldValidation",value:function(e,t){var n=this,i=[];if("validators"!==t||e.hasOwnProperty("fieldGroup")&&!e.key||i.push(this.getPredefinedFieldValidation(e)),e[t])for(var a in e[t])"validation"!==a||Array.isArray(e[t].validation)||(e[t].validation=[e[t].validation],console.warn("NgxFormly(".concat(e.key,"): passing a non array value to the 'validation' is deprecated, pass an array instead"))),"validation"===a?i.push.apply(i,_toConsumableArray(e[t].validation.map((function(t){return n.wrapNgValidatorFn(e,t)})))):i.push(this.wrapNgValidatorFn(e,e[t][a],a));ii(e,"_"+t,i)}},{key:"getPredefinedFieldValidation",value:function(e){var t=[];return Hn.forEach((function(n){return ai(e.templateOptions,n,(function(i){var a=i.currentValue,o=i.firstChange;t=t.filter((function(e){return e!==n})),null!=a&&!1!==a&&t.push(n),!o&&e.formControl&&zi(e.formControl)}))})),function(n){return 0===t.length?null:r.t.compose(t.map((function(t){return function(){var i=e.templateOptions[t];switch(t){case"required":return r.t.required(n);case"pattern":return r.t.pattern(i)(n);case"minLength":return r.t.minLength(i)(n);case"maxLength":return r.t.maxLength(i)(n);case"min":return r.t.min(i)(n);case"max":return r.t.max(i)(n)}}})))(n)}}},{key:"wrapNgValidatorFn",value:function(e,t,n){var i=this,a=null;if("string"==typeof t&&(a=ni(this.formlyConfig.getValidator(t))),"object"==typeof t&&t.name&&(a=ni(this.formlyConfig.getValidator(t.name)),t.options&&(a.options=t.options)),"object"==typeof t&&t.expression){var o=t.expression,r=Object(l.d)(t,["expression"]);a={name:n,validation:o,options:Object.keys(r).length>0?r:null}}return"function"==typeof t&&(a={name:n,validation:t}),function(t){var o,r=a.validation(t,e,a.options);return(o=r)&&"function"==typeof o.then?r.then((function(t){return i.handleAsyncResult(e,n?!!t:t,a)})):Object(Mn.a)(r)?r.pipe(Object(An.a)((function(t){return i.handleAsyncResult(e,n?!!t:t,a)}))):i.handleResult(e,n?!!r:r,a)}}},{key:"handleAsyncResult",value:function(e,t,n){return e.options&&e.options._markForCheck&&e.options._markForCheck(e),this.handleResult(e,t,n)}},{key:"handleResult",value:function(e,t,n){var i=n.name,a=n.options;"boolean"==typeof t&&(t=t?null:_defineProperty({},i,a||!0));var o=e.formControl;return o._childrenErrors&&o._childrenErrors[i]&&o._childrenErrors[i](),ti(t)&&Object.keys(t).forEach((function(n){var i=t[n].errorPath?t[n].errorPath:(a||{}).errorPath,r=i?e.formControl.get(i):null;if(r){var c=t[n],s=Object(l.d)(c,["errorPath"]);r.setErrors(Object.assign({},r.errors||{},_defineProperty({},n,s))),!o._childrenErrors&&ii(o,"_childrenErrors",{}),o._childrenErrors[n]=function(){var e=r.errors||{},t=n,i=Object(l.d)(e,["symbol"==typeof t?t:t+""]);r.setErrors(0===Object.keys(i).length?null:i)}}})),t}}]),e}(),_i=function(){function e(t){_classCallCheck(this,e),this.config=t}return _createClass(e,[{key:"onPopulate",value:function(e){e.parent&&(e.fieldGroup&&!e.key?ii(e,"formControl",e.parent.formControl):this.addFormControl(e))}},{key:"postPopulate",value:function(e){if(!e.parent){var t=this.setValidators(e);0!==t.length&&(1===t.length?t[0].formControl.updateValueAndValidity():e.formControl._updateTreeValidity())}}},{key:"addFormControl",value:function(e){var t=function(e){if(e.formControl)return e.formControl;if(!1===e.shareFormControl)return null;var t=e.parent.formControl;return t?t.get($n(e)):null}(e);if(!t){var n={updateOn:e.modelOptions.updateOn},i=e.key?Qn(e):e.defaultValue,a=this.config?this.config.resolveFieldTypeRef(e):null;if(a&&a.componentType&&a.componentType.createControl){var o=a.componentType;console.warn("NgxFormly: '".concat(o.name,"::createControl' is deprecated since v5.0, use 'prePopulate' hook instead.")),t=o.createControl(i,e)}else t=e.fieldGroup?new r.i({},n):new r.f(i,n)}gi(e,t)}},{key:"setValidators",value:function(e){var t=this,n=!1;if(e.key||!e.parent){var i=e.formControl;!!e.templateOptions&&e.templateOptions.disabled&&i.enabled&&(i.disable({emitEvent:!1,onlySelf:!0}),n=!0),null!==i.validator&&null!==i.asyncValidator||(i.setValidators((function(){var n=r.t.compose(t.mergeValidators(e,"_validators"));return n?n(i):null})),i.setAsyncValidators((function(){var n=r.t.composeAsync(t.mergeValidators(e,"_asyncValidators"));return n?n(i):Object(In.a)(null)})),i.parent?n=!0:zi(i))}var a=n?[e]:[];return(e.fieldGroup||[]).forEach((function(e){var i=t.setValidators(e);n||a.push.apply(a,_toConsumableArray(i))})),a}},{key:"mergeValidators",value:function(e,t){var n=this,i=[],a=e.formControl;return a&&a._fields&&a._fields.length>1?a._fields.filter((function(e){return!e._hide})).forEach((function(e){return i.push.apply(i,_toConsumableArray(e[t]))})):i.push.apply(i,_toConsumableArray(e[t])),e.fieldGroup&&e.fieldGroup.filter((function(e){return!e.key&&e.fieldGroup})).forEach((function(e){return i.push.apply(i,_toConsumableArray(n.mergeValidators(e,t)))})),i}}]),e}(),Li=function(){function e(t){_classCallCheck(this,e),this.formlyConfig=t,this.formId=0}return _createClass(e,[{key:"prePopulate",value:function(e){if(this.getFieldComponentInstance(e).prePopulate(),!e.parent){var t=e.options&&e.options.fieldTransform||this.formlyConfig.extras.fieldTransform;(Array.isArray(t)?t:[t]).forEach((function(t){if(t&&(console.warn("NgxFormly: fieldTransform is deprecated since v5.0, use custom extension instead."),!t(e.fieldGroup,e.model,e.formControl,e.options)))throw new Error("fieldTransform must return an array of fields")}))}}},{key:"onPopulate",value:function(e){var t=this;this.initFieldOptions(e),this.getFieldComponentInstance(e).onPopulate(),e.fieldGroup&&e.fieldGroup.forEach((function(n,i){Object.defineProperty(n,"parent",{get:function(){return e},configurable:!0}),Object.defineProperty(n,"index",{get:function(){return i},configurable:!0}),t.formId++}))}},{key:"postPopulate",value:function(e){this.getFieldComponentInstance(e).postPopulate()}},{key:"initFieldOptions",value:function(e){var t=e.parent;t&&(Object.defineProperty(e,"form",{get:function(){return t.formControl},configurable:!0}),Object.defineProperty(e,"options",{get:function(){return t.options},configurable:!0}),Object.defineProperty(e,"model",{get:function(){return e.key&&e.fieldGroup?Qn(e):t.model},configurable:!0}),Jn(e,{id:Gn("formly_"+this.formId,e,e.index),hooks:{},modelOptions:{},templateOptions:e.type&&e.key?{label:"",placeholder:"",focus:!1,disabled:!1}:{}}),this.formlyConfig.extras.resetFieldOnHide&&(e.autoClear=!0),e.lifecycle&&console.warn("NgxFormly: 'lifecycle' is deprecated since v5.0, use 'hooks' instead."),"formly-template"!==e.type&&(e.template||e.expressionProperties&&e.expressionProperties.template)&&(e.type&&console.warn("NgxFormly: passing 'type' property is not allowed when 'template' is set."),e.type="formly-template"),!e.type&&e.fieldGroup&&(e.type="formly-group"),e.type&&this.formlyConfig.getMergedField(e),e.parent&&!e.autoClear&&!Yn(e.defaultValue)&&Yn(Qn(e))&&Wn(e,e.defaultValue),this.initFieldWrappers(e))}},{key:"initFieldWrappers",value:function(e){e.wrappers=e.wrappers||[];var t=Object.assign({preWrapper:[],postWrapper:[]},e.templateOptions.templateManipulators||{});e.wrappers=[].concat(_toConsumableArray(this.formlyConfig.templateManipulators.preWrapper.map((function(t){return t(e)}))),_toConsumableArray(t.preWrapper.map((function(t){return t(e)}))),_toConsumableArray(e.wrappers),_toConsumableArray(this.formlyConfig.templateManipulators.postWrapper.map((function(t){return t(e)}))),_toConsumableArray(t.postWrapper.map((function(t){return t(e)})))).filter((function(e,t,n){return e&&t===n.indexOf(e)}))}},{key:"getFieldComponentInstance",value:function(e){var t=this.formlyConfig.resolveFieldTypeRef(e),n=t?t.instance:{};return{prePopulate:function(){return n.prePopulate&&n.prePopulate(e)},onPopulate:function(){return n.onPopulate&&n.onPopulate(e)},postPopulate:function(){return n.postPopulate&&n.postPopulate(e)}}}}]),e}();function Vi(e){return{types:[{name:"formly-group",component:Fi},{name:"formly-template",component:Pi}],extensions:[{name:"core",extension:new Li(e)},{name:"field-validation",extension:new Ti(e)},{name:"field-form",extension:new _i(e)},{name:"field-expression",extension:new xi}]}}var Ai,Mi=((Ai=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];_classCallCheck(this,e),n&&n.forEach((function(e){return t.addConfig(e)}))}return _createClass(e,null,[{key:"forRoot",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[{provide:pi,multi:!0,useFactory:Vi,deps:[fi]},{provide:pi,useValue:t,multi:!0},{provide:p.a,useValue:t,multi:!0},fi,di]}}},{key:"forChild",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[{provide:pi,useValue:t,multi:!0},{provide:p.a,useValue:t,multi:!0},di]}}}]),e}()).\u0275mod=p.Sb({type:Ai}),Ai.\u0275inj=p.Rb({factory:function(e){return new(e||Ai)(p.ec(fi),p.ec(pi,8))},imports:[[o.c]]}),Ai);function Di(e,t){if(1&e&&(p.Yb(0),p.ac(1,"nz-form-label",4),p.Nc(2),p.Zb(),p.Xb()),2&e){var n=p.lc();p.Eb(1),p.tc("nzRequired",n.to.required&&!0!==n.to.hideRequiredMarker)("nzFor",n.id),p.Eb(1),p.Pc(" ",n.to.label," ")}}function Ii(e,t){if(1&e&&p.Vb(0,"formly-validation-message",5),2&e){var n=p.lc();p.tc("field",n.field)}}var Ri,ji,Ui=((Ri=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"errorState",get:function(){return this.showError?"error":""}}]),n}(Oi)).\u0275fac=function(e){return Xi(e||Ri)},Ri.\u0275cmp=p.Ob({type:Ri,selectors:[["formly-wrapper-nz-form-field"]],features:[p.Bb],decls:7,vars:3,consts:[[4,"ngIf"],[3,"nzValidateStatus","nzErrorTip"],["fieldComponent",""],["errorTpl",""],[3,"nzRequired","nzFor"],[3,"field"]],template:function(e,t){if(1&e&&(p.ac(0,"nz-form-item"),p.Lc(1,Di,3,3,"ng-container",0),p.ac(2,"nz-form-control",1),p.Wb(3,null,2),p.Lc(5,Ii,1,1,"ng-template",null,3,p.Mc),p.Zb(),p.Zb()),2&e){var n=p.Dc(6);p.Eb(1),p.tc("ngIf",t.to.label&&!0!==t.to.hideLabel),p.Eb(1),p.tc("nzValidateStatus",t.errorState)("nzErrorTip",n)}},directives:[Z.c,w.c,o.m,Z.a,w.a,w.d,Zi],encapsulation:2}),Ri),Xi=p.cc(Ui),qi=((ji=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:ji}),ji.\u0275inj=p.Rb({factory:function(e){return new(e||ji)},imports:[[o.c,r.s,w.e,Mi.forChild({wrappers:[{name:"form-field",component:Ui}]})]]}),ji),Bi=n("z4wI");function Gi(e,t){if(1&e&&p.Vb(0,"input",2),2&e){var n=p.lc();p.tc("formControl",n.formControl)("type",n.to.type||"text")("formlyAttributes",n.field)}}function $i(e,t){if(1&e&&p.Vb(0,"nz-input-number",3),2&e){var n=p.lc();p.tc("formControl",n.formControl)("formlyAttributes",n.field)}}var Hi,Wi,Qi,Ji,Ki,Yi,ea=((Hi=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(bi)).\u0275fac=function(e){return ta(e||Hi)},Hi.\u0275cmp=p.Ob({type:Hi,selectors:[["formly-field-nz-input"]],features:[p.Bb],decls:3,vars:2,consts:[["nz-input","",3,"formControl","type","formlyAttributes",4,"ngIf","ngIfElse"],["numberTmp",""],["nz-input","",3,"formControl","type","formlyAttributes"],[3,"formControl","formlyAttributes"]],template:function(e,t){if(1&e&&(p.Lc(0,Gi,1,3,"input",0),p.Lc(1,$i,1,2,"ng-template",null,1,p.Mc)),2&e){var n=p.Dc(2);p.tc("ngIf","number"!==t.to.type)("ngIfElse",n)}},directives:[o.m,y.b,r.c,r.n,r.g,hi,Bi.a],encapsulation:2}),Hi),ta=p.cc(ea),na=((Qi=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:Qi}),Qi.\u0275inj=p.Rb({factory:function(e){return new(e||Qi)},imports:[[o.c,r.s,y.e,Bi.b,qi,Mi.forChild({types:[{name:"input",component:ea,wrappers:["form-field"]}]})]]}),Qi),ia=((Wi=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(bi)).\u0275fac=function(e){return aa(e||Wi)},Wi.\u0275cmp=p.Ob({type:Wi,selectors:[["formly-field-nz-textarea"]],features:[p.Bb],decls:1,vars:2,consts:[["nz-input","",3,"formControl","formlyAttributes"]],template:function(e,t){1&e&&p.Vb(0,"textarea",0),2&e&&p.tc("formControl",t.formControl)("formlyAttributes",t.field)},directives:[y.b,r.c,r.n,r.g,hi],encapsulation:2}),Wi),aa=p.cc(ia),oa=((Yi=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:Yi}),Yi.\u0275inj=p.Rb({factory:function(e){return new(e||Yi)},imports:[[o.c,r.s,y.e,qi,Mi.forChild({types:[{name:"textarea",component:ia,wrappers:["form-field"]}]})]]}),Yi),ra=((Ki=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"transform",value:function(e,t){var n=this;return e instanceof Rn.a||(e=Object(In.a)(e)),e.pipe(Object(An.a)((function(e){return n.toOptions(e,t||{})})))}},{key:"toOptions",value:function(e,t){var n=this,i=[],a={},o=t.templateOptions||{};return o._flatOptions=!0,e.map((function(e){n.getGroupProp(e,o)?(o._flatOptions=!1,a[n.getGroupProp(e,o)]||(a[n.getGroupProp(e,o)]=[],i.push({label:n.getGroupProp(e,o),group:a[n.getGroupProp(e,o)]})),a[n.getGroupProp(e,o)].push(n.toOption(e,o))):i.push(n.toOption(e,o))})),i}},{key:"toOption",value:function(e,t){return{label:this.getLabelProp(e,t),value:this.getValueProp(e,t),disabled:this.getDisabledProp(e,t)||!1}}},{key:"getLabelProp",value:function(e,t){return"function"==typeof t.labelProp?t.labelProp(e):this.shouldUseLegacyOption(e,t)?(console.warn("NgxFormly: legacy select option '{key, value}' is deprecated since v5.5, use '{value, label}' instead."),e.value):e[t.labelProp||"label"]}},{key:"getValueProp",value:function(e,t){return"function"==typeof t.valueProp?t.valueProp(e):this.shouldUseLegacyOption(e,t)?e.key:e[t.valueProp||"value"]}},{key:"getDisabledProp",value:function(e,t){return"function"==typeof t.disabledProp?t.disabledProp(e):e[t.disabledProp||"disabled"]}},{key:"getGroupProp",value:function(e,t){return"function"==typeof t.groupProp?t.groupProp(e):e[t.groupProp||"group"]}},{key:"shouldUseLegacyOption",value:function(e,t){return!t.valueProp&&!t.labelProp&&null!=e&&"object"==typeof e&&"key"in e&&"value"in e}}]),e}()).\u0275fac=function(e){return new(e||Ki)},Ki.\u0275pipe=p.Tb({name:"formlySelectOptions",type:Ki,pure:!0}),Ki),ca=((Ji=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:Ji}),Ji.\u0275inj=p.Rb({factory:function(e){return new(e||Ji)}}),Ji);function la(e,t){if(1&e&&(p.ac(0,"label",2),p.Nc(1),p.Zb()),2&e){var n=t.$implicit;p.tc("nzValue",n.value),p.Eb(1),p.Pc(" ",n.label," ")}}var sa,ua,pa,fa,da=((sa=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).defaultOptions={templateOptions:{options:[]}},e}return n}(bi)).\u0275fac=function(e){return ma(e||sa)},sa.\u0275cmp=p.Ob({type:sa,selectors:[["formly-field-nz-radio"]],features:[p.Bb],decls:4,vars:7,consts:[[3,"formControl"],["nz-radio","",3,"nzValue",4,"ngFor","ngForOf"],["nz-radio","",3,"nzValue"]],template:function(e,t){1&e&&(p.ac(0,"nz-radio-group",0),p.Lc(1,la,2,2,"label",1),p.mc(2,"async"),p.mc(3,"formlySelectOptions"),p.Zb()),2&e&&(p.tc("formControl",t.formControl),p.Eb(1),p.tc("ngForOf",p.nc(2,2,p.oc(3,4,t.to.options,t.field))))},directives:[wt.c,r.n,r.g,o.l,wt.b],pipes:[o.b,ra],encapsulation:2}),sa),ma=p.cc(da),ha=((pa=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:pa}),pa.\u0275inj=p.Rb({factory:function(e){return new(e||pa)},imports:[[o.c,r.s,wt.d,qi,ca,Mi.forChild({types:[{name:"radio",component:da,wrappers:["form-field"]}]})]]}),pa),ba=((ua=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).defaultOptions={templateOptions:{indeterminate:!0,hideLabel:!0}},e}return n}(bi)).\u0275fac=function(e){return ga(e||ua)},ua.\u0275cmp=p.Ob({type:ua,selectors:[["formly-field-nz-checkbox"]],features:[p.Bb],decls:2,vars:4,consts:[["nz-checkbox","",3,"nzIndeterminate","formControl","formlyAttributes"]],template:function(e,t){1&e&&(p.ac(0,"label",0),p.Nc(1),p.Zb()),2&e&&(p.tc("nzIndeterminate",t.to.indeterminate&&null==t.formControl.value)("formControl",t.formControl)("formlyAttributes",t.field),p.Eb(1),p.Pc(" ",t.to.label," "))},directives:[x.a,r.n,r.g,hi],encapsulation:2}),ua),ga=p.cc(ba),za=((fa=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:fa}),fa.\u0275inj=p.Rb({factory:function(e){return new(e||fa)},imports:[[o.c,r.s,x.c,qi,Mi.forChild({types:[{name:"checkbox",component:ba,wrappers:["form-field"]}]})]]}),fa);function va(e,t){if(1&e&&p.Vb(0,"nz-option",6),2&e){var n=t.$implicit;p.tc("nzValue",n.value)("nzDisabled",n.disabled)("nzLabel",n.label)}}function ya(e,t){if(1&e&&(p.ac(0,"nz-option-group",4),p.Lc(1,va,1,3,"nz-option",5),p.Zb()),2&e){var n=p.lc().$implicit;p.tc("nzLabel",n.label),p.Eb(1),p.tc("ngForOf",n.group)}}function Ca(e,t){if(1&e&&p.Vb(0,"nz-option",6),2&e){var n=p.lc().$implicit;p.tc("nzValue",n.value)("nzDisabled",n.disabled)("nzLabel",n.label)}}function ka(e,t){if(1&e&&(p.Yb(0),p.Lc(1,ya,2,2,"nz-option-group",2),p.Lc(2,Ca,1,3,"nz-option",3),p.Xb()),2&e){var n=t.$implicit;p.Eb(1),p.tc("ngIf",n.group),p.Eb(1),p.tc("ngIf",!n.group)}}var Ea,Oa,Sa,Fa,wa,Za=((Ea=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).defaultOptions={templateOptions:{options:[]}},e}return n}(bi)).\u0275fac=function(e){return Pa(e||Ea)},Ea.\u0275cmp=p.Ob({type:Ea,selectors:[["formly-field-nz-select"]],features:[p.Bb],decls:4,vars:12,consts:[[3,"nzPlaceHolder","formControl","formlyAttributes","nzMode"],[4,"ngFor","ngForOf"],[3,"nzLabel",4,"ngIf"],[3,"nzValue","nzDisabled","nzLabel",4,"ngIf"],[3,"nzLabel"],[3,"nzValue","nzDisabled","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzDisabled","nzLabel"]],template:function(e,t){1&e&&(p.ac(0,"nz-select",0),p.Lc(1,ka,3,2,"ng-container",1),p.mc(2,"async"),p.mc(3,"formlySelectOptions"),p.Zb()),2&e&&(p.Kb("ng-dirty",t.showError),p.tc("nzPlaceHolder",t.to.placeholder)("formControl",t.formControl)("formlyAttributes",t.field)("nzMode",t.to.multiple?"multiple":"default"),p.Eb(1),p.tc("ngForOf",p.nc(2,7,p.oc(3,9,t.to.options,t.field))))},directives:[P.e,r.n,r.g,hi,o.l,o.m,P.b,P.a],pipes:[o.b,ra],encapsulation:2}),Ea),Pa=p.cc(Za),Na=((Fa=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:Fa}),Fa.\u0275inj=p.Rb({factory:function(e){return new(e||Fa)},imports:[[o.c,r.s,P.g,qi,ca,Mi.forChild({types:[{name:"select",component:Za,wrappers:["form-field"]}]})]]}),Fa),xa=((Sa=function e(){_classCallCheck(this,e)}).\u0275mod=p.Sb({type:Sa}),Sa.\u0275inj=p.Rb({factory:function(e){return new(e||Sa)},imports:[[qi,na,oa,ha,za,Na]]}),Sa),Ta=((Oa=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(bi)).\u0275fac=function(e){return _a(e||Oa)},Oa.\u0275cmp=p.Ob({type:Oa,selectors:[["formly-date-picket"]],features:[p.Bb],decls:5,vars:3,consts:[["nzRequired",""],[3,"formControl","formlyAttributes"]],template:function(e,t){1&e&&(p.ac(0,"nz-form-item"),p.ac(1,"nz-form-label",0),p.Nc(2),p.Zb(),p.ac(3,"nz-form-control"),p.Vb(4,"nz-date-picker",1),p.Zb(),p.Zb()),2&e&&(p.Eb(2),p.Oc(t.to.label),p.Eb(2),p.tc("formControl",t.formControl)("formlyAttributes",t.field))},directives:[Z.c,w.c,Z.a,w.d,w.a,N.b,r.n,r.g,hi],encapsulation:2}),Oa),_a=p.cc(Ta),La=n("jP9/"),Va=n("7p82"),Aa=((wa=function(){function e(t){_classCallCheck(this,e),this.pubsub=t}return _createClass(e,[{key:"unloadHandler",value:function(e){console.log("browser refresh"),this.pubsub.$pub(La.a,!0)}}]),e}()).\u0275mod=p.Sb({type:wa}),wa.\u0275inj=p.Rb({factory:function(e){return new(e||wa)(p.ec(Va.a))},providers:[_n.a],imports:[[c.g,xn,r.k,o.c,r.s,Tn.a,xa,Mi.forRoot({validationMessages:[{name:"required",message:"This field is required"}],types:[{name:"datePicker",component:Ta}]})]]}),wa)}}]);